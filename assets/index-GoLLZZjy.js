(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const Je of document.querySelectorAll('link[rel="modulepreload"]'))Ue(Je);new MutationObserver(Je=>{for(const Bn of Je)if(Bn.type==="childList")for(const Vn of Bn.addedNodes)Vn.tagName==="LINK"&&Vn.rel==="modulepreload"&&Ue(Vn)}).observe(document,{childList:!0,subtree:!0});function Ve(Je){const Bn={};return Je.integrity&&(Bn.integrity=Je.integrity),Je.referrerPolicy&&(Bn.referrerPolicy=Je.referrerPolicy),Je.crossOrigin==="use-credentials"?Bn.credentials="include":Je.crossOrigin==="anonymous"?Bn.credentials="omit":Bn.credentials="same-origin",Bn}function Ue(Je){if(Je.ep)return;Je.ep=!0;const Bn=Ve(Je);fetch(Je.href,Bn)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(qe){const f=Object.create(null);for(const Ve of qe.split(","))f[Ve]=1;return Ve=>Ve in f}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=qe=>qe.charCodeAt(0)===111&&qe.charCodeAt(1)===110&&(qe.charCodeAt(2)>122||qe.charCodeAt(2)<97),isModelListener=qe=>qe.startsWith("onUpdate:"),extend=Object.assign,remove=(qe,f)=>{const Ve=qe.indexOf(f);Ve>-1&&qe.splice(Ve,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(qe,f)=>hasOwnProperty$1.call(qe,f),isArray=Array.isArray,isMap=qe=>toTypeString(qe)==="[object Map]",isSet=qe=>toTypeString(qe)==="[object Set]",isFunction=qe=>typeof qe=="function",isString=qe=>typeof qe=="string",isSymbol=qe=>typeof qe=="symbol",isObject=qe=>qe!==null&&typeof qe=="object",isPromise=qe=>(isObject(qe)||isFunction(qe))&&isFunction(qe.then)&&isFunction(qe.catch),objectToString=Object.prototype.toString,toTypeString=qe=>objectToString.call(qe),toRawType=qe=>toTypeString(qe).slice(8,-1),isPlainObject$1=qe=>toTypeString(qe)==="[object Object]",isIntegerKey=qe=>isString(qe)&&qe!=="NaN"&&qe[0]!=="-"&&""+parseInt(qe,10)===qe,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=qe=>{const f=Object.create(null);return Ve=>f[Ve]||(f[Ve]=qe(Ve))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(qe=>qe.replace(camelizeRE,(f,Ve)=>Ve?Ve.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(qe=>qe.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(qe=>qe.charAt(0).toUpperCase()+qe.slice(1)),toHandlerKey=cacheStringFunction(qe=>qe?`on${capitalize(qe)}`:""),hasChanged=(qe,f)=>!Object.is(qe,f),invokeArrayFns=(qe,...f)=>{for(let Ve=0;Ve<qe.length;Ve++)qe[Ve](...f)},def=(qe,f,Ve,Ue=!1)=>{Object.defineProperty(qe,f,{configurable:!0,enumerable:!1,writable:Ue,value:Ve})},looseToNumber=qe=>{const f=parseFloat(qe);return isNaN(f)?qe:f};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(qe){if(isArray(qe)){const f={};for(let Ve=0;Ve<qe.length;Ve++){const Ue=qe[Ve],Je=isString(Ue)?parseStringStyle(Ue):normalizeStyle(Ue);if(Je)for(const Bn in Je)f[Bn]=Je[Bn]}return f}else if(isString(qe)||isObject(qe))return qe}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(qe){const f={};return qe.replace(styleCommentRE,"").split(listDelimiterRE).forEach(Ve=>{if(Ve){const Ue=Ve.split(propertyDelimiterRE);Ue.length>1&&(f[Ue[0].trim()]=Ue[1].trim())}}),f}function normalizeClass(qe){let f="";if(isString(qe))f=qe;else if(isArray(qe))for(let Ve=0;Ve<qe.length;Ve++){const Ue=normalizeClass(qe[Ve]);Ue&&(f+=Ue+" ")}else if(isObject(qe))for(const Ve in qe)qe[Ve]&&(f+=Ve+" ");return f.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(qe){return!!qe||qe===""}const isRef$1=qe=>!!(qe&&qe.__v_isRef===!0),toDisplayString=qe=>isString(qe)?qe:qe==null?"":isArray(qe)||isObject(qe)&&(qe.toString===objectToString||!isFunction(qe.toString))?isRef$1(qe)?toDisplayString(qe.value):JSON.stringify(qe,replacer,2):String(qe),replacer=(qe,f)=>isRef$1(f)?replacer(qe,f.value):isMap(f)?{[`Map(${f.size})`]:[...f.entries()].reduce((Ve,[Ue,Je],Bn)=>(Ve[stringifySymbol(Ue,Bn)+" =>"]=Je,Ve),{})}:isSet(f)?{[`Set(${f.size})`]:[...f.values()].map(Ve=>stringifySymbol(Ve))}:isSymbol(f)?stringifySymbol(f):isObject(f)&&!isArray(f)&&!isPlainObject$1(f)?String(f):f,stringifySymbol=(qe,f="")=>{var Ve;return isSymbol(qe)?`Symbol(${(Ve=qe.description)!=null?Ve:f})`:qe};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(f=!1){this.detached=f,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!f&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let f,Ve;if(this.scopes)for(f=0,Ve=this.scopes.length;f<Ve;f++)this.scopes[f].pause();for(f=0,Ve=this.effects.length;f<Ve;f++)this.effects[f].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let f,Ve;if(this.scopes)for(f=0,Ve=this.scopes.length;f<Ve;f++)this.scopes[f].resume();for(f=0,Ve=this.effects.length;f<Ve;f++)this.effects[f].resume()}}run(f){if(this._active){const Ve=activeEffectScope;try{return activeEffectScope=this,f()}finally{activeEffectScope=Ve}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(f){if(this._active){this._active=!1;let Ve,Ue;for(Ve=0,Ue=this.effects.length;Ve<Ue;Ve++)this.effects[Ve].stop();for(this.effects.length=0,Ve=0,Ue=this.cleanups.length;Ve<Ue;Ve++)this.cleanups[Ve]();if(this.cleanups.length=0,this.scopes){for(Ve=0,Ue=this.scopes.length;Ve<Ue;Ve++)this.scopes[Ve].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!f){const Je=this.parent.scopes.pop();Je&&Je!==this&&(this.parent.scopes[this.index]=Je,Je.index=this.index)}this.parent=void 0}}}function effectScope(qe){return new EffectScope(qe)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(qe,f=!1){activeEffectScope&&activeEffectScope.cleanups.push(qe)}let activeSub;const pausedQueueEffects=new WeakSet;class ReactiveEffect{constructor(f){this.fn=f,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||batch(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const f=activeSub,Ve=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{cleanupDeps(this),activeSub=f,shouldTrack=Ve,this.flags&=-3}}stop(){if(this.flags&1){for(let f=this.deps;f;f=f.nextDep)removeSub(f);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let batchDepth=0,batchedSub,batchedComputed;function batch(qe,f=!1){if(qe.flags|=8,f){qe.next=batchedComputed,batchedComputed=qe;return}qe.next=batchedSub,batchedSub=qe}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;if(batchedComputed){let f=batchedComputed;for(batchedComputed=void 0;f;){const Ve=f.next;f.next=void 0,f.flags&=-9,f=Ve}}let qe;for(;batchedSub;){let f=batchedSub;for(batchedSub=void 0;f;){const Ve=f.next;if(f.next=void 0,f.flags&=-9,f.flags&1)try{f.trigger()}catch(Ue){qe||(qe=Ue)}f=Ve}}if(qe)throw qe}function prepareDeps(qe){for(let f=qe.deps;f;f=f.nextDep)f.version=-1,f.prevActiveLink=f.dep.activeLink,f.dep.activeLink=f}function cleanupDeps(qe){let f,Ve=qe.depsTail,Ue=Ve;for(;Ue;){const Je=Ue.prevDep;Ue.version===-1?(Ue===Ve&&(Ve=Je),removeSub(Ue),removeDep(Ue)):f=Ue,Ue.dep.activeLink=Ue.prevActiveLink,Ue.prevActiveLink=void 0,Ue=Je}qe.deps=f,qe.depsTail=Ve}function isDirty(qe){for(let f=qe.deps;f;f=f.nextDep)if(f.dep.version!==f.version||f.dep.computed&&(refreshComputed(f.dep.computed)||f.dep.version!==f.version))return!0;return!!qe._dirty}function refreshComputed(qe){if(qe.flags&4&&!(qe.flags&16)||(qe.flags&=-17,qe.globalVersion===globalVersion))return;qe.globalVersion=globalVersion;const f=qe.dep;if(qe.flags|=2,f.version>0&&!qe.isSSR&&qe.deps&&!isDirty(qe)){qe.flags&=-3;return}const Ve=activeSub,Ue=shouldTrack;activeSub=qe,shouldTrack=!0;try{prepareDeps(qe);const Je=qe.fn(qe._value);(f.version===0||hasChanged(Je,qe._value))&&(qe._value=Je,f.version++)}catch(Je){throw f.version++,Je}finally{activeSub=Ve,shouldTrack=Ue,cleanupDeps(qe),qe.flags&=-3}}function removeSub(qe,f=!1){const{dep:Ve,prevSub:Ue,nextSub:Je}=qe;if(Ue&&(Ue.nextSub=Je,qe.prevSub=void 0),Je&&(Je.prevSub=Ue,qe.nextSub=void 0),Ve.subs===qe&&(Ve.subs=Ue,!Ue&&Ve.computed)){Ve.computed.flags&=-5;for(let Bn=Ve.computed.deps;Bn;Bn=Bn.nextDep)removeSub(Bn,!0)}!f&&!--Ve.sc&&Ve.map&&Ve.map.delete(Ve.key)}function removeDep(qe){const{prevDep:f,nextDep:Ve}=qe;f&&(f.nextDep=Ve,qe.prevDep=void 0),Ve&&(Ve.prevDep=f,qe.nextDep=void 0)}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const qe=trackStack.pop();shouldTrack=qe===void 0?!0:qe}function cleanupEffect(qe){const{cleanup:f}=qe;if(qe.cleanup=void 0,f){const Ve=activeSub;activeSub=void 0;try{f()}finally{activeSub=Ve}}}let globalVersion=0;class Link{constructor(f,Ve){this.sub=f,this.dep=Ve,this.version=Ve.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(f){this.computed=f,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(f){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let Ve=this.activeLink;if(Ve===void 0||Ve.sub!==activeSub)Ve=this.activeLink=new Link(activeSub,this),activeSub.deps?(Ve.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=Ve,activeSub.depsTail=Ve):activeSub.deps=activeSub.depsTail=Ve,addSub(Ve);else if(Ve.version===-1&&(Ve.version=this.version,Ve.nextDep)){const Ue=Ve.nextDep;Ue.prevDep=Ve.prevDep,Ve.prevDep&&(Ve.prevDep.nextDep=Ue),Ve.prevDep=activeSub.depsTail,Ve.nextDep=void 0,activeSub.depsTail.nextDep=Ve,activeSub.depsTail=Ve,activeSub.deps===Ve&&(activeSub.deps=Ue)}return Ve}trigger(f){this.version++,globalVersion++,this.notify(f)}notify(f){startBatch();try{for(let Ve=this.subs;Ve;Ve=Ve.prevSub)Ve.sub.notify()&&Ve.sub.dep.notify()}finally{endBatch()}}}function addSub(qe){if(qe.dep.sc++,qe.sub.flags&4){const f=qe.dep.computed;if(f&&!qe.dep.subs){f.flags|=20;for(let Ue=f.deps;Ue;Ue=Ue.nextDep)addSub(Ue)}const Ve=qe.dep.subs;Ve!==qe&&(qe.prevSub=Ve,Ve&&(Ve.nextSub=qe)),qe.dep.subs=qe}}const targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol(""),ARRAY_ITERATE_KEY=Symbol("");function track(qe,f,Ve){if(shouldTrack&&activeSub){let Ue=targetMap.get(qe);Ue||targetMap.set(qe,Ue=new Map);let Je=Ue.get(Ve);Je||(Ue.set(Ve,Je=new Dep),Je.map=Ue,Je.key=Ve),Je.track()}}function trigger(qe,f,Ve,Ue,Je,Bn){const Vn=targetMap.get(qe);if(!Vn){globalVersion++;return}const Nn=Un=>{Un&&Un.trigger()};if(startBatch(),f==="clear")Vn.forEach(Nn);else{const Un=isArray(qe),qn=Un&&isIntegerKey(Ve);if(Un&&Ve==="length"){const qo=Number(Ue);Vn.forEach(($o,Zo)=>{(Zo==="length"||Zo===ARRAY_ITERATE_KEY||!isSymbol(Zo)&&Zo>=qo)&&Nn($o)})}else switch((Ve!==void 0||Vn.has(void 0))&&Nn(Vn.get(Ve)),qn&&Nn(Vn.get(ARRAY_ITERATE_KEY)),f){case"add":Un?qn&&Nn(Vn.get("length")):(Nn(Vn.get(ITERATE_KEY)),isMap(qe)&&Nn(Vn.get(MAP_KEY_ITERATE_KEY)));break;case"delete":Un||(Nn(Vn.get(ITERATE_KEY)),isMap(qe)&&Nn(Vn.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(qe)&&Nn(Vn.get(ITERATE_KEY));break}}endBatch()}function getDepFromReactive(qe,f){const Ve=targetMap.get(qe);return Ve&&Ve.get(f)}function reactiveReadArray(qe){const f=toRaw(qe);return f===qe?f:(track(f,"iterate",ARRAY_ITERATE_KEY),isShallow(qe)?f:f.map(toReactive))}function shallowReadArray(qe){return track(qe=toRaw(qe),"iterate",ARRAY_ITERATE_KEY),qe}const arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...qe){return reactiveReadArray(this).concat(...qe.map(f=>isArray(f)?reactiveReadArray(f):f))},entries(){return iterator(this,"entries",qe=>(qe[1]=toReactive(qe[1]),qe))},every(qe,f){return apply(this,"every",qe,f,void 0,arguments)},filter(qe,f){return apply(this,"filter",qe,f,Ve=>Ve.map(toReactive),arguments)},find(qe,f){return apply(this,"find",qe,f,toReactive,arguments)},findIndex(qe,f){return apply(this,"findIndex",qe,f,void 0,arguments)},findLast(qe,f){return apply(this,"findLast",qe,f,toReactive,arguments)},findLastIndex(qe,f){return apply(this,"findLastIndex",qe,f,void 0,arguments)},forEach(qe,f){return apply(this,"forEach",qe,f,void 0,arguments)},includes(...qe){return searchProxy(this,"includes",qe)},indexOf(...qe){return searchProxy(this,"indexOf",qe)},join(qe){return reactiveReadArray(this).join(qe)},lastIndexOf(...qe){return searchProxy(this,"lastIndexOf",qe)},map(qe,f){return apply(this,"map",qe,f,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...qe){return noTracking(this,"push",qe)},reduce(qe,...f){return reduce(this,"reduce",qe,f)},reduceRight(qe,...f){return reduce(this,"reduceRight",qe,f)},shift(){return noTracking(this,"shift")},some(qe,f){return apply(this,"some",qe,f,void 0,arguments)},splice(...qe){return noTracking(this,"splice",qe)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(qe){return reactiveReadArray(this).toSorted(qe)},toSpliced(...qe){return reactiveReadArray(this).toSpliced(...qe)},unshift(...qe){return noTracking(this,"unshift",qe)},values(){return iterator(this,"values",toReactive)}};function iterator(qe,f,Ve){const Ue=shallowReadArray(qe),Je=Ue[f]();return Ue!==qe&&!isShallow(qe)&&(Je._next=Je.next,Je.next=()=>{const Bn=Je._next();return Bn.value&&(Bn.value=Ve(Bn.value)),Bn}),Je}const arrayProto=Array.prototype;function apply(qe,f,Ve,Ue,Je,Bn){const Vn=shallowReadArray(qe),Nn=Vn!==qe&&!isShallow(qe),Un=Vn[f];if(Un!==arrayProto[f]){const $o=Un.apply(qe,Bn);return Nn?toReactive($o):$o}let qn=Ve;Vn!==qe&&(Nn?qn=function($o,Zo){return Ve.call(this,toReactive($o),Zo,qe)}:Ve.length>2&&(qn=function($o,Zo){return Ve.call(this,$o,Zo,qe)}));const qo=Un.call(Vn,qn,Ue);return Nn&&Je?Je(qo):qo}function reduce(qe,f,Ve,Ue){const Je=shallowReadArray(qe);let Bn=Ve;return Je!==qe&&(isShallow(qe)?Ve.length>3&&(Bn=function(Vn,Nn,Un){return Ve.call(this,Vn,Nn,Un,qe)}):Bn=function(Vn,Nn,Un){return Ve.call(this,Vn,toReactive(Nn),Un,qe)}),Je[f](Bn,...Ue)}function searchProxy(qe,f,Ve){const Ue=toRaw(qe);track(Ue,"iterate",ARRAY_ITERATE_KEY);const Je=Ue[f](...Ve);return(Je===-1||Je===!1)&&isProxy(Ve[0])?(Ve[0]=toRaw(Ve[0]),Ue[f](...Ve)):Je}function noTracking(qe,f,Ve=[]){pauseTracking(),startBatch();const Ue=toRaw(qe)[f].apply(qe,Ve);return endBatch(),resetTracking(),Ue}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(qe=>qe!=="arguments"&&qe!=="caller").map(qe=>Symbol[qe]).filter(isSymbol));function hasOwnProperty(qe){isSymbol(qe)||(qe=String(qe));const f=toRaw(this);return track(f,"has",qe),f.hasOwnProperty(qe)}class BaseReactiveHandler{constructor(f=!1,Ve=!1){this._isReadonly=f,this._isShallow=Ve}get(f,Ve,Ue){if(Ve==="__v_skip")return f.__v_skip;const Je=this._isReadonly,Bn=this._isShallow;if(Ve==="__v_isReactive")return!Je;if(Ve==="__v_isReadonly")return Je;if(Ve==="__v_isShallow")return Bn;if(Ve==="__v_raw")return Ue===(Je?Bn?shallowReadonlyMap:readonlyMap:Bn?shallowReactiveMap:reactiveMap).get(f)||Object.getPrototypeOf(f)===Object.getPrototypeOf(Ue)?f:void 0;const Vn=isArray(f);if(!Je){let Un;if(Vn&&(Un=arrayInstrumentations[Ve]))return Un;if(Ve==="hasOwnProperty")return hasOwnProperty}const Nn=Reflect.get(f,Ve,isRef(f)?f:Ue);return(isSymbol(Ve)?builtInSymbols.has(Ve):isNonTrackableKeys(Ve))||(Je||track(f,"get",Ve),Bn)?Nn:isRef(Nn)?Vn&&isIntegerKey(Ve)?Nn:Nn.value:isObject(Nn)?Je?readonly(Nn):reactive(Nn):Nn}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(f=!1){super(!1,f)}set(f,Ve,Ue,Je){let Bn=f[Ve];if(!this._isShallow){const Un=isReadonly(Bn);if(!isShallow(Ue)&&!isReadonly(Ue)&&(Bn=toRaw(Bn),Ue=toRaw(Ue)),!isArray(f)&&isRef(Bn)&&!isRef(Ue))return Un?!1:(Bn.value=Ue,!0)}const Vn=isArray(f)&&isIntegerKey(Ve)?Number(Ve)<f.length:hasOwn(f,Ve),Nn=Reflect.set(f,Ve,Ue,isRef(f)?f:Je);return f===toRaw(Je)&&(Vn?hasChanged(Ue,Bn)&&trigger(f,"set",Ve,Ue):trigger(f,"add",Ve,Ue)),Nn}deleteProperty(f,Ve){const Ue=hasOwn(f,Ve);f[Ve];const Je=Reflect.deleteProperty(f,Ve);return Je&&Ue&&trigger(f,"delete",Ve,void 0),Je}has(f,Ve){const Ue=Reflect.has(f,Ve);return(!isSymbol(Ve)||!builtInSymbols.has(Ve))&&track(f,"has",Ve),Ue}ownKeys(f){return track(f,"iterate",isArray(f)?"length":ITERATE_KEY),Reflect.ownKeys(f)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(f=!1){super(!0,f)}set(f,Ve){return!0}deleteProperty(f,Ve){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=qe=>qe,getProto=qe=>Reflect.getPrototypeOf(qe);function createIterableMethod(qe,f,Ve){return function(...Ue){const Je=this.__v_raw,Bn=toRaw(Je),Vn=isMap(Bn),Nn=qe==="entries"||qe===Symbol.iterator&&Vn,Un=qe==="keys"&&Vn,qn=Je[qe](...Ue),qo=Ve?toShallow:f?toReadonly:toReactive;return!f&&track(Bn,"iterate",Un?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:$o,done:Zo}=qn.next();return Zo?{value:$o,done:Zo}:{value:Nn?[qo($o[0]),qo($o[1])]:qo($o),done:Zo}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(qe){return function(...f){return qe==="delete"?!1:qe==="clear"?void 0:this}}function createInstrumentations(qe,f){const Ve={get(Je){const Bn=this.__v_raw,Vn=toRaw(Bn),Nn=toRaw(Je);qe||(hasChanged(Je,Nn)&&track(Vn,"get",Je),track(Vn,"get",Nn));const{has:Un}=getProto(Vn),qn=f?toShallow:qe?toReadonly:toReactive;if(Un.call(Vn,Je))return qn(Bn.get(Je));if(Un.call(Vn,Nn))return qn(Bn.get(Nn));Bn!==Vn&&Bn.get(Je)},get size(){const Je=this.__v_raw;return!qe&&track(toRaw(Je),"iterate",ITERATE_KEY),Reflect.get(Je,"size",Je)},has(Je){const Bn=this.__v_raw,Vn=toRaw(Bn),Nn=toRaw(Je);return qe||(hasChanged(Je,Nn)&&track(Vn,"has",Je),track(Vn,"has",Nn)),Je===Nn?Bn.has(Je):Bn.has(Je)||Bn.has(Nn)},forEach(Je,Bn){const Vn=this,Nn=Vn.__v_raw,Un=toRaw(Nn),qn=f?toShallow:qe?toReadonly:toReactive;return!qe&&track(Un,"iterate",ITERATE_KEY),Nn.forEach((qo,$o)=>Je.call(Bn,qn(qo),qn($o),Vn))}};return extend(Ve,qe?{add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear")}:{add(Je){!f&&!isShallow(Je)&&!isReadonly(Je)&&(Je=toRaw(Je));const Bn=toRaw(this);return getProto(Bn).has.call(Bn,Je)||(Bn.add(Je),trigger(Bn,"add",Je,Je)),this},set(Je,Bn){!f&&!isShallow(Bn)&&!isReadonly(Bn)&&(Bn=toRaw(Bn));const Vn=toRaw(this),{has:Nn,get:Un}=getProto(Vn);let qn=Nn.call(Vn,Je);qn||(Je=toRaw(Je),qn=Nn.call(Vn,Je));const qo=Un.call(Vn,Je);return Vn.set(Je,Bn),qn?hasChanged(Bn,qo)&&trigger(Vn,"set",Je,Bn):trigger(Vn,"add",Je,Bn),this},delete(Je){const Bn=toRaw(this),{has:Vn,get:Nn}=getProto(Bn);let Un=Vn.call(Bn,Je);Un||(Je=toRaw(Je),Un=Vn.call(Bn,Je)),Nn&&Nn.call(Bn,Je);const qn=Bn.delete(Je);return Un&&trigger(Bn,"delete",Je,void 0),qn},clear(){const Je=toRaw(this),Bn=Je.size!==0,Vn=Je.clear();return Bn&&trigger(Je,"clear",void 0,void 0),Vn}}),["keys","values","entries",Symbol.iterator].forEach(Je=>{Ve[Je]=createIterableMethod(Je,qe,f)}),Ve}function createInstrumentationGetter(qe,f){const Ve=createInstrumentations(qe,f);return(Ue,Je,Bn)=>Je==="__v_isReactive"?!qe:Je==="__v_isReadonly"?qe:Je==="__v_raw"?Ue:Reflect.get(hasOwn(Ve,Je)&&Je in Ue?Ve:Ue,Je,Bn)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(qe){switch(qe){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(qe){return qe.__v_skip||!Object.isExtensible(qe)?0:targetTypeMap(toRawType(qe))}function reactive(qe){return isReadonly(qe)?qe:createReactiveObject(qe,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(qe){return createReactiveObject(qe,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(qe){return createReactiveObject(qe,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(qe){return createReactiveObject(qe,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(qe,f,Ve,Ue,Je){if(!isObject(qe)||qe.__v_raw&&!(f&&qe.__v_isReactive))return qe;const Bn=Je.get(qe);if(Bn)return Bn;const Vn=getTargetType(qe);if(Vn===0)return qe;const Nn=new Proxy(qe,Vn===2?Ue:Ve);return Je.set(qe,Nn),Nn}function isReactive(qe){return isReadonly(qe)?isReactive(qe.__v_raw):!!(qe&&qe.__v_isReactive)}function isReadonly(qe){return!!(qe&&qe.__v_isReadonly)}function isShallow(qe){return!!(qe&&qe.__v_isShallow)}function isProxy(qe){return qe?!!qe.__v_raw:!1}function toRaw(qe){const f=qe&&qe.__v_raw;return f?toRaw(f):qe}function markRaw(qe){return!hasOwn(qe,"__v_skip")&&Object.isExtensible(qe)&&def(qe,"__v_skip",!0),qe}const toReactive=qe=>isObject(qe)?reactive(qe):qe,toReadonly=qe=>isObject(qe)?readonly(qe):qe;function isRef(qe){return qe?qe.__v_isRef===!0:!1}function ref(qe){return createRef(qe,!1)}function createRef(qe,f){return isRef(qe)?qe:new RefImpl(qe,f)}class RefImpl{constructor(f,Ve){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=Ve?f:toRaw(f),this._value=Ve?f:toReactive(f),this.__v_isShallow=Ve}get value(){return this.dep.track(),this._value}set value(f){const Ve=this._rawValue,Ue=this.__v_isShallow||isShallow(f)||isReadonly(f);f=Ue?f:toRaw(f),hasChanged(f,Ve)&&(this._rawValue=f,this._value=Ue?f:toReactive(f),this.dep.trigger())}}function unref(qe){return isRef(qe)?qe.value:qe}const shallowUnwrapHandlers={get:(qe,f,Ve)=>f==="__v_raw"?qe:unref(Reflect.get(qe,f,Ve)),set:(qe,f,Ve,Ue)=>{const Je=qe[f];return isRef(Je)&&!isRef(Ve)?(Je.value=Ve,!0):Reflect.set(qe,f,Ve,Ue)}};function proxyRefs(qe){return isReactive(qe)?qe:new Proxy(qe,shallowUnwrapHandlers)}function toRefs(qe){const f=isArray(qe)?new Array(qe.length):{};for(const Ve in qe)f[Ve]=propertyToRef(qe,Ve);return f}class ObjectRefImpl{constructor(f,Ve,Ue){this._object=f,this._key=Ve,this._defaultValue=Ue,this.__v_isRef=!0,this._value=void 0}get value(){const f=this._object[this._key];return this._value=f===void 0?this._defaultValue:f}set value(f){this._object[this._key]=f}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}function propertyToRef(qe,f,Ve){const Ue=qe[f];return isRef(Ue)?Ue:new ObjectRefImpl(qe,f,Ve)}class ComputedRefImpl{constructor(f,Ve,Ue){this.fn=f,this.setter=Ve,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!Ve,this.isSSR=Ue}notify(){if(this.flags|=16,!(this.flags&8)&&activeSub!==this)return batch(this,!0),!0}get value(){const f=this.dep.track();return refreshComputed(this),f&&(f.version=this.dep.version),this._value}set value(f){this.setter&&this.setter(f)}}function computed$1(qe,f,Ve=!1){let Ue,Je;return isFunction(qe)?Ue=qe:(Ue=qe.get,Je=qe.set),new ComputedRefImpl(Ue,Je,Ve)}const INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap;let activeWatcher;function onWatcherCleanup(qe,f=!1,Ve=activeWatcher){if(Ve){let Ue=cleanupMap.get(Ve);Ue||cleanupMap.set(Ve,Ue=[]),Ue.push(qe)}}function watch$1(qe,f,Ve=EMPTY_OBJ){const{immediate:Ue,deep:Je,once:Bn,scheduler:Vn,augmentJob:Nn,call:Un}=Ve,qn=la=>Je?la:isShallow(la)||Je===!1||Je===0?traverse(la,1):traverse(la);let qo,$o,Zo,ta,ea=!1,ra=!1;if(isRef(qe)?($o=()=>qe.value,ea=isShallow(qe)):isReactive(qe)?($o=()=>qn(qe),ea=!0):isArray(qe)?(ra=!0,ea=qe.some(la=>isReactive(la)||isShallow(la)),$o=()=>qe.map(la=>{if(isRef(la))return la.value;if(isReactive(la))return qn(la);if(isFunction(la))return Un?Un(la,2):la()})):isFunction(qe)?f?$o=Un?()=>Un(qe,2):qe:$o=()=>{if(Zo){pauseTracking();try{Zo()}finally{resetTracking()}}const la=activeWatcher;activeWatcher=qo;try{return Un?Un(qe,3,[ta]):qe(ta)}finally{activeWatcher=la}}:$o=NOOP,f&&Je){const la=$o,ma=Je===!0?1/0:Je;$o=()=>traverse(la(),ma)}const na=getCurrentScope(),oa=()=>{qo.stop(),na&&na.active&&remove(na.effects,qo)};if(Bn&&f){const la=f;f=(...ma)=>{la(...ma),oa()}}let ca=ra?new Array(qe.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const pa=la=>{if(!(!(qo.flags&1)||!qo.dirty&&!la))if(f){const ma=qo.run();if(Je||ea||(ra?ma.some((Ca,Sa)=>hasChanged(Ca,ca[Sa])):hasChanged(ma,ca))){Zo&&Zo();const Ca=activeWatcher;activeWatcher=qo;try{const Sa=[ma,ca===INITIAL_WATCHER_VALUE?void 0:ra&&ca[0]===INITIAL_WATCHER_VALUE?[]:ca,ta];Un?Un(f,3,Sa):f(...Sa),ca=ma}finally{activeWatcher=Ca}}}else qo.run()};return Nn&&Nn(pa),qo=new ReactiveEffect($o),qo.scheduler=Vn?()=>Vn(pa,!1):pa,ta=la=>onWatcherCleanup(la,!1,qo),Zo=qo.onStop=()=>{const la=cleanupMap.get(qo);if(la){if(Un)Un(la,4);else for(const ma of la)ma();cleanupMap.delete(qo)}},f?Ue?pa(!0):ca=qo.run():Vn?Vn(pa.bind(null,!0),!0):qo.run(),oa.pause=qo.pause.bind(qo),oa.resume=qo.resume.bind(qo),oa.stop=oa,oa}function traverse(qe,f=1/0,Ve){if(f<=0||!isObject(qe)||qe.__v_skip||(Ve=Ve||new Set,Ve.has(qe)))return qe;if(Ve.add(qe),f--,isRef(qe))traverse(qe.value,f,Ve);else if(isArray(qe))for(let Ue=0;Ue<qe.length;Ue++)traverse(qe[Ue],f,Ve);else if(isSet(qe)||isMap(qe))qe.forEach(Ue=>{traverse(Ue,f,Ve)});else if(isPlainObject$1(qe)){for(const Ue in qe)traverse(qe[Ue],f,Ve);for(const Ue of Object.getOwnPropertySymbols(qe))Object.prototype.propertyIsEnumerable.call(qe,Ue)&&traverse(qe[Ue],f,Ve)}return qe}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];let isWarning=!1;function warn$1(qe,...f){if(isWarning)return;isWarning=!0,pauseTracking();const Ve=stack.length?stack[stack.length-1].component:null,Ue=Ve&&Ve.appContext.config.warnHandler,Je=getComponentTrace();if(Ue)callWithErrorHandling(Ue,Ve,11,[qe+f.map(Bn=>{var Vn,Nn;return(Nn=(Vn=Bn.toString)==null?void 0:Vn.call(Bn))!=null?Nn:JSON.stringify(Bn)}).join(""),Ve&&Ve.proxy,Je.map(({vnode:Bn})=>`at <${formatComponentName(Ve,Bn.type)}>`).join(`
`),Je]);else{const Bn=[`[Vue warn]: ${qe}`,...f];Je.length&&Bn.push(`
`,...formatTrace(Je)),console.warn(...Bn)}resetTracking(),isWarning=!1}function getComponentTrace(){let qe=stack[stack.length-1];if(!qe)return[];const f=[];for(;qe;){const Ve=f[0];Ve&&Ve.vnode===qe?Ve.recurseCount++:f.push({vnode:qe,recurseCount:0});const Ue=qe.component&&qe.component.parent;qe=Ue&&Ue.vnode}return f}function formatTrace(qe){const f=[];return qe.forEach((Ve,Ue)=>{f.push(...Ue===0?[]:[`
`],...formatTraceEntry(Ve))}),f}function formatTraceEntry({vnode:qe,recurseCount:f}){const Ve=f>0?`... (${f} recursive calls)`:"",Ue=qe.component?qe.component.parent==null:!1,Je=` at <${formatComponentName(qe.component,qe.type,Ue)}`,Bn=">"+Ve;return qe.props?[Je,...formatProps(qe.props),Bn]:[Je+Bn]}function formatProps(qe){const f=[],Ve=Object.keys(qe);return Ve.slice(0,3).forEach(Ue=>{f.push(...formatProp(Ue,qe[Ue]))}),Ve.length>3&&f.push(" ..."),f}function formatProp(qe,f,Ve){return isString(f)?(f=JSON.stringify(f),Ve?f:[`${qe}=${f}`]):typeof f=="number"||typeof f=="boolean"||f==null?Ve?f:[`${qe}=${f}`]:isRef(f)?(f=formatProp(qe,toRaw(f.value),!0),Ve?f:[`${qe}=Ref<`,f,">"]):isFunction(f)?[`${qe}=fn${f.name?`<${f.name}>`:""}`]:(f=toRaw(f),Ve?f:[`${qe}=`,f])}function callWithErrorHandling(qe,f,Ve,Ue){try{return Ue?qe(...Ue):qe()}catch(Je){handleError(Je,f,Ve)}}function callWithAsyncErrorHandling(qe,f,Ve,Ue){if(isFunction(qe)){const Je=callWithErrorHandling(qe,f,Ve,Ue);return Je&&isPromise(Je)&&Je.catch(Bn=>{handleError(Bn,f,Ve)}),Je}if(isArray(qe)){const Je=[];for(let Bn=0;Bn<qe.length;Bn++)Je.push(callWithAsyncErrorHandling(qe[Bn],f,Ve,Ue));return Je}}function handleError(qe,f,Ve,Ue=!0){const Je=f?f.vnode:null,{errorHandler:Bn,throwUnhandledErrorInProduction:Vn}=f&&f.appContext.config||EMPTY_OBJ;if(f){let Nn=f.parent;const Un=f.proxy,qn=`https://vuejs.org/error-reference/#runtime-${Ve}`;for(;Nn;){const qo=Nn.ec;if(qo){for(let $o=0;$o<qo.length;$o++)if(qo[$o](qe,Un,qn)===!1)return}Nn=Nn.parent}if(Bn){pauseTracking(),callWithErrorHandling(Bn,null,10,[qe,Un,qn]),resetTracking();return}}logError(qe,Ve,Je,Ue,Vn)}function logError(qe,f,Ve,Ue=!0,Je=!1){if(Je)throw qe;console.error(qe)}const queue=[];let flushIndex=-1;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(qe){const f=currentFlushPromise||resolvedPromise;return qe?f.then(this?qe.bind(this):qe):f}function findInsertionIndex(qe){let f=flushIndex+1,Ve=queue.length;for(;f<Ve;){const Ue=f+Ve>>>1,Je=queue[Ue],Bn=getId(Je);Bn<qe||Bn===qe&&Je.flags&2?f=Ue+1:Ve=Ue}return f}function queueJob(qe){if(!(qe.flags&1)){const f=getId(qe),Ve=queue[queue.length-1];!Ve||!(qe.flags&2)&&f>=getId(Ve)?queue.push(qe):queue.splice(findInsertionIndex(f),0,qe),qe.flags|=1,queueFlush()}}function queueFlush(){currentFlushPromise||(currentFlushPromise=resolvedPromise.then(flushJobs))}function queuePostFlushCb(qe){isArray(qe)?pendingPostFlushCbs.push(...qe):activePostFlushCbs&&qe.id===-1?activePostFlushCbs.splice(postFlushIndex+1,0,qe):qe.flags&1||(pendingPostFlushCbs.push(qe),qe.flags|=1),queueFlush()}function flushPreFlushCbs(qe,f,Ve=flushIndex+1){for(;Ve<queue.length;Ve++){const Ue=queue[Ve];if(Ue&&Ue.flags&2){if(qe&&Ue.id!==qe.uid)continue;queue.splice(Ve,1),Ve--,Ue.flags&4&&(Ue.flags&=-2),Ue(),Ue.flags&4||(Ue.flags&=-2)}}}function flushPostFlushCbs(qe){if(pendingPostFlushCbs.length){const f=[...new Set(pendingPostFlushCbs)].sort((Ve,Ue)=>getId(Ve)-getId(Ue));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...f);return}for(activePostFlushCbs=f,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){const Ve=activePostFlushCbs[postFlushIndex];Ve.flags&4&&(Ve.flags&=-2),Ve.flags&8||Ve(),Ve.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}const getId=qe=>qe.id==null?qe.flags&2?-1:1/0:qe.id;function flushJobs(qe){try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const f=queue[flushIndex];f&&!(f.flags&8)&&(f.flags&4&&(f.flags&=-2),callWithErrorHandling(f,f.i,f.i?15:14),f.flags&4||(f.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){const f=queue[flushIndex];f&&(f.flags&=-2)}flushIndex=-1,queue.length=0,flushPostFlushCbs(),currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(qe){const f=currentRenderingInstance;return currentRenderingInstance=qe,currentScopeId=qe&&qe.type.__scopeId||null,f}function withCtx(qe,f=currentRenderingInstance,Ve){if(!f||qe._n)return qe;const Ue=(...Je)=>{Ue._d&&setBlockTracking(-1);const Bn=setCurrentRenderingInstance(f);let Vn;try{Vn=qe(...Je)}finally{setCurrentRenderingInstance(Bn),Ue._d&&setBlockTracking(1)}return Vn};return Ue._n=!0,Ue._c=!0,Ue._d=!0,Ue}function withDirectives(qe,f){if(currentRenderingInstance===null)return qe;const Ve=getComponentPublicInstance(currentRenderingInstance),Ue=qe.dirs||(qe.dirs=[]);for(let Je=0;Je<f.length;Je++){let[Bn,Vn,Nn,Un=EMPTY_OBJ]=f[Je];Bn&&(isFunction(Bn)&&(Bn={mounted:Bn,updated:Bn}),Bn.deep&&traverse(Vn),Ue.push({dir:Bn,instance:Ve,value:Vn,oldValue:void 0,arg:Nn,modifiers:Un}))}return qe}function invokeDirectiveHook(qe,f,Ve,Ue){const Je=qe.dirs,Bn=f&&f.dirs;for(let Vn=0;Vn<Je.length;Vn++){const Nn=Je[Vn];Bn&&(Nn.oldValue=Bn[Vn].value);let Un=Nn.dir[Ue];Un&&(pauseTracking(),callWithAsyncErrorHandling(Un,Ve,8,[qe.el,Nn,qe,f]),resetTracking())}}const TeleportEndKey=Symbol("_vte"),isTeleport=qe=>qe.__isTeleport;function setTransitionHooks(qe,f){qe.shapeFlag&6&&qe.component?(qe.transition=f,setTransitionHooks(qe.component.subTree,f)):qe.shapeFlag&128?(qe.ssContent.transition=f.clone(qe.ssContent),qe.ssFallback.transition=f.clone(qe.ssFallback)):qe.transition=f}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(qe,f){return isFunction(qe)?extend({name:qe.name},f,{setup:qe}):qe}function markAsyncBoundary(qe){qe.ids=[qe.ids[0]+qe.ids[2]+++"-",0,0]}function setRef(qe,f,Ve,Ue,Je=!1){if(isArray(qe)){qe.forEach((ea,ra)=>setRef(ea,f&&(isArray(f)?f[ra]:f),Ve,Ue,Je));return}if(isAsyncWrapper(Ue)&&!Je){Ue.shapeFlag&512&&Ue.type.__asyncResolved&&Ue.component.subTree.component&&setRef(qe,f,Ve,Ue.component.subTree);return}const Bn=Ue.shapeFlag&4?getComponentPublicInstance(Ue.component):Ue.el,Vn=Je?null:Bn,{i:Nn,r:Un}=qe,qn=f&&f.r,qo=Nn.refs===EMPTY_OBJ?Nn.refs={}:Nn.refs,$o=Nn.setupState,Zo=toRaw($o),ta=$o===EMPTY_OBJ?()=>!1:ea=>hasOwn(Zo,ea);if(qn!=null&&qn!==Un&&(isString(qn)?(qo[qn]=null,ta(qn)&&($o[qn]=null)):isRef(qn)&&(qn.value=null)),isFunction(Un))callWithErrorHandling(Un,Nn,12,[Vn,qo]);else{const ea=isString(Un),ra=isRef(Un);if(ea||ra){const na=()=>{if(qe.f){const oa=ea?ta(Un)?$o[Un]:qo[Un]:Un.value;Je?isArray(oa)&&remove(oa,Bn):isArray(oa)?oa.includes(Bn)||oa.push(Bn):ea?(qo[Un]=[Bn],ta(Un)&&($o[Un]=qo[Un])):(Un.value=[Bn],qe.k&&(qo[qe.k]=Un.value))}else ea?(qo[Un]=Vn,ta(Un)&&($o[Un]=Vn)):ra&&(Un.value=Vn,qe.k&&(qo[qe.k]=Vn))};Vn?(na.id=-1,queuePostRenderEffect(na,Ve)):na()}}}getGlobalThis().requestIdleCallback;getGlobalThis().cancelIdleCallback;const isAsyncWrapper=qe=>!!qe.type.__asyncLoader,isKeepAlive=qe=>qe.type.__isKeepAlive;function onActivated(qe,f){registerKeepAliveHook(qe,"a",f)}function onDeactivated(qe,f){registerKeepAliveHook(qe,"da",f)}function registerKeepAliveHook(qe,f,Ve=currentInstance){const Ue=qe.__wdc||(qe.__wdc=()=>{let Je=Ve;for(;Je;){if(Je.isDeactivated)return;Je=Je.parent}return qe()});if(injectHook(f,Ue,Ve),Ve){let Je=Ve.parent;for(;Je&&Je.parent;)isKeepAlive(Je.parent.vnode)&&injectToKeepAliveRoot(Ue,f,Ve,Je),Je=Je.parent}}function injectToKeepAliveRoot(qe,f,Ve,Ue){const Je=injectHook(f,qe,Ue,!0);onUnmounted(()=>{remove(Ue[f],Je)},Ve)}function injectHook(qe,f,Ve=currentInstance,Ue=!1){if(Ve){const Je=Ve[qe]||(Ve[qe]=[]),Bn=f.__weh||(f.__weh=(...Vn)=>{pauseTracking();const Nn=setCurrentInstance(Ve),Un=callWithAsyncErrorHandling(f,Ve,qe,Vn);return Nn(),resetTracking(),Un});return Ue?Je.unshift(Bn):Je.push(Bn),Bn}}const createHook=qe=>(f,Ve=currentInstance)=>{(!isInSSRComponentSetup||qe==="sp")&&injectHook(qe,(...Ue)=>f(...Ue),Ve)},onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(qe,f=currentInstance){injectHook("ec",qe,f)}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function renderList(qe,f,Ve,Ue){let Je;const Bn=Ve,Vn=isArray(qe);if(Vn||isString(qe)){const Nn=Vn&&isReactive(qe);let Un=!1;Nn&&(Un=!isShallow(qe),qe=shallowReadArray(qe)),Je=new Array(qe.length);for(let qn=0,qo=qe.length;qn<qo;qn++)Je[qn]=f(Un?toReactive(qe[qn]):qe[qn],qn,void 0,Bn)}else if(typeof qe=="number"){Je=new Array(qe);for(let Nn=0;Nn<qe;Nn++)Je[Nn]=f(Nn+1,Nn,void 0,Bn)}else if(isObject(qe))if(qe[Symbol.iterator])Je=Array.from(qe,(Nn,Un)=>f(Nn,Un,void 0,Bn));else{const Nn=Object.keys(qe);Je=new Array(Nn.length);for(let Un=0,qn=Nn.length;Un<qn;Un++){const qo=Nn[Un];Je[Un]=f(qe[qo],qo,Un,Bn)}}else Je=[];return Je}const getPublicInstance=qe=>qe?isStatefulComponent(qe)?getComponentPublicInstance(qe):getPublicInstance(qe.parent):null,publicPropertiesMap=extend(Object.create(null),{$:qe=>qe,$el:qe=>qe.vnode.el,$data:qe=>qe.data,$props:qe=>qe.props,$attrs:qe=>qe.attrs,$slots:qe=>qe.slots,$refs:qe=>qe.refs,$parent:qe=>getPublicInstance(qe.parent),$root:qe=>getPublicInstance(qe.root),$host:qe=>qe.ce,$emit:qe=>qe.emit,$options:qe=>resolveMergedOptions(qe),$forceUpdate:qe=>qe.f||(qe.f=()=>{queueJob(qe.update)}),$nextTick:qe=>qe.n||(qe.n=nextTick.bind(qe.proxy)),$watch:qe=>instanceWatch.bind(qe)}),hasSetupBinding=(qe,f)=>qe!==EMPTY_OBJ&&!qe.__isScriptSetup&&hasOwn(qe,f),PublicInstanceProxyHandlers={get({_:qe},f){if(f==="__v_skip")return!0;const{ctx:Ve,setupState:Ue,data:Je,props:Bn,accessCache:Vn,type:Nn,appContext:Un}=qe;let qn;if(f[0]!=="$"){const ta=Vn[f];if(ta!==void 0)switch(ta){case 1:return Ue[f];case 2:return Je[f];case 4:return Ve[f];case 3:return Bn[f]}else{if(hasSetupBinding(Ue,f))return Vn[f]=1,Ue[f];if(Je!==EMPTY_OBJ&&hasOwn(Je,f))return Vn[f]=2,Je[f];if((qn=qe.propsOptions[0])&&hasOwn(qn,f))return Vn[f]=3,Bn[f];if(Ve!==EMPTY_OBJ&&hasOwn(Ve,f))return Vn[f]=4,Ve[f];shouldCacheAccess&&(Vn[f]=0)}}const qo=publicPropertiesMap[f];let $o,Zo;if(qo)return f==="$attrs"&&track(qe.attrs,"get",""),qo(qe);if(($o=Nn.__cssModules)&&($o=$o[f]))return $o;if(Ve!==EMPTY_OBJ&&hasOwn(Ve,f))return Vn[f]=4,Ve[f];if(Zo=Un.config.globalProperties,hasOwn(Zo,f))return Zo[f]},set({_:qe},f,Ve){const{data:Ue,setupState:Je,ctx:Bn}=qe;return hasSetupBinding(Je,f)?(Je[f]=Ve,!0):Ue!==EMPTY_OBJ&&hasOwn(Ue,f)?(Ue[f]=Ve,!0):hasOwn(qe.props,f)||f[0]==="$"&&f.slice(1)in qe?!1:(Bn[f]=Ve,!0)},has({_:{data:qe,setupState:f,accessCache:Ve,ctx:Ue,appContext:Je,propsOptions:Bn}},Vn){let Nn;return!!Ve[Vn]||qe!==EMPTY_OBJ&&hasOwn(qe,Vn)||hasSetupBinding(f,Vn)||(Nn=Bn[0])&&hasOwn(Nn,Vn)||hasOwn(Ue,Vn)||hasOwn(publicPropertiesMap,Vn)||hasOwn(Je.config.globalProperties,Vn)},defineProperty(qe,f,Ve){return Ve.get!=null?qe._.accessCache[f]=0:hasOwn(Ve,"value")&&this.set(qe,f,Ve.value,null),Reflect.defineProperty(qe,f,Ve)}};function normalizePropsOrEmits(qe){return isArray(qe)?qe.reduce((f,Ve)=>(f[Ve]=null,f),{}):qe}let shouldCacheAccess=!0;function applyOptions(qe){const f=resolveMergedOptions(qe),Ve=qe.proxy,Ue=qe.ctx;shouldCacheAccess=!1,f.beforeCreate&&callHook(f.beforeCreate,qe,"bc");const{data:Je,computed:Bn,methods:Vn,watch:Nn,provide:Un,inject:qn,created:qo,beforeMount:$o,mounted:Zo,beforeUpdate:ta,updated:ea,activated:ra,deactivated:na,beforeDestroy:oa,beforeUnmount:ca,destroyed:pa,unmounted:la,render:ma,renderTracked:Ca,renderTriggered:Sa,errorCaptured:ga,serverPrefetch:ba,expose:Ha,inheritAttrs:Ja,components:tc,directives:Ua,filters:sc}=f;if(qn&&resolveInjections(qn,Ue,null),Vn)for(const Na in Vn){const Ta=Vn[Na];isFunction(Ta)&&(Ue[Na]=Ta.bind(Ve))}if(Je){const Na=Je.call(Ve,Ve);isObject(Na)&&(qe.data=reactive(Na))}if(shouldCacheAccess=!0,Bn)for(const Na in Bn){const Ta=Bn[Na],nc=isFunction(Ta)?Ta.bind(Ve,Ve):isFunction(Ta.get)?Ta.get.bind(Ve,Ve):NOOP,oc=!isFunction(Ta)&&isFunction(Ta.set)?Ta.set.bind(Ve):NOOP,fc=computed({get:nc,set:oc});Object.defineProperty(Ue,Na,{enumerable:!0,configurable:!0,get:()=>fc.value,set:ac=>fc.value=ac})}if(Nn)for(const Na in Nn)createWatcher(Nn[Na],Ue,Ve,Na);if(Un){const Na=isFunction(Un)?Un.call(Ve):Un;Reflect.ownKeys(Na).forEach(Ta=>{provide(Ta,Na[Ta])})}qo&&callHook(qo,qe,"c");function Ka(Na,Ta){isArray(Ta)?Ta.forEach(nc=>Na(nc.bind(Ve))):Ta&&Na(Ta.bind(Ve))}if(Ka(onBeforeMount,$o),Ka(onMounted,Zo),Ka(onBeforeUpdate,ta),Ka(onUpdated,ea),Ka(onActivated,ra),Ka(onDeactivated,na),Ka(onErrorCaptured,ga),Ka(onRenderTracked,Ca),Ka(onRenderTriggered,Sa),Ka(onBeforeUnmount,ca),Ka(onUnmounted,la),Ka(onServerPrefetch,ba),isArray(Ha))if(Ha.length){const Na=qe.exposed||(qe.exposed={});Ha.forEach(Ta=>{Object.defineProperty(Na,Ta,{get:()=>Ve[Ta],set:nc=>Ve[Ta]=nc})})}else qe.exposed||(qe.exposed={});ma&&qe.render===NOOP&&(qe.render=ma),Ja!=null&&(qe.inheritAttrs=Ja),tc&&(qe.components=tc),Ua&&(qe.directives=Ua),ba&&markAsyncBoundary(qe)}function resolveInjections(qe,f,Ve=NOOP){isArray(qe)&&(qe=normalizeInject(qe));for(const Ue in qe){const Je=qe[Ue];let Bn;isObject(Je)?"default"in Je?Bn=inject(Je.from||Ue,Je.default,!0):Bn=inject(Je.from||Ue):Bn=inject(Je),isRef(Bn)?Object.defineProperty(f,Ue,{enumerable:!0,configurable:!0,get:()=>Bn.value,set:Vn=>Bn.value=Vn}):f[Ue]=Bn}}function callHook(qe,f,Ve){callWithAsyncErrorHandling(isArray(qe)?qe.map(Ue=>Ue.bind(f.proxy)):qe.bind(f.proxy),f,Ve)}function createWatcher(qe,f,Ve,Ue){let Je=Ue.includes(".")?createPathGetter(Ve,Ue):()=>Ve[Ue];if(isString(qe)){const Bn=f[qe];isFunction(Bn)&&watch(Je,Bn)}else if(isFunction(qe))watch(Je,qe.bind(Ve));else if(isObject(qe))if(isArray(qe))qe.forEach(Bn=>createWatcher(Bn,f,Ve,Ue));else{const Bn=isFunction(qe.handler)?qe.handler.bind(Ve):f[qe.handler];isFunction(Bn)&&watch(Je,Bn,qe)}}function resolveMergedOptions(qe){const f=qe.type,{mixins:Ve,extends:Ue}=f,{mixins:Je,optionsCache:Bn,config:{optionMergeStrategies:Vn}}=qe.appContext,Nn=Bn.get(f);let Un;return Nn?Un=Nn:!Je.length&&!Ve&&!Ue?Un=f:(Un={},Je.length&&Je.forEach(qn=>mergeOptions(Un,qn,Vn,!0)),mergeOptions(Un,f,Vn)),isObject(f)&&Bn.set(f,Un),Un}function mergeOptions(qe,f,Ve,Ue=!1){const{mixins:Je,extends:Bn}=f;Bn&&mergeOptions(qe,Bn,Ve,!0),Je&&Je.forEach(Vn=>mergeOptions(qe,Vn,Ve,!0));for(const Vn in f)if(!(Ue&&Vn==="expose")){const Nn=internalOptionMergeStrats[Vn]||Ve&&Ve[Vn];qe[Vn]=Nn?Nn(qe[Vn],f[Vn]):f[Vn]}return qe}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(qe,f){return f?qe?function(){return extend(isFunction(qe)?qe.call(this,this):qe,isFunction(f)?f.call(this,this):f)}:f:qe}function mergeInject(qe,f){return mergeObjectOptions(normalizeInject(qe),normalizeInject(f))}function normalizeInject(qe){if(isArray(qe)){const f={};for(let Ve=0;Ve<qe.length;Ve++)f[qe[Ve]]=qe[Ve];return f}return qe}function mergeAsArray(qe,f){return qe?[...new Set([].concat(qe,f))]:f}function mergeObjectOptions(qe,f){return qe?extend(Object.create(null),qe,f):f}function mergeEmitsOrPropsOptions(qe,f){return qe?isArray(qe)&&isArray(f)?[...new Set([...qe,...f])]:extend(Object.create(null),normalizePropsOrEmits(qe),normalizePropsOrEmits(f??{})):f}function mergeWatchOptions(qe,f){if(!qe)return f;if(!f)return qe;const Ve=extend(Object.create(null),qe);for(const Ue in f)Ve[Ue]=mergeAsArray(qe[Ue],f[Ue]);return Ve}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(qe,f){return function(Ue,Je=null){isFunction(Ue)||(Ue=extend({},Ue)),Je!=null&&!isObject(Je)&&(Je=null);const Bn=createAppContext(),Vn=new WeakSet,Nn=[];let Un=!1;const qn=Bn.app={_uid:uid$1++,_component:Ue,_props:Je,_container:null,_context:Bn,_instance:null,version,get config(){return Bn.config},set config(qo){},use(qo,...$o){return Vn.has(qo)||(qo&&isFunction(qo.install)?(Vn.add(qo),qo.install(qn,...$o)):isFunction(qo)&&(Vn.add(qo),qo(qn,...$o))),qn},mixin(qo){return Bn.mixins.includes(qo)||Bn.mixins.push(qo),qn},component(qo,$o){return $o?(Bn.components[qo]=$o,qn):Bn.components[qo]},directive(qo,$o){return $o?(Bn.directives[qo]=$o,qn):Bn.directives[qo]},mount(qo,$o,Zo){if(!Un){const ta=qn._ceVNode||createVNode(Ue,Je);return ta.appContext=Bn,Zo===!0?Zo="svg":Zo===!1&&(Zo=void 0),qe(ta,qo,Zo),Un=!0,qn._container=qo,qo.__vue_app__=qn,getComponentPublicInstance(ta.component)}},onUnmount(qo){Nn.push(qo)},unmount(){Un&&(callWithAsyncErrorHandling(Nn,qn._instance,16),qe(null,qn._container),delete qn._container.__vue_app__)},provide(qo,$o){return Bn.provides[qo]=$o,qn},runWithContext(qo){const $o=currentApp;currentApp=qn;try{return qo()}finally{currentApp=$o}}};return qn}}let currentApp=null;function provide(qe,f){if(currentInstance){let Ve=currentInstance.provides;const Ue=currentInstance.parent&&currentInstance.parent.provides;Ue===Ve&&(Ve=currentInstance.provides=Object.create(Ue)),Ve[qe]=f}}function inject(qe,f,Ve=!1){const Ue=currentInstance||currentRenderingInstance;if(Ue||currentApp){const Je=currentApp?currentApp._context.provides:Ue?Ue.parent==null?Ue.vnode.appContext&&Ue.vnode.appContext.provides:Ue.parent.provides:void 0;if(Je&&qe in Je)return Je[qe];if(arguments.length>1)return Ve&&isFunction(f)?f.call(Ue&&Ue.proxy):f}}function hasInjectionContext(){return!!(currentInstance||currentRenderingInstance||currentApp)}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=qe=>Object.getPrototypeOf(qe)===internalObjectProto;function initProps(qe,f,Ve,Ue=!1){const Je={},Bn=createInternalObject();qe.propsDefaults=Object.create(null),setFullProps(qe,f,Je,Bn);for(const Vn in qe.propsOptions[0])Vn in Je||(Je[Vn]=void 0);Ve?qe.props=Ue?Je:shallowReactive(Je):qe.type.props?qe.props=Je:qe.props=Bn,qe.attrs=Bn}function updateProps(qe,f,Ve,Ue){const{props:Je,attrs:Bn,vnode:{patchFlag:Vn}}=qe,Nn=toRaw(Je),[Un]=qe.propsOptions;let qn=!1;if((Ue||Vn>0)&&!(Vn&16)){if(Vn&8){const qo=qe.vnode.dynamicProps;for(let $o=0;$o<qo.length;$o++){let Zo=qo[$o];if(isEmitListener(qe.emitsOptions,Zo))continue;const ta=f[Zo];if(Un)if(hasOwn(Bn,Zo))ta!==Bn[Zo]&&(Bn[Zo]=ta,qn=!0);else{const ea=camelize(Zo);Je[ea]=resolvePropValue(Un,Nn,ea,ta,qe,!1)}else ta!==Bn[Zo]&&(Bn[Zo]=ta,qn=!0)}}}else{setFullProps(qe,f,Je,Bn)&&(qn=!0);let qo;for(const $o in Nn)(!f||!hasOwn(f,$o)&&((qo=hyphenate($o))===$o||!hasOwn(f,qo)))&&(Un?Ve&&(Ve[$o]!==void 0||Ve[qo]!==void 0)&&(Je[$o]=resolvePropValue(Un,Nn,$o,void 0,qe,!0)):delete Je[$o]);if(Bn!==Nn)for(const $o in Bn)(!f||!hasOwn(f,$o))&&(delete Bn[$o],qn=!0)}qn&&trigger(qe.attrs,"set","")}function setFullProps(qe,f,Ve,Ue){const[Je,Bn]=qe.propsOptions;let Vn=!1,Nn;if(f)for(let Un in f){if(isReservedProp(Un))continue;const qn=f[Un];let qo;Je&&hasOwn(Je,qo=camelize(Un))?!Bn||!Bn.includes(qo)?Ve[qo]=qn:(Nn||(Nn={}))[qo]=qn:isEmitListener(qe.emitsOptions,Un)||(!(Un in Ue)||qn!==Ue[Un])&&(Ue[Un]=qn,Vn=!0)}if(Bn){const Un=toRaw(Ve),qn=Nn||EMPTY_OBJ;for(let qo=0;qo<Bn.length;qo++){const $o=Bn[qo];Ve[$o]=resolvePropValue(Je,Un,$o,qn[$o],qe,!hasOwn(qn,$o))}}return Vn}function resolvePropValue(qe,f,Ve,Ue,Je,Bn){const Vn=qe[Ve];if(Vn!=null){const Nn=hasOwn(Vn,"default");if(Nn&&Ue===void 0){const Un=Vn.default;if(Vn.type!==Function&&!Vn.skipFactory&&isFunction(Un)){const{propsDefaults:qn}=Je;if(Ve in qn)Ue=qn[Ve];else{const qo=setCurrentInstance(Je);Ue=qn[Ve]=Un.call(null,f),qo()}}else Ue=Un;Je.ce&&Je.ce._setProp(Ve,Ue)}Vn[0]&&(Bn&&!Nn?Ue=!1:Vn[1]&&(Ue===""||Ue===hyphenate(Ve))&&(Ue=!0))}return Ue}const mixinPropsCache=new WeakMap;function normalizePropsOptions(qe,f,Ve=!1){const Ue=Ve?mixinPropsCache:f.propsCache,Je=Ue.get(qe);if(Je)return Je;const Bn=qe.props,Vn={},Nn=[];let Un=!1;if(!isFunction(qe)){const qo=$o=>{Un=!0;const[Zo,ta]=normalizePropsOptions($o,f,!0);extend(Vn,Zo),ta&&Nn.push(...ta)};!Ve&&f.mixins.length&&f.mixins.forEach(qo),qe.extends&&qo(qe.extends),qe.mixins&&qe.mixins.forEach(qo)}if(!Bn&&!Un)return isObject(qe)&&Ue.set(qe,EMPTY_ARR),EMPTY_ARR;if(isArray(Bn))for(let qo=0;qo<Bn.length;qo++){const $o=camelize(Bn[qo]);validatePropName($o)&&(Vn[$o]=EMPTY_OBJ)}else if(Bn)for(const qo in Bn){const $o=camelize(qo);if(validatePropName($o)){const Zo=Bn[qo],ta=Vn[$o]=isArray(Zo)||isFunction(Zo)?{type:Zo}:extend({},Zo),ea=ta.type;let ra=!1,na=!0;if(isArray(ea))for(let oa=0;oa<ea.length;++oa){const ca=ea[oa],pa=isFunction(ca)&&ca.name;if(pa==="Boolean"){ra=!0;break}else pa==="String"&&(na=!1)}else ra=isFunction(ea)&&ea.name==="Boolean";ta[0]=ra,ta[1]=na,(ra||hasOwn(ta,"default"))&&Nn.push($o)}}const qn=[Vn,Nn];return isObject(qe)&&Ue.set(qe,qn),qn}function validatePropName(qe){return qe[0]!=="$"&&!isReservedProp(qe)}const isInternalKey=qe=>qe[0]==="_"||qe==="$stable",normalizeSlotValue=qe=>isArray(qe)?qe.map(normalizeVNode):[normalizeVNode(qe)],normalizeSlot=(qe,f,Ve)=>{if(f._n)return f;const Ue=withCtx((...Je)=>normalizeSlotValue(f(...Je)),Ve);return Ue._c=!1,Ue},normalizeObjectSlots=(qe,f,Ve)=>{const Ue=qe._ctx;for(const Je in qe){if(isInternalKey(Je))continue;const Bn=qe[Je];if(isFunction(Bn))f[Je]=normalizeSlot(Je,Bn,Ue);else if(Bn!=null){const Vn=normalizeSlotValue(Bn);f[Je]=()=>Vn}}},normalizeVNodeSlots=(qe,f)=>{const Ve=normalizeSlotValue(f);qe.slots.default=()=>Ve},assignSlots=(qe,f,Ve)=>{for(const Ue in f)(Ve||Ue!=="_")&&(qe[Ue]=f[Ue])},initSlots=(qe,f,Ve)=>{const Ue=qe.slots=createInternalObject();if(qe.vnode.shapeFlag&32){const Je=f._;Je?(assignSlots(Ue,f,Ve),Ve&&def(Ue,"_",Je,!0)):normalizeObjectSlots(f,Ue)}else f&&normalizeVNodeSlots(qe,f)},updateSlots=(qe,f,Ve)=>{const{vnode:Ue,slots:Je}=qe;let Bn=!0,Vn=EMPTY_OBJ;if(Ue.shapeFlag&32){const Nn=f._;Nn?Ve&&Nn===1?Bn=!1:assignSlots(Je,f,Ve):(Bn=!f.$stable,normalizeObjectSlots(f,Je)),Vn=f}else f&&(normalizeVNodeSlots(qe,f),Vn={default:1});if(Bn)for(const Nn in Je)!isInternalKey(Nn)&&Vn[Nn]==null&&delete Je[Nn]},queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(qe){return baseCreateRenderer(qe)}function baseCreateRenderer(qe,f){const Ve=getGlobalThis();Ve.__VUE__=!0;const{insert:Ue,remove:Je,patchProp:Bn,createElement:Vn,createText:Nn,createComment:Un,setText:qn,setElementText:qo,parentNode:$o,nextSibling:Zo,setScopeId:ta=NOOP,insertStaticContent:ea}=qe,ra=(sa,ia,aa,da=null,ha=null,ua=null,_a=void 0,ya=null,va=!!ia.dynamicChildren)=>{if(sa===ia)return;sa&&!isSameVNodeType(sa,ia)&&(da=pc(sa),ac(sa,ha,ua,!0),sa=null),ia.patchFlag===-2&&(va=!1,ia.dynamicChildren=null);const{type:fa,ref:ka,shapeFlag:xa}=ia;switch(fa){case Text:na(sa,ia,aa,da);break;case Comment:oa(sa,ia,aa,da);break;case Static:sa==null&&ca(ia,aa,da,_a);break;case Fragment:tc(sa,ia,aa,da,ha,ua,_a,ya,va);break;default:xa&1?ma(sa,ia,aa,da,ha,ua,_a,ya,va):xa&6?Ua(sa,ia,aa,da,ha,ua,_a,ya,va):(xa&64||xa&128)&&fa.process(sa,ia,aa,da,ha,ua,_a,ya,va,cc)}ka!=null&&ha&&setRef(ka,sa&&sa.ref,ua,ia||sa,!ia)},na=(sa,ia,aa,da)=>{if(sa==null)Ue(ia.el=Nn(ia.children),aa,da);else{const ha=ia.el=sa.el;ia.children!==sa.children&&qn(ha,ia.children)}},oa=(sa,ia,aa,da)=>{sa==null?Ue(ia.el=Un(ia.children||""),aa,da):ia.el=sa.el},ca=(sa,ia,aa,da)=>{[sa.el,sa.anchor]=ea(sa.children,ia,aa,da,sa.el,sa.anchor)},pa=({el:sa,anchor:ia},aa,da)=>{let ha;for(;sa&&sa!==ia;)ha=Zo(sa),Ue(sa,aa,da),sa=ha;Ue(ia,aa,da)},la=({el:sa,anchor:ia})=>{let aa;for(;sa&&sa!==ia;)aa=Zo(sa),Je(sa),sa=aa;Je(ia)},ma=(sa,ia,aa,da,ha,ua,_a,ya,va)=>{ia.type==="svg"?_a="svg":ia.type==="math"&&(_a="mathml"),sa==null?Ca(ia,aa,da,ha,ua,_a,ya,va):ba(sa,ia,ha,ua,_a,ya,va)},Ca=(sa,ia,aa,da,ha,ua,_a,ya)=>{let va,fa;const{props:ka,shapeFlag:xa,transition:wa,dirs:Ga}=sa;if(va=sa.el=Vn(sa.type,ua,ka&&ka.is,ka),xa&8?qo(va,sa.children):xa&16&&ga(sa.children,va,null,da,ha,resolveChildrenNamespace(sa,ua),_a,ya),Ga&&invokeDirectiveHook(sa,null,da,"created"),Sa(va,sa,sa.scopeId,_a,da),ka){for(const rc in ka)rc!=="value"&&!isReservedProp(rc)&&Bn(va,rc,null,ka[rc],ua,da);"value"in ka&&Bn(va,"value",null,ka.value,ua),(fa=ka.onVnodeBeforeMount)&&invokeVNodeHook(fa,da,sa)}Ga&&invokeDirectiveHook(sa,null,da,"beforeMount");const qa=needTransition(ha,wa);qa&&wa.beforeEnter(va),Ue(va,ia,aa),((fa=ka&&ka.onVnodeMounted)||qa||Ga)&&queuePostRenderEffect(()=>{fa&&invokeVNodeHook(fa,da,sa),qa&&wa.enter(va),Ga&&invokeDirectiveHook(sa,null,da,"mounted")},ha)},Sa=(sa,ia,aa,da,ha)=>{if(aa&&ta(sa,aa),da)for(let ua=0;ua<da.length;ua++)ta(sa,da[ua]);if(ha){let ua=ha.subTree;if(ia===ua||isSuspense(ua.type)&&(ua.ssContent===ia||ua.ssFallback===ia)){const _a=ha.vnode;Sa(sa,_a,_a.scopeId,_a.slotScopeIds,ha.parent)}}},ga=(sa,ia,aa,da,ha,ua,_a,ya,va=0)=>{for(let fa=va;fa<sa.length;fa++){const ka=sa[fa]=ya?cloneIfMounted(sa[fa]):normalizeVNode(sa[fa]);ra(null,ka,ia,aa,da,ha,ua,_a,ya)}},ba=(sa,ia,aa,da,ha,ua,_a)=>{const ya=ia.el=sa.el;let{patchFlag:va,dynamicChildren:fa,dirs:ka}=ia;va|=sa.patchFlag&16;const xa=sa.props||EMPTY_OBJ,wa=ia.props||EMPTY_OBJ;let Ga;if(aa&&toggleRecurse(aa,!1),(Ga=wa.onVnodeBeforeUpdate)&&invokeVNodeHook(Ga,aa,ia,sa),ka&&invokeDirectiveHook(ia,sa,aa,"beforeUpdate"),aa&&toggleRecurse(aa,!0),(xa.innerHTML&&wa.innerHTML==null||xa.textContent&&wa.textContent==null)&&qo(ya,""),fa?Ha(sa.dynamicChildren,fa,ya,aa,da,resolveChildrenNamespace(ia,ha),ua):_a||Ta(sa,ia,ya,null,aa,da,resolveChildrenNamespace(ia,ha),ua,!1),va>0){if(va&16)Ja(ya,xa,wa,aa,ha);else if(va&2&&xa.class!==wa.class&&Bn(ya,"class",null,wa.class,ha),va&4&&Bn(ya,"style",xa.style,wa.style,ha),va&8){const qa=ia.dynamicProps;for(let rc=0;rc<qa.length;rc++){const ec=qa[rc],uc=xa[ec],lc=wa[ec];(lc!==uc||ec==="value")&&Bn(ya,ec,uc,lc,ha,aa)}}va&1&&sa.children!==ia.children&&qo(ya,ia.children)}else!_a&&fa==null&&Ja(ya,xa,wa,aa,ha);((Ga=wa.onVnodeUpdated)||ka)&&queuePostRenderEffect(()=>{Ga&&invokeVNodeHook(Ga,aa,ia,sa),ka&&invokeDirectiveHook(ia,sa,aa,"updated")},da)},Ha=(sa,ia,aa,da,ha,ua,_a)=>{for(let ya=0;ya<ia.length;ya++){const va=sa[ya],fa=ia[ya],ka=va.el&&(va.type===Fragment||!isSameVNodeType(va,fa)||va.shapeFlag&70)?$o(va.el):aa;ra(va,fa,ka,null,da,ha,ua,_a,!0)}},Ja=(sa,ia,aa,da,ha)=>{if(ia!==aa){if(ia!==EMPTY_OBJ)for(const ua in ia)!isReservedProp(ua)&&!(ua in aa)&&Bn(sa,ua,ia[ua],null,ha,da);for(const ua in aa){if(isReservedProp(ua))continue;const _a=aa[ua],ya=ia[ua];_a!==ya&&ua!=="value"&&Bn(sa,ua,ya,_a,ha,da)}"value"in aa&&Bn(sa,"value",ia.value,aa.value,ha)}},tc=(sa,ia,aa,da,ha,ua,_a,ya,va)=>{const fa=ia.el=sa?sa.el:Nn(""),ka=ia.anchor=sa?sa.anchor:Nn("");let{patchFlag:xa,dynamicChildren:wa,slotScopeIds:Ga}=ia;Ga&&(ya=ya?ya.concat(Ga):Ga),sa==null?(Ue(fa,aa,da),Ue(ka,aa,da),ga(ia.children||[],aa,ka,ha,ua,_a,ya,va)):xa>0&&xa&64&&wa&&sa.dynamicChildren?(Ha(sa.dynamicChildren,wa,aa,ha,ua,_a,ya),(ia.key!=null||ha&&ia===ha.subTree)&&traverseStaticChildren(sa,ia,!0)):Ta(sa,ia,aa,ka,ha,ua,_a,ya,va)},Ua=(sa,ia,aa,da,ha,ua,_a,ya,va)=>{ia.slotScopeIds=ya,sa==null?ia.shapeFlag&512?ha.ctx.activate(ia,aa,da,_a,va):sc(ia,aa,da,ha,ua,_a,va):ic(sa,ia,va)},sc=(sa,ia,aa,da,ha,ua,_a)=>{const ya=sa.component=createComponentInstance(sa,da,ha);if(isKeepAlive(sa)&&(ya.ctx.renderer=cc),setupComponent(ya,!1,_a),ya.asyncDep){if(ha&&ha.registerDep(ya,Ka,_a),!sa.el){const va=ya.subTree=createVNode(Comment);oa(null,va,ia,aa)}}else Ka(ya,sa,ia,aa,ha,ua,_a)},ic=(sa,ia,aa)=>{const da=ia.component=sa.component;if(shouldUpdateComponent(sa,ia,aa))if(da.asyncDep&&!da.asyncResolved){Na(da,ia,aa);return}else da.next=ia,da.update();else ia.el=sa.el,da.vnode=ia},Ka=(sa,ia,aa,da,ha,ua,_a)=>{const ya=()=>{if(sa.isMounted){let{next:xa,bu:wa,u:Ga,parent:qa,vnode:rc}=sa;{const vc=locateNonHydratedAsyncRoot(sa);if(vc){xa&&(xa.el=rc.el,Na(sa,xa,_a)),vc.asyncDep.then(()=>{sa.isUnmounted||ya()});return}}let ec=xa,uc;toggleRecurse(sa,!1),xa?(xa.el=rc.el,Na(sa,xa,_a)):xa=rc,wa&&invokeArrayFns(wa),(uc=xa.props&&xa.props.onVnodeBeforeUpdate)&&invokeVNodeHook(uc,qa,xa,rc),toggleRecurse(sa,!0);const lc=renderComponentRoot(sa),mc=sa.subTree;sa.subTree=lc,ra(mc,lc,$o(mc.el),pc(mc),sa,ha,ua),xa.el=lc.el,ec===null&&updateHOCHostEl(sa,lc.el),Ga&&queuePostRenderEffect(Ga,ha),(uc=xa.props&&xa.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(uc,qa,xa,rc),ha)}else{let xa;const{el:wa,props:Ga}=ia,{bm:qa,m:rc,parent:ec,root:uc,type:lc}=sa,mc=isAsyncWrapper(ia);toggleRecurse(sa,!1),qa&&invokeArrayFns(qa),!mc&&(xa=Ga&&Ga.onVnodeBeforeMount)&&invokeVNodeHook(xa,ec,ia),toggleRecurse(sa,!0);{uc.ce&&uc.ce._injectChildStyle(lc);const vc=sa.subTree=renderComponentRoot(sa);ra(null,vc,aa,da,sa,ha,ua),ia.el=vc.el}if(rc&&queuePostRenderEffect(rc,ha),!mc&&(xa=Ga&&Ga.onVnodeMounted)){const vc=ia;queuePostRenderEffect(()=>invokeVNodeHook(xa,ec,vc),ha)}(ia.shapeFlag&256||ec&&isAsyncWrapper(ec.vnode)&&ec.vnode.shapeFlag&256)&&sa.a&&queuePostRenderEffect(sa.a,ha),sa.isMounted=!0,ia=aa=da=null}};sa.scope.on();const va=sa.effect=new ReactiveEffect(ya);sa.scope.off();const fa=sa.update=va.run.bind(va),ka=sa.job=va.runIfDirty.bind(va);ka.i=sa,ka.id=sa.uid,va.scheduler=()=>queueJob(ka),toggleRecurse(sa,!0),fa()},Na=(sa,ia,aa)=>{ia.component=sa;const da=sa.vnode.props;sa.vnode=ia,sa.next=null,updateProps(sa,ia.props,da,aa),updateSlots(sa,ia.children,aa),pauseTracking(),flushPreFlushCbs(sa),resetTracking()},Ta=(sa,ia,aa,da,ha,ua,_a,ya,va=!1)=>{const fa=sa&&sa.children,ka=sa?sa.shapeFlag:0,xa=ia.children,{patchFlag:wa,shapeFlag:Ga}=ia;if(wa>0){if(wa&128){oc(fa,xa,aa,da,ha,ua,_a,ya,va);return}else if(wa&256){nc(fa,xa,aa,da,ha,ua,_a,ya,va);return}}Ga&8?(ka&16&&hc(fa,ha,ua),xa!==fa&&qo(aa,xa)):ka&16?Ga&16?oc(fa,xa,aa,da,ha,ua,_a,ya,va):hc(fa,ha,ua,!0):(ka&8&&qo(aa,""),Ga&16&&ga(xa,aa,da,ha,ua,_a,ya,va))},nc=(sa,ia,aa,da,ha,ua,_a,ya,va)=>{sa=sa||EMPTY_ARR,ia=ia||EMPTY_ARR;const fa=sa.length,ka=ia.length,xa=Math.min(fa,ka);let wa;for(wa=0;wa<xa;wa++){const Ga=ia[wa]=va?cloneIfMounted(ia[wa]):normalizeVNode(ia[wa]);ra(sa[wa],Ga,aa,null,ha,ua,_a,ya,va)}fa>ka?hc(sa,ha,ua,!0,!1,xa):ga(ia,aa,da,ha,ua,_a,ya,va,xa)},oc=(sa,ia,aa,da,ha,ua,_a,ya,va)=>{let fa=0;const ka=ia.length;let xa=sa.length-1,wa=ka-1;for(;fa<=xa&&fa<=wa;){const Ga=sa[fa],qa=ia[fa]=va?cloneIfMounted(ia[fa]):normalizeVNode(ia[fa]);if(isSameVNodeType(Ga,qa))ra(Ga,qa,aa,null,ha,ua,_a,ya,va);else break;fa++}for(;fa<=xa&&fa<=wa;){const Ga=sa[xa],qa=ia[wa]=va?cloneIfMounted(ia[wa]):normalizeVNode(ia[wa]);if(isSameVNodeType(Ga,qa))ra(Ga,qa,aa,null,ha,ua,_a,ya,va);else break;xa--,wa--}if(fa>xa){if(fa<=wa){const Ga=wa+1,qa=Ga<ka?ia[Ga].el:da;for(;fa<=wa;)ra(null,ia[fa]=va?cloneIfMounted(ia[fa]):normalizeVNode(ia[fa]),aa,qa,ha,ua,_a,ya,va),fa++}}else if(fa>wa)for(;fa<=xa;)ac(sa[fa],ha,ua,!0),fa++;else{const Ga=fa,qa=fa,rc=new Map;for(fa=qa;fa<=wa;fa++){const dc=ia[fa]=va?cloneIfMounted(ia[fa]):normalizeVNode(ia[fa]);dc.key!=null&&rc.set(dc.key,fa)}let ec,uc=0;const lc=wa-qa+1;let mc=!1,vc=0;const Cc=new Array(lc);for(fa=0;fa<lc;fa++)Cc[fa]=0;for(fa=Ga;fa<=xa;fa++){const dc=sa[fa];if(uc>=lc){ac(dc,ha,ua,!0);continue}let yc;if(dc.key!=null)yc=rc.get(dc.key);else for(ec=qa;ec<=wa;ec++)if(Cc[ec-qa]===0&&isSameVNodeType(dc,ia[ec])){yc=ec;break}yc===void 0?ac(dc,ha,ua,!0):(Cc[yc-qa]=fa+1,yc>=vc?vc=yc:mc=!0,ra(dc,ia[yc],aa,null,ha,ua,_a,ya,va),uc++)}const Tc=mc?getSequence(Cc):EMPTY_ARR;for(ec=Tc.length-1,fa=lc-1;fa>=0;fa--){const dc=qa+fa,yc=ia[dc],Oc=dc+1<ka?ia[dc+1].el:da;Cc[fa]===0?ra(null,yc,aa,Oc,ha,ua,_a,ya,va):mc&&(ec<0||fa!==Tc[ec]?fc(yc,aa,Oc,2):ec--)}}},fc=(sa,ia,aa,da,ha=null)=>{const{el:ua,type:_a,transition:ya,children:va,shapeFlag:fa}=sa;if(fa&6){fc(sa.component.subTree,ia,aa,da);return}if(fa&128){sa.suspense.move(ia,aa,da);return}if(fa&64){_a.move(sa,ia,aa,cc);return}if(_a===Fragment){Ue(ua,ia,aa);for(let xa=0;xa<va.length;xa++)fc(va[xa],ia,aa,da);Ue(sa.anchor,ia,aa);return}if(_a===Static){pa(sa,ia,aa);return}if(da!==2&&fa&1&&ya)if(da===0)ya.beforeEnter(ua),Ue(ua,ia,aa),queuePostRenderEffect(()=>ya.enter(ua),ha);else{const{leave:xa,delayLeave:wa,afterLeave:Ga}=ya,qa=()=>Ue(ua,ia,aa),rc=()=>{xa(ua,()=>{qa(),Ga&&Ga()})};wa?wa(ua,qa,rc):rc()}else Ue(ua,ia,aa)},ac=(sa,ia,aa,da=!1,ha=!1)=>{const{type:ua,props:_a,ref:ya,children:va,dynamicChildren:fa,shapeFlag:ka,patchFlag:xa,dirs:wa,cacheIndex:Ga}=sa;if(xa===-2&&(ha=!1),ya!=null&&setRef(ya,null,aa,sa,!0),Ga!=null&&(ia.renderCache[Ga]=void 0),ka&256){ia.ctx.deactivate(sa);return}const qa=ka&1&&wa,rc=!isAsyncWrapper(sa);let ec;if(rc&&(ec=_a&&_a.onVnodeBeforeUnmount)&&invokeVNodeHook(ec,ia,sa),ka&6)xc(sa.component,aa,da);else{if(ka&128){sa.suspense.unmount(aa,da);return}qa&&invokeDirectiveHook(sa,null,ia,"beforeUnmount"),ka&64?sa.type.remove(sa,ia,aa,cc,da):fa&&!fa.hasOnce&&(ua!==Fragment||xa>0&&xa&64)?hc(fa,ia,aa,!1,!0):(ua===Fragment&&xa&384||!ha&&ka&16)&&hc(va,ia,aa),da&&_c(sa)}(rc&&(ec=_a&&_a.onVnodeUnmounted)||qa)&&queuePostRenderEffect(()=>{ec&&invokeVNodeHook(ec,ia,sa),qa&&invokeDirectiveHook(sa,null,ia,"unmounted")},aa)},_c=sa=>{const{type:ia,el:aa,anchor:da,transition:ha}=sa;if(ia===Fragment){gc(aa,da);return}if(ia===Static){la(sa);return}const ua=()=>{Je(aa),ha&&!ha.persisted&&ha.afterLeave&&ha.afterLeave()};if(sa.shapeFlag&1&&ha&&!ha.persisted){const{leave:_a,delayLeave:ya}=ha,va=()=>_a(aa,ua);ya?ya(sa.el,ua,va):va()}else ua()},gc=(sa,ia)=>{let aa;for(;sa!==ia;)aa=Zo(sa),Je(sa),sa=aa;Je(ia)},xc=(sa,ia,aa)=>{const{bum:da,scope:ha,job:ua,subTree:_a,um:ya,m:va,a:fa}=sa;invalidateMount(va),invalidateMount(fa),da&&invokeArrayFns(da),ha.stop(),ua&&(ua.flags|=8,ac(_a,sa,ia,aa)),ya&&queuePostRenderEffect(ya,ia),queuePostRenderEffect(()=>{sa.isUnmounted=!0},ia),ia&&ia.pendingBranch&&!ia.isUnmounted&&sa.asyncDep&&!sa.asyncResolved&&sa.suspenseId===ia.pendingId&&(ia.deps--,ia.deps===0&&ia.resolve())},hc=(sa,ia,aa,da=!1,ha=!1,ua=0)=>{for(let _a=ua;_a<sa.length;_a++)ac(sa[_a],ia,aa,da,ha)},pc=sa=>{if(sa.shapeFlag&6)return pc(sa.component.subTree);if(sa.shapeFlag&128)return sa.suspense.next();const ia=Zo(sa.anchor||sa.el),aa=ia&&ia[TeleportEndKey];return aa?Zo(aa):ia};let Sc=!1;const bc=(sa,ia,aa)=>{sa==null?ia._vnode&&ac(ia._vnode,null,null,!0):ra(ia._vnode||null,sa,ia,null,null,null,aa),ia._vnode=sa,Sc||(Sc=!0,flushPreFlushCbs(),flushPostFlushCbs(),Sc=!1)},cc={p:ra,um:ac,m:fc,r:_c,mt:sc,mc:ga,pc:Ta,pbc:Ha,n:pc,o:qe};return{render:bc,hydrate:void 0,createApp:createAppAPI(bc)}}function resolveChildrenNamespace({type:qe,props:f},Ve){return Ve==="svg"&&qe==="foreignObject"||Ve==="mathml"&&qe==="annotation-xml"&&f&&f.encoding&&f.encoding.includes("html")?void 0:Ve}function toggleRecurse({effect:qe,job:f},Ve){Ve?(qe.flags|=32,f.flags|=4):(qe.flags&=-33,f.flags&=-5)}function needTransition(qe,f){return(!qe||qe&&!qe.pendingBranch)&&f&&!f.persisted}function traverseStaticChildren(qe,f,Ve=!1){const Ue=qe.children,Je=f.children;if(isArray(Ue)&&isArray(Je))for(let Bn=0;Bn<Ue.length;Bn++){const Vn=Ue[Bn];let Nn=Je[Bn];Nn.shapeFlag&1&&!Nn.dynamicChildren&&((Nn.patchFlag<=0||Nn.patchFlag===32)&&(Nn=Je[Bn]=cloneIfMounted(Je[Bn]),Nn.el=Vn.el),!Ve&&Nn.patchFlag!==-2&&traverseStaticChildren(Vn,Nn)),Nn.type===Text&&(Nn.el=Vn.el)}}function getSequence(qe){const f=qe.slice(),Ve=[0];let Ue,Je,Bn,Vn,Nn;const Un=qe.length;for(Ue=0;Ue<Un;Ue++){const qn=qe[Ue];if(qn!==0){if(Je=Ve[Ve.length-1],qe[Je]<qn){f[Ue]=Je,Ve.push(Ue);continue}for(Bn=0,Vn=Ve.length-1;Bn<Vn;)Nn=Bn+Vn>>1,qe[Ve[Nn]]<qn?Bn=Nn+1:Vn=Nn;qn<qe[Ve[Bn]]&&(Bn>0&&(f[Ue]=Ve[Bn-1]),Ve[Bn]=Ue)}}for(Bn=Ve.length,Vn=Ve[Bn-1];Bn-- >0;)Ve[Bn]=Vn,Vn=f[Vn];return Ve}function locateNonHydratedAsyncRoot(qe){const f=qe.subTree.component;if(f)return f.asyncDep&&!f.asyncResolved?f:locateNonHydratedAsyncRoot(f)}function invalidateMount(qe){if(qe)for(let f=0;f<qe.length;f++)qe[f].flags|=8}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watch(qe,f,Ve){return doWatch(qe,f,Ve)}function doWatch(qe,f,Ve=EMPTY_OBJ){const{immediate:Ue,deep:Je,flush:Bn,once:Vn}=Ve,Nn=extend({},Ve),Un=f&&Ue||!f&&Bn!=="post";let qn;if(isInSSRComponentSetup){if(Bn==="sync"){const ta=useSSRContext();qn=ta.__watcherHandles||(ta.__watcherHandles=[])}else if(!Un){const ta=()=>{};return ta.stop=NOOP,ta.resume=NOOP,ta.pause=NOOP,ta}}const qo=currentInstance;Nn.call=(ta,ea,ra)=>callWithAsyncErrorHandling(ta,qo,ea,ra);let $o=!1;Bn==="post"?Nn.scheduler=ta=>{queuePostRenderEffect(ta,qo&&qo.suspense)}:Bn!=="sync"&&($o=!0,Nn.scheduler=(ta,ea)=>{ea?ta():queueJob(ta)}),Nn.augmentJob=ta=>{f&&(ta.flags|=4),$o&&(ta.flags|=2,qo&&(ta.id=qo.uid,ta.i=qo))};const Zo=watch$1(qe,f,Nn);return isInSSRComponentSetup&&(qn?qn.push(Zo):Un&&Zo()),Zo}function instanceWatch(qe,f,Ve){const Ue=this.proxy,Je=isString(qe)?qe.includes(".")?createPathGetter(Ue,qe):()=>Ue[qe]:qe.bind(Ue,Ue);let Bn;isFunction(f)?Bn=f:(Bn=f.handler,Ve=f);const Vn=setCurrentInstance(this),Nn=doWatch(Je,Bn.bind(Ue),Ve);return Vn(),Nn}function createPathGetter(qe,f){const Ve=f.split(".");return()=>{let Ue=qe;for(let Je=0;Je<Ve.length&&Ue;Je++)Ue=Ue[Ve[Je]];return Ue}}const getModelModifiers=(qe,f)=>f==="modelValue"||f==="model-value"?qe.modelModifiers:qe[`${f}Modifiers`]||qe[`${camelize(f)}Modifiers`]||qe[`${hyphenate(f)}Modifiers`];function emit(qe,f,...Ve){if(qe.isUnmounted)return;const Ue=qe.vnode.props||EMPTY_OBJ;let Je=Ve;const Bn=f.startsWith("update:"),Vn=Bn&&getModelModifiers(Ue,f.slice(7));Vn&&(Vn.trim&&(Je=Ve.map(qo=>isString(qo)?qo.trim():qo)),Vn.number&&(Je=Ve.map(looseToNumber)));let Nn,Un=Ue[Nn=toHandlerKey(f)]||Ue[Nn=toHandlerKey(camelize(f))];!Un&&Bn&&(Un=Ue[Nn=toHandlerKey(hyphenate(f))]),Un&&callWithAsyncErrorHandling(Un,qe,6,Je);const qn=Ue[Nn+"Once"];if(qn){if(!qe.emitted)qe.emitted={};else if(qe.emitted[Nn])return;qe.emitted[Nn]=!0,callWithAsyncErrorHandling(qn,qe,6,Je)}}function normalizeEmitsOptions(qe,f,Ve=!1){const Ue=f.emitsCache,Je=Ue.get(qe);if(Je!==void 0)return Je;const Bn=qe.emits;let Vn={},Nn=!1;if(!isFunction(qe)){const Un=qn=>{const qo=normalizeEmitsOptions(qn,f,!0);qo&&(Nn=!0,extend(Vn,qo))};!Ve&&f.mixins.length&&f.mixins.forEach(Un),qe.extends&&Un(qe.extends),qe.mixins&&qe.mixins.forEach(Un)}return!Bn&&!Nn?(isObject(qe)&&Ue.set(qe,null),null):(isArray(Bn)?Bn.forEach(Un=>Vn[Un]=null):extend(Vn,Bn),isObject(qe)&&Ue.set(qe,Vn),Vn)}function isEmitListener(qe,f){return!qe||!isOn(f)?!1:(f=f.slice(2).replace(/Once$/,""),hasOwn(qe,f[0].toLowerCase()+f.slice(1))||hasOwn(qe,hyphenate(f))||hasOwn(qe,f))}function markAttrsAccessed(){}function renderComponentRoot(qe){const{type:f,vnode:Ve,proxy:Ue,withProxy:Je,propsOptions:[Bn],slots:Vn,attrs:Nn,emit:Un,render:qn,renderCache:qo,props:$o,data:Zo,setupState:ta,ctx:ea,inheritAttrs:ra}=qe,na=setCurrentRenderingInstance(qe);let oa,ca;try{if(Ve.shapeFlag&4){const la=Je||Ue,ma=la;oa=normalizeVNode(qn.call(ma,la,qo,$o,ta,Zo,ea)),ca=Nn}else{const la=f;oa=normalizeVNode(la.length>1?la($o,{attrs:Nn,slots:Vn,emit:Un}):la($o,null)),ca=f.props?Nn:getFunctionalFallthrough(Nn)}}catch(la){blockStack.length=0,handleError(la,qe,1),oa=createVNode(Comment)}let pa=oa;if(ca&&ra!==!1){const la=Object.keys(ca),{shapeFlag:ma}=pa;la.length&&ma&7&&(Bn&&la.some(isModelListener)&&(ca=filterModelListeners(ca,Bn)),pa=cloneVNode(pa,ca,!1,!0))}return Ve.dirs&&(pa=cloneVNode(pa,null,!1,!0),pa.dirs=pa.dirs?pa.dirs.concat(Ve.dirs):Ve.dirs),Ve.transition&&setTransitionHooks(pa,Ve.transition),oa=pa,setCurrentRenderingInstance(na),oa}const getFunctionalFallthrough=qe=>{let f;for(const Ve in qe)(Ve==="class"||Ve==="style"||isOn(Ve))&&((f||(f={}))[Ve]=qe[Ve]);return f},filterModelListeners=(qe,f)=>{const Ve={};for(const Ue in qe)(!isModelListener(Ue)||!(Ue.slice(9)in f))&&(Ve[Ue]=qe[Ue]);return Ve};function shouldUpdateComponent(qe,f,Ve){const{props:Ue,children:Je,component:Bn}=qe,{props:Vn,children:Nn,patchFlag:Un}=f,qn=Bn.emitsOptions;if(f.dirs||f.transition)return!0;if(Ve&&Un>=0){if(Un&1024)return!0;if(Un&16)return Ue?hasPropsChanged(Ue,Vn,qn):!!Vn;if(Un&8){const qo=f.dynamicProps;for(let $o=0;$o<qo.length;$o++){const Zo=qo[$o];if(Vn[Zo]!==Ue[Zo]&&!isEmitListener(qn,Zo))return!0}}}else return(Je||Nn)&&(!Nn||!Nn.$stable)?!0:Ue===Vn?!1:Ue?Vn?hasPropsChanged(Ue,Vn,qn):!0:!!Vn;return!1}function hasPropsChanged(qe,f,Ve){const Ue=Object.keys(f);if(Ue.length!==Object.keys(qe).length)return!0;for(let Je=0;Je<Ue.length;Je++){const Bn=Ue[Je];if(f[Bn]!==qe[Bn]&&!isEmitListener(Ve,Bn))return!0}return!1}function updateHOCHostEl({vnode:qe,parent:f},Ve){for(;f;){const Ue=f.subTree;if(Ue.suspense&&Ue.suspense.activeBranch===qe&&(Ue.el=qe.el),Ue===qe)(qe=f.vnode).el=Ve,f=f.parent;else break}}const isSuspense=qe=>qe.__isSuspense;function queueEffectWithSuspense(qe,f){f&&f.pendingBranch?isArray(qe)?f.effects.push(...qe):f.effects.push(qe):queuePostFlushCb(qe)}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(qe=!1){blockStack.push(currentBlock=qe?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(qe,f=!1){isBlockTreeEnabled+=qe,qe<0&&currentBlock&&f&&(currentBlock.hasOnce=!0)}function setupBlock(qe){return qe.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(qe),qe}function createElementBlock(qe,f,Ve,Ue,Je,Bn){return setupBlock(createBaseVNode(qe,f,Ve,Ue,Je,Bn,!0))}function isVNode(qe){return qe?qe.__v_isVNode===!0:!1}function isSameVNodeType(qe,f){return qe.type===f.type&&qe.key===f.key}const normalizeKey=({key:qe})=>qe??null,normalizeRef=({ref:qe,ref_key:f,ref_for:Ve})=>(typeof qe=="number"&&(qe=""+qe),qe!=null?isString(qe)||isRef(qe)||isFunction(qe)?{i:currentRenderingInstance,r:qe,k:f,f:!!Ve}:qe:null);function createBaseVNode(qe,f=null,Ve=null,Ue=0,Je=null,Bn=qe===Fragment?0:1,Vn=!1,Nn=!1){const Un={__v_isVNode:!0,__v_skip:!0,type:qe,props:f,key:f&&normalizeKey(f),ref:f&&normalizeRef(f),scopeId:currentScopeId,slotScopeIds:null,children:Ve,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:Bn,patchFlag:Ue,dynamicProps:Je,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return Nn?(normalizeChildren(Un,Ve),Bn&128&&qe.normalize(Un)):Ve&&(Un.shapeFlag|=isString(Ve)?8:16),isBlockTreeEnabled>0&&!Vn&&currentBlock&&(Un.patchFlag>0||Bn&6)&&Un.patchFlag!==32&&currentBlock.push(Un),Un}const createVNode=_createVNode;function _createVNode(qe,f=null,Ve=null,Ue=0,Je=null,Bn=!1){if((!qe||qe===NULL_DYNAMIC_COMPONENT)&&(qe=Comment),isVNode(qe)){const Nn=cloneVNode(qe,f,!0);return Ve&&normalizeChildren(Nn,Ve),isBlockTreeEnabled>0&&!Bn&&currentBlock&&(Nn.shapeFlag&6?currentBlock[currentBlock.indexOf(qe)]=Nn:currentBlock.push(Nn)),Nn.patchFlag=-2,Nn}if(isClassComponent(qe)&&(qe=qe.__vccOpts),f){f=guardReactiveProps(f);let{class:Nn,style:Un}=f;Nn&&!isString(Nn)&&(f.class=normalizeClass(Nn)),isObject(Un)&&(isProxy(Un)&&!isArray(Un)&&(Un=extend({},Un)),f.style=normalizeStyle(Un))}const Vn=isString(qe)?1:isSuspense(qe)?128:isTeleport(qe)?64:isObject(qe)?4:isFunction(qe)?2:0;return createBaseVNode(qe,f,Ve,Ue,Je,Vn,Bn,!0)}function guardReactiveProps(qe){return qe?isProxy(qe)||isInternalObject(qe)?extend({},qe):qe:null}function cloneVNode(qe,f,Ve=!1,Ue=!1){const{props:Je,ref:Bn,patchFlag:Vn,children:Nn,transition:Un}=qe,qn=f?mergeProps(Je||{},f):Je,qo={__v_isVNode:!0,__v_skip:!0,type:qe.type,props:qn,key:qn&&normalizeKey(qn),ref:f&&f.ref?Ve&&Bn?isArray(Bn)?Bn.concat(normalizeRef(f)):[Bn,normalizeRef(f)]:normalizeRef(f):Bn,scopeId:qe.scopeId,slotScopeIds:qe.slotScopeIds,children:Nn,target:qe.target,targetStart:qe.targetStart,targetAnchor:qe.targetAnchor,staticCount:qe.staticCount,shapeFlag:qe.shapeFlag,patchFlag:f&&qe.type!==Fragment?Vn===-1?16:Vn|16:Vn,dynamicProps:qe.dynamicProps,dynamicChildren:qe.dynamicChildren,appContext:qe.appContext,dirs:qe.dirs,transition:Un,component:qe.component,suspense:qe.suspense,ssContent:qe.ssContent&&cloneVNode(qe.ssContent),ssFallback:qe.ssFallback&&cloneVNode(qe.ssFallback),el:qe.el,anchor:qe.anchor,ctx:qe.ctx,ce:qe.ce};return Un&&Ue&&setTransitionHooks(qo,Un.clone(qo)),qo}function createTextVNode(qe=" ",f=0){return createVNode(Text,null,qe,f)}function normalizeVNode(qe){return qe==null||typeof qe=="boolean"?createVNode(Comment):isArray(qe)?createVNode(Fragment,null,qe.slice()):isVNode(qe)?cloneIfMounted(qe):createVNode(Text,null,String(qe))}function cloneIfMounted(qe){return qe.el===null&&qe.patchFlag!==-1||qe.memo?qe:cloneVNode(qe)}function normalizeChildren(qe,f){let Ve=0;const{shapeFlag:Ue}=qe;if(f==null)f=null;else if(isArray(f))Ve=16;else if(typeof f=="object")if(Ue&65){const Je=f.default;Je&&(Je._c&&(Je._d=!1),normalizeChildren(qe,Je()),Je._c&&(Je._d=!0));return}else{Ve=32;const Je=f._;!Je&&!isInternalObject(f)?f._ctx=currentRenderingInstance:Je===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?f._=1:(f._=2,qe.patchFlag|=1024))}else isFunction(f)?(f={default:f,_ctx:currentRenderingInstance},Ve=32):(f=String(f),Ue&64?(Ve=16,f=[createTextVNode(f)]):Ve=8);qe.children=f,qe.shapeFlag|=Ve}function mergeProps(...qe){const f={};for(let Ve=0;Ve<qe.length;Ve++){const Ue=qe[Ve];for(const Je in Ue)if(Je==="class")f.class!==Ue.class&&(f.class=normalizeClass([f.class,Ue.class]));else if(Je==="style")f.style=normalizeStyle([f.style,Ue.style]);else if(isOn(Je)){const Bn=f[Je],Vn=Ue[Je];Vn&&Bn!==Vn&&!(isArray(Bn)&&Bn.includes(Vn))&&(f[Je]=Bn?[].concat(Bn,Vn):Vn)}else Je!==""&&(f[Je]=Ue[Je])}return f}function invokeVNodeHook(qe,f,Ve,Ue=null){callWithAsyncErrorHandling(qe,f,7,[Ve,Ue])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(qe,f,Ve){const Ue=qe.type,Je=(f?f.appContext:qe.appContext)||emptyAppContext,Bn={uid:uid++,vnode:qe,type:Ue,parent:f,appContext:Je,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:f?f.provides:Object.create(Je.provides),ids:f?f.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(Ue,Je),emitsOptions:normalizeEmitsOptions(Ue,Je),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:Ue.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:Ve,suspenseId:Ve?Ve.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return Bn.ctx={_:Bn},Bn.root=f?f.root:Bn,Bn.emit=emit.bind(null,Bn),qe.ce&&qe.ce(Bn),Bn}let currentInstance=null,internalSetCurrentInstance,setInSSRSetupState;{const qe=getGlobalThis(),f=(Ve,Ue)=>{let Je;return(Je=qe[Ve])||(Je=qe[Ve]=[]),Je.push(Ue),Bn=>{Je.length>1?Je.forEach(Vn=>Vn(Bn)):Je[0](Bn)}};internalSetCurrentInstance=f("__VUE_INSTANCE_SETTERS__",Ve=>currentInstance=Ve),setInSSRSetupState=f("__VUE_SSR_SETTERS__",Ve=>isInSSRComponentSetup=Ve)}const setCurrentInstance=qe=>{const f=currentInstance;return internalSetCurrentInstance(qe),qe.scope.on(),()=>{qe.scope.off(),internalSetCurrentInstance(f)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(qe){return qe.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(qe,f=!1,Ve=!1){f&&setInSSRSetupState(f);const{props:Ue,children:Je}=qe.vnode,Bn=isStatefulComponent(qe);initProps(qe,Ue,Bn,f),initSlots(qe,Je,Ve);const Vn=Bn?setupStatefulComponent(qe,f):void 0;return f&&setInSSRSetupState(!1),Vn}function setupStatefulComponent(qe,f){const Ve=qe.type;qe.accessCache=Object.create(null),qe.proxy=new Proxy(qe.ctx,PublicInstanceProxyHandlers);const{setup:Ue}=Ve;if(Ue){pauseTracking();const Je=qe.setupContext=Ue.length>1?createSetupContext(qe):null,Bn=setCurrentInstance(qe),Vn=callWithErrorHandling(Ue,qe,0,[qe.props,Je]),Nn=isPromise(Vn);if(resetTracking(),Bn(),(Nn||qe.sp)&&!isAsyncWrapper(qe)&&markAsyncBoundary(qe),Nn){if(Vn.then(unsetCurrentInstance,unsetCurrentInstance),f)return Vn.then(Un=>{handleSetupResult(qe,Un)}).catch(Un=>{handleError(Un,qe,0)});qe.asyncDep=Vn}else handleSetupResult(qe,Vn)}else finishComponentSetup(qe)}function handleSetupResult(qe,f,Ve){isFunction(f)?qe.type.__ssrInlineRender?qe.ssrRender=f:qe.render=f:isObject(f)&&(qe.setupState=proxyRefs(f)),finishComponentSetup(qe)}function finishComponentSetup(qe,f,Ve){const Ue=qe.type;qe.render||(qe.render=Ue.render||NOOP);{const Je=setCurrentInstance(qe);pauseTracking();try{applyOptions(qe)}finally{resetTracking(),Je()}}}const attrsProxyHandlers={get(qe,f){return track(qe,"get",""),qe[f]}};function createSetupContext(qe){const f=Ve=>{qe.exposed=Ve||{}};return{attrs:new Proxy(qe.attrs,attrsProxyHandlers),slots:qe.slots,emit:qe.emit,expose:f}}function getComponentPublicInstance(qe){return qe.exposed?qe.exposeProxy||(qe.exposeProxy=new Proxy(proxyRefs(markRaw(qe.exposed)),{get(f,Ve){if(Ve in f)return f[Ve];if(Ve in publicPropertiesMap)return publicPropertiesMap[Ve](qe)},has(f,Ve){return Ve in f||Ve in publicPropertiesMap}})):qe.proxy}const classifyRE=/(?:^|[-_])(\w)/g,classify=qe=>qe.replace(classifyRE,f=>f.toUpperCase()).replace(/[-_]/g,"");function getComponentName(qe,f=!0){return isFunction(qe)?qe.displayName||qe.name:qe.name||f&&qe.__name}function formatComponentName(qe,f,Ve=!1){let Ue=getComponentName(f);if(!Ue&&f.__file){const Je=f.__file.match(/([^/\\]+)\.\w+$/);Je&&(Ue=Je[1])}if(!Ue&&qe&&qe.parent){const Je=Bn=>{for(const Vn in Bn)if(Bn[Vn]===f)return Vn};Ue=Je(qe.components||qe.parent.type.components)||Je(qe.appContext.components)}return Ue?classify(Ue):Ve?"App":"Anonymous"}function isClassComponent(qe){return isFunction(qe)&&"__vccOpts"in qe}const computed=(qe,f)=>computed$1(qe,f,isInSSRComponentSetup),version="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let policy;const tt$1=typeof window<"u"&&window.trustedTypes;if(tt$1)try{policy=tt$1.createPolicy("vue",{createHTML:qe=>qe})}catch{}const unsafeToTrustedHTML=policy?qe=>policy.createHTML(qe):qe=>qe,svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(qe,f,Ve)=>{f.insertBefore(qe,Ve||null)},remove:qe=>{const f=qe.parentNode;f&&f.removeChild(qe)},createElement:(qe,f,Ve,Ue)=>{const Je=f==="svg"?doc.createElementNS(svgNS,qe):f==="mathml"?doc.createElementNS(mathmlNS,qe):Ve?doc.createElement(qe,{is:Ve}):doc.createElement(qe);return qe==="select"&&Ue&&Ue.multiple!=null&&Je.setAttribute("multiple",Ue.multiple),Je},createText:qe=>doc.createTextNode(qe),createComment:qe=>doc.createComment(qe),setText:(qe,f)=>{qe.nodeValue=f},setElementText:(qe,f)=>{qe.textContent=f},parentNode:qe=>qe.parentNode,nextSibling:qe=>qe.nextSibling,querySelector:qe=>doc.querySelector(qe),setScopeId(qe,f){qe.setAttribute(f,"")},insertStaticContent(qe,f,Ve,Ue,Je,Bn){const Vn=Ve?Ve.previousSibling:f.lastChild;if(Je&&(Je===Bn||Je.nextSibling))for(;f.insertBefore(Je.cloneNode(!0),Ve),!(Je===Bn||!(Je=Je.nextSibling)););else{templateContainer.innerHTML=unsafeToTrustedHTML(Ue==="svg"?`<svg>${qe}</svg>`:Ue==="mathml"?`<math>${qe}</math>`:qe);const Nn=templateContainer.content;if(Ue==="svg"||Ue==="mathml"){const Un=Nn.firstChild;for(;Un.firstChild;)Nn.appendChild(Un.firstChild);Nn.removeChild(Un)}f.insertBefore(Nn,Ve)}return[Vn?Vn.nextSibling:f.firstChild,Ve?Ve.previousSibling:f.lastChild]}},vtcKey=Symbol("_vtc");function patchClass(qe,f,Ve){const Ue=qe[vtcKey];Ue&&(f=(f?[f,...Ue]:[...Ue]).join(" ")),f==null?qe.removeAttribute("class"):Ve?qe.setAttribute("class",f):qe.className=f}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(qe,f,Ve){const Ue=qe.style,Je=isString(Ve);let Bn=!1;if(Ve&&!Je){if(f)if(isString(f))for(const Vn of f.split(";")){const Nn=Vn.slice(0,Vn.indexOf(":")).trim();Ve[Nn]==null&&setStyle(Ue,Nn,"")}else for(const Vn in f)Ve[Vn]==null&&setStyle(Ue,Vn,"");for(const Vn in Ve)Vn==="display"&&(Bn=!0),setStyle(Ue,Vn,Ve[Vn])}else if(Je){if(f!==Ve){const Vn=Ue[CSS_VAR_TEXT];Vn&&(Ve+=";"+Vn),Ue.cssText=Ve,Bn=displayRE.test(Ve)}}else f&&qe.removeAttribute("style");vShowOriginalDisplay in qe&&(qe[vShowOriginalDisplay]=Bn?Ue.display:"",qe[vShowHidden]&&(Ue.display="none"))}const importantRE=/\s*!important$/;function setStyle(qe,f,Ve){if(isArray(Ve))Ve.forEach(Ue=>setStyle(qe,f,Ue));else if(Ve==null&&(Ve=""),f.startsWith("--"))qe.setProperty(f,Ve);else{const Ue=autoPrefix(qe,f);importantRE.test(Ve)?qe.setProperty(hyphenate(Ue),Ve.replace(importantRE,""),"important"):qe[Ue]=Ve}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(qe,f){const Ve=prefixCache[f];if(Ve)return Ve;let Ue=camelize(f);if(Ue!=="filter"&&Ue in qe)return prefixCache[f]=Ue;Ue=capitalize(Ue);for(let Je=0;Je<prefixes.length;Je++){const Bn=prefixes[Je]+Ue;if(Bn in qe)return prefixCache[f]=Bn}return f}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(qe,f,Ve,Ue,Je,Bn=isSpecialBooleanAttr(f)){Ue&&f.startsWith("xlink:")?Ve==null?qe.removeAttributeNS(xlinkNS,f.slice(6,f.length)):qe.setAttributeNS(xlinkNS,f,Ve):Ve==null||Bn&&!includeBooleanAttr(Ve)?qe.removeAttribute(f):qe.setAttribute(f,Bn?"":isSymbol(Ve)?String(Ve):Ve)}function patchDOMProp(qe,f,Ve,Ue,Je){if(f==="innerHTML"||f==="textContent"){Ve!=null&&(qe[f]=f==="innerHTML"?unsafeToTrustedHTML(Ve):Ve);return}const Bn=qe.tagName;if(f==="value"&&Bn!=="PROGRESS"&&!Bn.includes("-")){const Nn=Bn==="OPTION"?qe.getAttribute("value")||"":qe.value,Un=Ve==null?qe.type==="checkbox"?"on":"":String(Ve);(Nn!==Un||!("_value"in qe))&&(qe.value=Un),Ve==null&&qe.removeAttribute(f),qe._value=Ve;return}let Vn=!1;if(Ve===""||Ve==null){const Nn=typeof qe[f];Nn==="boolean"?Ve=includeBooleanAttr(Ve):Ve==null&&Nn==="string"?(Ve="",Vn=!0):Nn==="number"&&(Ve=0,Vn=!0)}try{qe[f]=Ve}catch{}Vn&&qe.removeAttribute(Je||f)}function addEventListener(qe,f,Ve,Ue){qe.addEventListener(f,Ve,Ue)}function removeEventListener(qe,f,Ve,Ue){qe.removeEventListener(f,Ve,Ue)}const veiKey=Symbol("_vei");function patchEvent(qe,f,Ve,Ue,Je=null){const Bn=qe[veiKey]||(qe[veiKey]={}),Vn=Bn[f];if(Ue&&Vn)Vn.value=Ue;else{const[Nn,Un]=parseName(f);if(Ue){const qn=Bn[f]=createInvoker(Ue,Je);addEventListener(qe,Nn,qn,Un)}else Vn&&(removeEventListener(qe,Nn,Vn,Un),Bn[f]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(qe){let f;if(optionsModifierRE.test(qe)){f={};let Ue;for(;Ue=qe.match(optionsModifierRE);)qe=qe.slice(0,qe.length-Ue[0].length),f[Ue[0].toLowerCase()]=!0}return[qe[2]===":"?qe.slice(3):hyphenate(qe.slice(2)),f]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(qe,f){const Ve=Ue=>{if(!Ue._vts)Ue._vts=Date.now();else if(Ue._vts<=Ve.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(Ue,Ve.value),f,5,[Ue])};return Ve.value=qe,Ve.attached=getNow(),Ve}function patchStopImmediatePropagation(qe,f){if(isArray(f)){const Ve=qe.stopImmediatePropagation;return qe.stopImmediatePropagation=()=>{Ve.call(qe),qe._stopped=!0},f.map(Ue=>Je=>!Je._stopped&&Ue&&Ue(Je))}else return f}const isNativeOn=qe=>qe.charCodeAt(0)===111&&qe.charCodeAt(1)===110&&qe.charCodeAt(2)>96&&qe.charCodeAt(2)<123,patchProp=(qe,f,Ve,Ue,Je,Bn)=>{const Vn=Je==="svg";f==="class"?patchClass(qe,Ue,Vn):f==="style"?patchStyle(qe,Ve,Ue):isOn(f)?isModelListener(f)||patchEvent(qe,f,Ve,Ue,Bn):(f[0]==="."?(f=f.slice(1),!0):f[0]==="^"?(f=f.slice(1),!1):shouldSetAsProp(qe,f,Ue,Vn))?(patchDOMProp(qe,f,Ue),!qe.tagName.includes("-")&&(f==="value"||f==="checked"||f==="selected")&&patchAttr(qe,f,Ue,Vn,Bn,f!=="value")):qe._isVueCE&&(/[A-Z]/.test(f)||!isString(Ue))?patchDOMProp(qe,camelize(f),Ue,Bn,f):(f==="true-value"?qe._trueValue=Ue:f==="false-value"&&(qe._falseValue=Ue),patchAttr(qe,f,Ue,Vn))};function shouldSetAsProp(qe,f,Ve,Ue){if(Ue)return!!(f==="innerHTML"||f==="textContent"||f in qe&&isNativeOn(f)&&isFunction(Ve));if(f==="spellcheck"||f==="draggable"||f==="translate"||f==="form"||f==="list"&&qe.tagName==="INPUT"||f==="type"&&qe.tagName==="TEXTAREA")return!1;if(f==="width"||f==="height"){const Je=qe.tagName;if(Je==="IMG"||Je==="VIDEO"||Je==="CANVAS"||Je==="SOURCE")return!1}return isNativeOn(f)&&isString(Ve)?!1:f in qe}const getModelAssigner=qe=>{const f=qe.props["onUpdate:modelValue"]||!1;return isArray(f)?Ve=>invokeArrayFns(f,Ve):f};function onCompositionStart(qe){qe.target.composing=!0}function onCompositionEnd(qe){const f=qe.target;f.composing&&(f.composing=!1,f.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(qe,{modifiers:{lazy:f,trim:Ve,number:Ue}},Je){qe[assignKey]=getModelAssigner(Je);const Bn=Ue||Je.props&&Je.props.type==="number";addEventListener(qe,f?"change":"input",Vn=>{if(Vn.target.composing)return;let Nn=qe.value;Ve&&(Nn=Nn.trim()),Bn&&(Nn=looseToNumber(Nn)),qe[assignKey](Nn)}),Ve&&addEventListener(qe,"change",()=>{qe.value=qe.value.trim()}),f||(addEventListener(qe,"compositionstart",onCompositionStart),addEventListener(qe,"compositionend",onCompositionEnd),addEventListener(qe,"change",onCompositionEnd))},mounted(qe,{value:f}){qe.value=f??""},beforeUpdate(qe,{value:f,oldValue:Ve,modifiers:{lazy:Ue,trim:Je,number:Bn}},Vn){if(qe[assignKey]=getModelAssigner(Vn),qe.composing)return;const Nn=(Bn||qe.type==="number")&&!/^0\d/.test(qe.value)?looseToNumber(qe.value):qe.value,Un=f??"";Nn!==Un&&(document.activeElement===qe&&qe.type!=="range"&&(Ue&&f===Ve||Je&&qe.value.trim()===Un)||(qe.value=Un))}},rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...qe)=>{const f=ensureRenderer().createApp(...qe),{mount:Ve}=f;return f.mount=Ue=>{const Je=normalizeContainer(Ue);if(!Je)return;const Bn=f._component;!isFunction(Bn)&&!Bn.render&&!Bn.template&&(Bn.template=Je.innerHTML),Je.nodeType===1&&(Je.textContent="");const Vn=Ve(Je,!1,resolveRootNamespace(Je));return Je instanceof Element&&(Je.removeAttribute("v-cloak"),Je.setAttribute("data-v-app","")),Vn},f};function resolveRootNamespace(qe){if(qe instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&qe instanceof MathMLElement)return"mathml"}function normalizeContainer(qe){return isString(qe)?document.querySelector(qe):qe}var isVue2=!1;/*!
 * pinia v2.3.0
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let activePinia;const setActivePinia=qe=>activePinia=qe,piniaSymbol=Symbol();function isPlainObject(qe){return qe&&typeof qe=="object"&&Object.prototype.toString.call(qe)==="[object Object]"&&typeof qe.toJSON!="function"}var MutationType;(function(qe){qe.direct="direct",qe.patchObject="patch object",qe.patchFunction="patch function"})(MutationType||(MutationType={}));function createPinia(){const qe=effectScope(!0),f=qe.run(()=>ref({}));let Ve=[],Ue=[];const Je=markRaw({install(Bn){setActivePinia(Je),Je._a=Bn,Bn.provide(piniaSymbol,Je),Bn.config.globalProperties.$pinia=Je,Ue.forEach(Vn=>Ve.push(Vn)),Ue=[]},use(Bn){return!this._a&&!isVue2?Ue.push(Bn):Ve.push(Bn),this},_p:Ve,_a:null,_e:qe,_s:new Map,state:f});return Je}const noop=()=>{};function addSubscription(qe,f,Ve,Ue=noop){qe.push(f);const Je=()=>{const Bn=qe.indexOf(f);Bn>-1&&(qe.splice(Bn,1),Ue())};return!Ve&&getCurrentScope()&&onScopeDispose(Je),Je}function triggerSubscriptions(qe,...f){qe.slice().forEach(Ve=>{Ve(...f)})}const fallbackRunWithContext=qe=>qe(),ACTION_MARKER=Symbol(),ACTION_NAME=Symbol();function mergeReactiveObjects(qe,f){qe instanceof Map&&f instanceof Map?f.forEach((Ve,Ue)=>qe.set(Ue,Ve)):qe instanceof Set&&f instanceof Set&&f.forEach(qe.add,qe);for(const Ve in f){if(!f.hasOwnProperty(Ve))continue;const Ue=f[Ve],Je=qe[Ve];isPlainObject(Je)&&isPlainObject(Ue)&&qe.hasOwnProperty(Ve)&&!isRef(Ue)&&!isReactive(Ue)?qe[Ve]=mergeReactiveObjects(Je,Ue):qe[Ve]=Ue}return qe}const skipHydrateSymbol=Symbol();function shouldHydrate(qe){return!isPlainObject(qe)||!qe.hasOwnProperty(skipHydrateSymbol)}const{assign}=Object;function isComputed(qe){return!!(isRef(qe)&&qe.effect)}function createOptionsStore(qe,f,Ve,Ue){const{state:Je,actions:Bn,getters:Vn}=f,Nn=Ve.state.value[qe];let Un;function qn(){Nn||(Ve.state.value[qe]=Je?Je():{});const qo=toRefs(Ve.state.value[qe]);return assign(qo,Bn,Object.keys(Vn||{}).reduce(($o,Zo)=>($o[Zo]=markRaw(computed(()=>{setActivePinia(Ve);const ta=Ve._s.get(qe);return Vn[Zo].call(ta,ta)})),$o),{}))}return Un=createSetupStore(qe,qn,f,Ve,Ue,!0),Un}function createSetupStore(qe,f,Ve={},Ue,Je,Bn){let Vn;const Nn=assign({actions:{}},Ve),Un={deep:!0};let qn,qo,$o=[],Zo=[],ta;const ea=Ue.state.value[qe];!Bn&&!ea&&(Ue.state.value[qe]={}),ref({});let ra;function na(ga){let ba;qn=qo=!1,typeof ga=="function"?(ga(Ue.state.value[qe]),ba={type:MutationType.patchFunction,storeId:qe,events:ta}):(mergeReactiveObjects(Ue.state.value[qe],ga),ba={type:MutationType.patchObject,payload:ga,storeId:qe,events:ta});const Ha=ra=Symbol();nextTick().then(()=>{ra===Ha&&(qn=!0)}),qo=!0,triggerSubscriptions($o,ba,Ue.state.value[qe])}const oa=Bn?function(){const{state:ba}=Ve,Ha=ba?ba():{};this.$patch(Ja=>{assign(Ja,Ha)})}:noop;function ca(){Vn.stop(),$o=[],Zo=[],Ue._s.delete(qe)}const pa=(ga,ba="")=>{if(ACTION_MARKER in ga)return ga[ACTION_NAME]=ba,ga;const Ha=function(){setActivePinia(Ue);const Ja=Array.from(arguments),tc=[],Ua=[];function sc(Na){tc.push(Na)}function ic(Na){Ua.push(Na)}triggerSubscriptions(Zo,{args:Ja,name:Ha[ACTION_NAME],store:ma,after:sc,onError:ic});let Ka;try{Ka=ga.apply(this&&this.$id===qe?this:ma,Ja)}catch(Na){throw triggerSubscriptions(Ua,Na),Na}return Ka instanceof Promise?Ka.then(Na=>(triggerSubscriptions(tc,Na),Na)).catch(Na=>(triggerSubscriptions(Ua,Na),Promise.reject(Na))):(triggerSubscriptions(tc,Ka),Ka)};return Ha[ACTION_MARKER]=!0,Ha[ACTION_NAME]=ba,Ha},la={_p:Ue,$id:qe,$onAction:addSubscription.bind(null,Zo),$patch:na,$reset:oa,$subscribe(ga,ba={}){const Ha=addSubscription($o,ga,ba.detached,()=>Ja()),Ja=Vn.run(()=>watch(()=>Ue.state.value[qe],tc=>{(ba.flush==="sync"?qo:qn)&&ga({storeId:qe,type:MutationType.direct,events:ta},tc)},assign({},Un,ba)));return Ha},$dispose:ca},ma=reactive(la);Ue._s.set(qe,ma);const Sa=(Ue._a&&Ue._a.runWithContext||fallbackRunWithContext)(()=>Ue._e.run(()=>(Vn=effectScope()).run(()=>f({action:pa}))));for(const ga in Sa){const ba=Sa[ga];if(isRef(ba)&&!isComputed(ba)||isReactive(ba))Bn||(ea&&shouldHydrate(ba)&&(isRef(ba)?ba.value=ea[ga]:mergeReactiveObjects(ba,ea[ga])),Ue.state.value[qe][ga]=ba);else if(typeof ba=="function"){const Ha=pa(ba,ga);Sa[ga]=Ha,Nn.actions[ga]=ba}}return assign(ma,Sa),assign(toRaw(ma),Sa),Object.defineProperty(ma,"$state",{get:()=>Ue.state.value[qe],set:ga=>{na(ba=>{assign(ba,ga)})}}),Ue._p.forEach(ga=>{assign(ma,Vn.run(()=>ga({store:ma,app:Ue._a,pinia:Ue,options:Nn})))}),ea&&Bn&&Ve.hydrate&&Ve.hydrate(ma.$state,ea),qn=!0,qo=!0,ma}/*! #__NO_SIDE_EFFECTS__ */function defineStore(qe,f,Ve){let Ue,Je;const Bn=typeof f=="function";Ue=qe,Je=Bn?Ve:f;function Vn(Nn,Un){const qn=hasInjectionContext();return Nn=Nn||(qn?inject(piniaSymbol,null):null),Nn&&setActivePinia(Nn),Nn=activePinia,Nn._s.has(Ue)||(Bn?createSetupStore(Ue,f,Je,Nn):createOptionsStore(Ue,Je,Nn)),Nn._s.get(Ue)}return Vn.$id=Ue,Vn}const suspectProtoRx=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,suspectConstructorRx=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,JsonSigRx=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(qe,f){if(qe==="__proto__"||qe==="constructor"&&f&&typeof f=="object"&&"prototype"in f){warnKeyDropped(qe);return}return f}function warnKeyDropped(qe){console.warn(`[destr] Dropping "${qe}" key to prevent prototype pollution.`)}function destr(qe,f={}){if(typeof qe!="string")return qe;const Ve=qe.trim();if(qe[0]==='"'&&qe.endsWith('"')&&!qe.includes("\\"))return Ve.slice(1,-1);if(Ve.length<=9){const Ue=Ve.toLowerCase();if(Ue==="true")return!0;if(Ue==="false")return!1;if(Ue==="undefined")return;if(Ue==="null")return null;if(Ue==="nan")return Number.NaN;if(Ue==="infinity")return Number.POSITIVE_INFINITY;if(Ue==="-infinity")return Number.NEGATIVE_INFINITY}if(!JsonSigRx.test(qe)){if(f.strict)throw new SyntaxError("[destr] Invalid JSON");return qe}try{if(suspectProtoRx.test(qe)||suspectConstructorRx.test(qe)){if(f.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(qe,jsonParseTransform)}return JSON.parse(qe)}catch(Ue){if(f.strict)throw Ue;return qe}}function get(qe,f){if(qe==null)return;let Ve=qe;for(let Ue=0;Ue<f.length;Ue++){if(Ve==null||Ve[f[Ue]]==null)return;Ve=Ve[f[Ue]]}return Ve}function set(qe,f,Ve){if(Ve.length===0)return f;const Ue=Ve[0];return Ve.length>1&&(f=set(typeof qe!="object"||qe===null||!Object.prototype.hasOwnProperty.call(qe,Ue)?Number.isInteger(Number(Ve[1]))?[]:{}:qe[Ue],f,Array.prototype.slice.call(Ve,1))),Number.isInteger(Number(Ue))&&Array.isArray(qe)?qe.slice()[Ue]:Object.assign({},qe,{[Ue]:f})}function unset(qe,f){if(qe==null||f.length===0)return qe;if(f.length===1){if(qe==null)return qe;if(Number.isInteger(f[0])&&Array.isArray(qe))return Array.prototype.slice.call(qe,0).splice(f[0],1);const Ve={};for(const Ue in qe)Ve[Ue]=qe[Ue];return delete Ve[f[0]],Ve}if(qe[f[0]]==null){if(Number.isInteger(f[0])&&Array.isArray(qe))return Array.prototype.concat.call([],qe);const Ve={};for(const Ue in qe)Ve[Ue]=qe[Ue];return Ve}return set(qe,unset(qe[f[0]],Array.prototype.slice.call(f,1)),[f[0]])}function deepPickUnsafe(qe,f){return f.map(Ve=>Ve.split(".")).map(Ve=>[Ve,get(qe,Ve)]).filter(Ve=>Ve[1]!==void 0).reduce((Ve,Ue)=>set(Ve,Ue[1],Ue[0]),{})}function deepOmitUnsafe(qe,f){return f.map(Ve=>Ve.split(".")).reduce((Ve,Ue)=>unset(Ve,Ue),qe)}function hydrateStore(qe,{storage:f,serializer:Ve,key:Ue,debug:Je,pick:Bn,omit:Vn,beforeHydrate:Nn,afterHydrate:Un},qn,qo=!0){try{qo&&(Nn==null||Nn(qn));const $o=f.getItem(Ue);if($o){const Zo=Ve.deserialize($o),ta=Bn?deepPickUnsafe(Zo,Bn):Zo,ea=Vn?deepOmitUnsafe(ta,Vn):ta;qe.$patch(ea)}qo&&(Un==null||Un(qn))}catch($o){Je&&console.error("[pinia-plugin-persistedstate]",$o)}}function persistState(qe,{storage:f,serializer:Ve,key:Ue,debug:Je,pick:Bn,omit:Vn}){try{const Nn=Bn?deepPickUnsafe(qe,Bn):qe,Un=Vn?deepOmitUnsafe(Nn,Vn):Nn,qn=Ve.serialize(Un);f.setItem(Ue,qn)}catch(Nn){Je&&console.error("[pinia-plugin-persistedstate]",Nn)}}function createPersistence(qe,f,Ve){const{pinia:Ue,store:Je,options:{persist:Bn=Ve}}=qe;if(!Bn)return;if(!(Je.$id in Ue.state.value)){const Un=Ue._s.get(Je.$id.replace("__hot:",""));Un&&Promise.resolve().then(()=>Un.$persist());return}const Nn=(Array.isArray(Bn)?Bn:Bn===!0?[{}]:[Bn]).map(f);Je.$hydrate=({runHooks:Un=!0}={})=>{Nn.forEach(qn=>{hydrateStore(Je,qn,qe,Un)})},Je.$persist=()=>{Nn.forEach(Un=>{persistState(Je.$state,Un)})},Nn.forEach(Un=>{hydrateStore(Je,Un,qe),Je.$subscribe((qn,qo)=>persistState(qo,Un),{detached:!0})})}function createPersistedState(qe={}){return function(f){createPersistence(f,Ve=>({key:(qe.key?qe.key:Ue=>Ue)(Ve.key??f.store.$id),debug:Ve.debug??qe.debug??!1,serializer:Ve.serializer??qe.serializer??{serialize:Ue=>JSON.stringify(Ue),deserialize:Ue=>destr(Ue)},storage:Ve.storage??qe.storage??window.localStorage,beforeHydrate:Ve.beforeHydrate,afterHydrate:Ve.afterHydrate,pick:Ve.pick,omit:Ve.omit}),qe.auto??!1)}}var src_default=createPersistedState();function t(qe,f,Ve){return(f=function(Ue){var Je=function(Bn,Vn){if(typeof Bn!="object"||!Bn)return Bn;var Nn=Bn[Symbol.toPrimitive];if(Nn!==void 0){var Un=Nn.call(Bn,Vn||"default");if(typeof Un!="object")return Un;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Vn==="string"?String:Number)(Bn)}(Ue,"string");return typeof Je=="symbol"?Je:Je+""}(f))in qe?Object.defineProperty(qe,f,{value:Ve,enumerable:!0,configurable:!0,writable:!0}):qe[f]=Ve,qe}function e(qe,f){var Ve=Object.keys(qe);if(Object.getOwnPropertySymbols){var Ue=Object.getOwnPropertySymbols(qe);f&&(Ue=Ue.filter(function(Je){return Object.getOwnPropertyDescriptor(qe,Je).enumerable})),Ve.push.apply(Ve,Ue)}return Ve}function s(qe){for(var f=1;f<arguments.length;f++){var Ve=arguments[f]!=null?arguments[f]:{};f%2?e(Object(Ve),!0).forEach(function(Ue){t(qe,Ue,Ve[Ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(qe,Object.getOwnPropertyDescriptors(Ve)):e(Object(Ve)).forEach(function(Ue){Object.defineProperty(qe,Ue,Object.getOwnPropertyDescriptor(Ve,Ue))})}return qe}function i(qe,f){if(qe==null)return{};var Ve,Ue,Je=function(Vn,Nn){if(Vn==null)return{};var Un={};for(var qn in Vn)if({}.hasOwnProperty.call(Vn,qn)){if(Nn.indexOf(qn)>=0)continue;Un[qn]=Vn[qn]}return Un}(qe,f);if(Object.getOwnPropertySymbols){var Bn=Object.getOwnPropertySymbols(qe);for(Ue=0;Ue<Bn.length;Ue++)Ve=Bn[Ue],f.indexOf(Ve)>=0||{}.propertyIsEnumerable.call(qe,Ve)&&(Je[Ve]=qe[Ve])}return Je}function r(qe,f){return f||(f=qe.slice(0)),Object.freeze(Object.defineProperties(qe,{raw:{value:Object.freeze(f)}}))}class n{constructor(){t(this,"browserShadowBlurConstant",1),t(this,"DPI",96),t(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),t(this,"perfLimitSizeTotal",2097152),t(this,"maxCacheSideLimit",4096),t(this,"minCacheSideLimit",256),t(this,"disableStyleCopyPaste",!1),t(this,"enableGLFiltering",!0),t(this,"textureSize",4096),t(this,"forceGLPutImageData",!1),t(this,"cachesBoundsOfCurve",!1),t(this,"fontPaths",{}),t(this,"NUM_FRACTION_DIGITS",4)}}const o=new class extends n{constructor(qe){super(),this.configure(qe)}configure(){let qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,qe)}addFonts(){let qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=s(s({},this.fontPaths),qe)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(qe=>{delete this.fontPaths[qe]})}clearFonts(){this.fontPaths={}}restoreDefaults(qe){const f=new n,Ve=(qe==null?void 0:qe.reduce((Ue,Je)=>(Ue[Je]=f[Je],Ue),{}))||f;this.configure(Ve)}},a=function(qe){for(var f=arguments.length,Ve=new Array(f>1?f-1:0),Ue=1;Ue<f;Ue++)Ve[Ue-1]=arguments[Ue];return console[qe]("fabric",...Ve)};class h extends Error{constructor(f,Ve){super("fabric: ".concat(f),Ve)}}class c extends h{constructor(f){super("".concat(f," 'options.signal' is in 'aborted' state"))}}class l{}class u extends l{testPrecision(f,Ve){const Ue="precision ".concat(Ve,` float;
void main(){}`),Je=f.createShader(f.FRAGMENT_SHADER);return!!Je&&(f.shaderSource(Je,Ue),f.compileShader(Je),!!f.getShaderParameter(Je,f.COMPILE_STATUS))}queryWebGL(f){const Ve=f.getContext("webgl");Ve&&(this.maxTextureSize=Ve.getParameter(Ve.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(Ue=>this.testPrecision(Ve,Ue)),Ve.getExtension("WEBGL_lose_context").loseContext(),a("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(f){return!!this.maxTextureSize&&this.maxTextureSize>=f}}const d={};let g;const p=()=>g||(g={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new u,dispose(){},copyPasteData:d}),m=()=>p().document,v=()=>p().window,y=()=>{var qe;return Math.max((qe=o.devicePixelRatio)!==null&&qe!==void 0?qe:v().devicePixelRatio,1)},_=new class{constructor(){t(this,"charWidthsCache",{}),t(this,"boundsOfCurveCache",{})}getFontCache(qe){let{fontFamily:f,fontStyle:Ve,fontWeight:Ue}=qe;f=f.toLowerCase(),this.charWidthsCache[f]||(this.charWidthsCache[f]={});const Je=this.charWidthsCache[f],Bn="".concat(Ve.toLowerCase(),"_").concat((Ue+"").toLowerCase());return Je[Bn]||(Je[Bn]={}),Je[Bn]}clearFontCache(qe){(qe=(qe||"").toLowerCase())?this.charWidthsCache[qe]&&delete this.charWidthsCache[qe]:this.charWidthsCache={}}limitDimsByArea(qe){const{perfLimitSizeTotal:f}=o,Ve=Math.sqrt(f*qe);return[Math.floor(Ve),Math.floor(f/Ve)]}},x="6.5.3";function C(){}const b=Math.PI/2,w=2*Math.PI,S=Math.PI/180,T=Object.freeze([1,0,0,1,0,0]),O=16,k=.4477152502,D="center",M="left",P="top",E="bottom",A="right",j="none",F=/\r?\n/,L="moving",R="scaling",I="rotating",B="rotate",X="skewing",Y="resizing",W="modifyPoly",V="modifyPath",z="changed",H="scale",G="scaleX",N="scaleY",U="skewX",q="skewY",K="fill",J="stroke",Q="modified",Z="json",$="svg",tt=new class{constructor(){this[Z]=new Map,this[$]=new Map}has(qe){return this[Z].has(qe)}getClass(qe){const f=this[Z].get(qe);if(!f)throw new h("No class registered for ".concat(qe));return f}setClass(qe,f){f?this[Z].set(f,qe):(this[Z].set(qe.type,qe),this[Z].set(qe.type.toLowerCase(),qe))}getSVGClass(qe){return this[$].get(qe)}setSVGClass(qe,f){this[$].set(f??qe.type.toLowerCase(),qe)}},et=new class extends Array{remove(qe){const f=this.indexOf(qe);f>-1&&this.splice(f,1)}cancelAll(){const qe=this.splice(0);return qe.forEach(f=>f.abort()),qe}cancelByCanvas(qe){if(!qe)return[];const f=this.filter(Ve=>{var Ue;return Ve.target===qe||typeof Ve.target=="object"&&((Ue=Ve.target)===null||Ue===void 0?void 0:Ue.canvas)===qe});return f.forEach(Ve=>Ve.abort()),f}cancelByTarget(qe){if(!qe)return[];const f=this.filter(Ve=>Ve.target===qe);return f.forEach(Ve=>Ve.abort()),f}};class st{constructor(){t(this,"__eventListeners",{})}on(f,Ve){if(this.__eventListeners||(this.__eventListeners={}),typeof f=="object")return Object.entries(f).forEach(Ue=>{let[Je,Bn]=Ue;this.on(Je,Bn)}),()=>this.off(f);if(Ve){const Ue=f;return this.__eventListeners[Ue]||(this.__eventListeners[Ue]=[]),this.__eventListeners[Ue].push(Ve),()=>this.off(Ue,Ve)}return()=>!1}once(f,Ve){if(typeof f=="object"){const Ue=[];return Object.entries(f).forEach(Je=>{let[Bn,Vn]=Je;Ue.push(this.once(Bn,Vn))}),()=>Ue.forEach(Je=>Je())}if(Ve){const Ue=this.on(f,function(){for(var Je=arguments.length,Bn=new Array(Je),Vn=0;Vn<Je;Vn++)Bn[Vn]=arguments[Vn];Ve.call(this,...Bn),Ue()});return Ue}return()=>!1}_removeEventListener(f,Ve){if(this.__eventListeners[f])if(Ve){const Ue=this.__eventListeners[f],Je=Ue.indexOf(Ve);Je>-1&&Ue.splice(Je,1)}else this.__eventListeners[f]=[]}off(f,Ve){if(this.__eventListeners)if(f===void 0)for(const Ue in this.__eventListeners)this._removeEventListener(Ue);else typeof f=="object"?Object.entries(f).forEach(Ue=>{let[Je,Bn]=Ue;this._removeEventListener(Je,Bn)}):this._removeEventListener(f,Ve)}fire(f,Ve){var Ue;if(!this.__eventListeners)return;const Je=(Ue=this.__eventListeners[f])===null||Ue===void 0?void 0:Ue.concat();if(Je)for(let Bn=0;Bn<Je.length;Bn++)Je[Bn].call(this,Ve||{})}}const it=(qe,f)=>{const Ve=qe.indexOf(f);return Ve!==-1&&qe.splice(Ve,1),qe},rt=qe=>{if(qe===0)return 1;switch(Math.abs(qe)/b){case 1:case 3:return 0;case 2:return-1}return Math.cos(qe)},nt=qe=>{if(qe===0)return 0;const f=qe/b,Ve=Math.sign(qe);switch(f){case 1:return Ve;case 2:return 0;case 3:return-Ve}return Math.sin(qe)};class ot{constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof f=="object"?(this.x=f.x,this.y=f.y):(this.x=f,this.y=Ve)}add(f){return new ot(this.x+f.x,this.y+f.y)}addEquals(f){return this.x+=f.x,this.y+=f.y,this}scalarAdd(f){return new ot(this.x+f,this.y+f)}scalarAddEquals(f){return this.x+=f,this.y+=f,this}subtract(f){return new ot(this.x-f.x,this.y-f.y)}subtractEquals(f){return this.x-=f.x,this.y-=f.y,this}scalarSubtract(f){return new ot(this.x-f,this.y-f)}scalarSubtractEquals(f){return this.x-=f,this.y-=f,this}multiply(f){return new ot(this.x*f.x,this.y*f.y)}scalarMultiply(f){return new ot(this.x*f,this.y*f)}scalarMultiplyEquals(f){return this.x*=f,this.y*=f,this}divide(f){return new ot(this.x/f.x,this.y/f.y)}scalarDivide(f){return new ot(this.x/f,this.y/f)}scalarDivideEquals(f){return this.x/=f,this.y/=f,this}eq(f){return this.x===f.x&&this.y===f.y}lt(f){return this.x<f.x&&this.y<f.y}lte(f){return this.x<=f.x&&this.y<=f.y}gt(f){return this.x>f.x&&this.y>f.y}gte(f){return this.x>=f.x&&this.y>=f.y}lerp(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return Ve=Math.max(Math.min(1,Ve),0),new ot(this.x+(f.x-this.x)*Ve,this.y+(f.y-this.y)*Ve)}distanceFrom(f){const Ve=this.x-f.x,Ue=this.y-f.y;return Math.sqrt(Ve*Ve+Ue*Ue)}midPointFrom(f){return this.lerp(f)}min(f){return new ot(Math.min(this.x,f.x),Math.min(this.y,f.y))}max(f){return new ot(Math.max(this.x,f.x),Math.max(this.y,f.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(f,Ve){return this.x=f,this.y=Ve,this}setX(f){return this.x=f,this}setY(f){return this.y=f,this}setFromPoint(f){return this.x=f.x,this.y=f.y,this}swap(f){const Ve=this.x,Ue=this.y;this.x=f.x,this.y=f.y,f.x=Ve,f.y=Ue}clone(){return new ot(this.x,this.y)}rotate(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:at;const Ue=nt(f),Je=rt(f),Bn=this.subtract(Ve);return new ot(Bn.x*Je-Bn.y*Ue,Bn.x*Ue+Bn.y*Je).add(Ve)}transform(f){let Ve=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new ot(f[0]*this.x+f[2]*this.y+(Ve?0:f[4]),f[1]*this.x+f[3]*this.y+(Ve?0:f[5]))}}const at=new ot(0,0),ht=qe=>!!qe&&Array.isArray(qe._objects);function ct(qe){class f extends qe{constructor(){super(...arguments),t(this,"_objects",[])}_onObjectAdded(Ue){}_onObjectRemoved(Ue){}_onStackOrderChanged(Ue){}add(){for(var Ue=arguments.length,Je=new Array(Ue),Bn=0;Bn<Ue;Bn++)Je[Bn]=arguments[Bn];const Vn=this._objects.push(...Je);return Je.forEach(Nn=>this._onObjectAdded(Nn)),Vn}insertAt(Ue){for(var Je=arguments.length,Bn=new Array(Je>1?Je-1:0),Vn=1;Vn<Je;Vn++)Bn[Vn-1]=arguments[Vn];return this._objects.splice(Ue,0,...Bn),Bn.forEach(Nn=>this._onObjectAdded(Nn)),this._objects.length}remove(){const Ue=this._objects,Je=[];for(var Bn=arguments.length,Vn=new Array(Bn),Nn=0;Nn<Bn;Nn++)Vn[Nn]=arguments[Nn];return Vn.forEach(Un=>{const qn=Ue.indexOf(Un);qn!==-1&&(Ue.splice(qn,1),Je.push(Un),this._onObjectRemoved(Un))}),Je}forEachObject(Ue){this.getObjects().forEach((Je,Bn,Vn)=>Ue(Je,Bn,Vn))}getObjects(){for(var Ue=arguments.length,Je=new Array(Ue),Bn=0;Bn<Ue;Bn++)Je[Bn]=arguments[Bn];return Je.length===0?[...this._objects]:this._objects.filter(Vn=>Vn.isType(...Je))}item(Ue){return this._objects[Ue]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(Ue,Je){return!!this._objects.includes(Ue)||!!Je&&this._objects.some(Bn=>Bn instanceof f&&Bn.contains(Ue,!0))}complexity(){return this._objects.reduce((Ue,Je)=>Ue+=Je.complexity?Je.complexity():0,0)}sendObjectToBack(Ue){return!(!Ue||Ue===this._objects[0])&&(it(this._objects,Ue),this._objects.unshift(Ue),this._onStackOrderChanged(Ue),!0)}bringObjectToFront(Ue){return!(!Ue||Ue===this._objects[this._objects.length-1])&&(it(this._objects,Ue),this._objects.push(Ue),this._onStackOrderChanged(Ue),!0)}sendObjectBackwards(Ue,Je){if(!Ue)return!1;const Bn=this._objects.indexOf(Ue);if(Bn!==0){const Vn=this.findNewLowerIndex(Ue,Bn,Je);return it(this._objects,Ue),this._objects.splice(Vn,0,Ue),this._onStackOrderChanged(Ue),!0}return!1}bringObjectForward(Ue,Je){if(!Ue)return!1;const Bn=this._objects.indexOf(Ue);if(Bn!==this._objects.length-1){const Vn=this.findNewUpperIndex(Ue,Bn,Je);return it(this._objects,Ue),this._objects.splice(Vn,0,Ue),this._onStackOrderChanged(Ue),!0}return!1}moveObjectTo(Ue,Je){return Ue!==this._objects[Je]&&(it(this._objects,Ue),this._objects.splice(Je,0,Ue),this._onStackOrderChanged(Ue),!0)}findNewLowerIndex(Ue,Je,Bn){let Vn;if(Bn){Vn=Je;for(let Nn=Je-1;Nn>=0;--Nn)if(Ue.isOverlapping(this._objects[Nn])){Vn=Nn;break}}else Vn=Je-1;return Vn}findNewUpperIndex(Ue,Je,Bn){let Vn;if(Bn){Vn=Je;for(let Nn=Je+1;Nn<this._objects.length;++Nn)if(Ue.isOverlapping(this._objects[Nn])){Vn=Nn;break}}else Vn=Je+1;return Vn}collectObjects(Ue){let{left:Je,top:Bn,width:Vn,height:Nn}=Ue,{includeIntersecting:Un=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const qn=[],qo=new ot(Je,Bn),$o=qo.add(new ot(Vn,Nn));for(let Zo=this._objects.length-1;Zo>=0;Zo--){const ta=this._objects[Zo];ta.selectable&&ta.visible&&(Un&&ta.intersectsWithRect(qo,$o)||ta.isContainedWithinRect(qo,$o)||Un&&ta.containsPoint(qo)||Un&&ta.containsPoint($o))&&qn.push(ta)}return qn}}return f}class lt extends st{_setOptions(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const Ve in f)this.set(Ve,f[Ve])}_setObject(f){for(const Ve in f)this._set(Ve,f[Ve])}set(f,Ve){return typeof f=="object"?this._setObject(f):this._set(f,Ve),this}_set(f,Ve){this[f]=Ve}toggle(f){const Ve=this.get(f);return typeof Ve=="boolean"&&this.set(f,!Ve),this}get(f){return this[f]}}function ut(qe){return v().requestAnimationFrame(qe)}function dt(qe){return v().cancelAnimationFrame(qe)}let gt=0;const ft=()=>gt++,pt=()=>{const qe=m().createElement("canvas");if(!qe||qe.getContext===void 0)throw new h("Failed to create `canvas` element");return qe},mt=()=>m().createElement("img"),vt=qe=>{const f=pt();return f.width=qe.width,f.height=qe.height,f},yt=(qe,f,Ve)=>qe.toDataURL("image/".concat(f),Ve),_t=qe=>qe*S,xt=qe=>qe/S,Ct=qe=>qe.every((f,Ve)=>f===T[Ve]),bt=(qe,f,Ve)=>new ot(qe).transform(f,Ve),wt=qe=>{const f=1/(qe[0]*qe[3]-qe[1]*qe[2]),Ve=[f*qe[3],-f*qe[1],-f*qe[2],f*qe[0],0,0],{x:Ue,y:Je}=new ot(qe[4],qe[5]).transform(Ve,!0);return Ve[4]=-Ue,Ve[5]=-Je,Ve},St=(qe,f,Ve)=>[qe[0]*f[0]+qe[2]*f[1],qe[1]*f[0]+qe[3]*f[1],qe[0]*f[2]+qe[2]*f[3],qe[1]*f[2]+qe[3]*f[3],Ve?0:qe[0]*f[4]+qe[2]*f[5]+qe[4],Ve?0:qe[1]*f[4]+qe[3]*f[5]+qe[5]],Tt=(qe,f)=>qe.reduceRight((Ve,Ue)=>Ue&&Ve?St(Ue,Ve,f):Ue||Ve,void 0)||T.concat(),Ot=qe=>{let[f,Ve]=qe;return Math.atan2(Ve,f)},kt=qe=>{const f=Ot(qe),Ve=Math.pow(qe[0],2)+Math.pow(qe[1],2),Ue=Math.sqrt(Ve),Je=(qe[0]*qe[3]-qe[2]*qe[1])/Ue,Bn=Math.atan2(qe[0]*qe[2]+qe[1]*qe[3],Ve);return{angle:xt(f),scaleX:Ue,scaleY:Je,skewX:xt(Bn),skewY:0,translateX:qe[4]||0,translateY:qe[5]||0}},Dt=function(qe){return[1,0,0,1,qe,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Mt(){let{angle:qe=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:f=0,y:Ve=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const Ue=_t(qe),Je=rt(Ue),Bn=nt(Ue);return[Je,Bn,-Bn,Je,f?f-(Je*f-Bn*Ve):0,Ve?Ve-(Bn*f+Je*Ve):0]}const Pt=function(qe){return[qe,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,0,0]},Et=qe=>Math.tan(_t(qe)),At=qe=>[1,0,Et(qe),1,0,0],jt=qe=>[1,Et(qe),0,1,0,0],Ft=qe=>{let{scaleX:f=1,scaleY:Ve=1,flipX:Ue=!1,flipY:Je=!1,skewX:Bn=0,skewY:Vn=0}=qe,Nn=Pt(Ue?-f:f,Je?-Ve:Ve);return Bn&&(Nn=St(Nn,At(Bn),!0)),Vn&&(Nn=St(Nn,jt(Vn),!0)),Nn},Lt=qe=>{const{translateX:f=0,translateY:Ve=0,angle:Ue=0}=qe;let Je=Dt(f,Ve);Ue&&(Je=St(Je,Mt({angle:Ue})));const Bn=Ft(qe);return Ct(Bn)||(Je=St(Je,Bn)),Je},Rt=function(qe){let{signal:f,crossOrigin:Ve=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(Ue,Je){if(f&&f.aborted)return Je(new c("loadImage"));const Bn=mt();let Vn;f&&(Vn=function(Un){Bn.src="",Je(Un)},f.addEventListener("abort",Vn,{once:!0}));const Nn=function(){Bn.onload=Bn.onerror=null,Vn&&(f==null||f.removeEventListener("abort",Vn)),Ue(Bn)};qe?(Bn.onload=Nn,Bn.onerror=function(){Vn&&(f==null||f.removeEventListener("abort",Vn)),Je(new h("Error loading ".concat(Bn.src)))},Ve&&(Bn.crossOrigin=Ve),Bn.src=qe):Nn()})},It=function(qe){let{signal:f,reviver:Ve=C}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((Ue,Je)=>{const Bn=[];f&&f.addEventListener("abort",Je,{once:!0}),Promise.all(qe.map(Vn=>tt.getClass(Vn.type).fromObject(Vn,{signal:f}).then(Nn=>(Ve(Vn,Nn),Bn.push(Nn),Nn)))).then(Ue).catch(Vn=>{Bn.forEach(Nn=>{Nn.dispose&&Nn.dispose()}),Je(Vn)}).finally(()=>{f&&f.removeEventListener("abort",Je)})})},Bt=function(qe){let{signal:f}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((Ve,Ue)=>{const Je=[];f&&f.addEventListener("abort",Ue,{once:!0});const Bn=Object.values(qe).map(Nn=>Nn&&Nn.type&&tt.has(Nn.type)?It([Nn],{signal:f}).then(Un=>{let[qn]=Un;return Je.push(qn),qn}):Nn),Vn=Object.keys(qe);Promise.all(Bn).then(Nn=>Nn.reduce((Un,qn,qo)=>(Un[Vn[qo]]=qn,Un),{})).then(Ve).catch(Nn=>{Je.forEach(Un=>{Un.dispose&&Un.dispose()}),Ue(Nn)}).finally(()=>{f&&f.removeEventListener("abort",Ue)})})},Xt=function(qe){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((f,Ve)=>(Ve in qe&&(f[Ve]=qe[Ve]),f),{})},Yt=(qe,f)=>Object.keys(qe).reduce((Ve,Ue)=>(f(qe[Ue],Ue,qe)&&(Ve[Ue]=qe[Ue]),Ve),{}),Wt={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Vt=(qe,f,Ve)=>(Ve<0&&(Ve+=1),Ve>1&&(Ve-=1),Ve<1/6?qe+6*(f-qe)*Ve:Ve<.5?f:Ve<2/3?qe+(f-qe)*(2/3-Ve)*6:qe),zt=(qe,f,Ve,Ue)=>{qe/=255,f/=255,Ve/=255;const Je=Math.max(qe,f,Ve),Bn=Math.min(qe,f,Ve);let Vn,Nn;const Un=(Je+Bn)/2;if(Je===Bn)Vn=Nn=0;else{const qn=Je-Bn;switch(Nn=Un>.5?qn/(2-Je-Bn):qn/(Je+Bn),Je){case qe:Vn=(f-Ve)/qn+(f<Ve?6:0);break;case f:Vn=(Ve-qe)/qn+2;break;case Ve:Vn=(qe-f)/qn+4}Vn/=6}return[Math.round(360*Vn),Math.round(100*Nn),Math.round(100*Un),Ue]},Ht=function(){let qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(qe)/(qe.endsWith("%")?100:1)},Gt=qe=>Math.min(Math.round(qe),255).toString(16).toUpperCase().padStart(2,"0"),Nt=qe=>{let[f,Ve,Ue,Je=1]=qe;const Bn=Math.round(.3*f+.59*Ve+.11*Ue);return[Bn,Bn,Bn,Je]};class Ut{constructor(f){if(t(this,"isUnrecognised",!1),f)if(f instanceof Ut)this.setSource([...f._source]);else if(Array.isArray(f)){const[Ve,Ue,Je,Bn=1]=f;this.setSource([Ve,Ue,Je,Bn])}else this.setSource(this._tryParsingColor(f));else this.setSource([0,0,0,1])}_tryParsingColor(f){return(f=f.toLowerCase())in Wt&&(f=Wt[f]),f==="transparent"?[255,255,255,0]:Ut.sourceFromHex(f)||Ut.sourceFromRgb(f)||Ut.sourceFromHsl(f)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(f){this._source=f}toRgb(){const[f,Ve,Ue]=this.getSource();return"rgb(".concat(f,",").concat(Ve,",").concat(Ue,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[f,Ve,Ue]=zt(...this.getSource());return"hsl(".concat(f,",").concat(Ve,"%,").concat(Ue,"%)")}toHsla(){const[f,Ve,Ue,Je]=zt(...this.getSource());return"hsla(".concat(f,",").concat(Ve,"%,").concat(Ue,"%,").concat(Je,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[f,Ve,Ue,Je]=this.getSource();return"".concat(Gt(f)).concat(Gt(Ve)).concat(Gt(Ue)).concat(Gt(Math.round(255*Je)))}getAlpha(){return this.getSource()[3]}setAlpha(f){return this._source[3]=f,this}toGrayscale(){return this.setSource(Nt(this.getSource())),this}toBlackWhite(f){const[Ve,,,Ue]=Nt(this.getSource()),Je=Ve<(f||127)?0:255;return this.setSource([Je,Je,Je,Ue]),this}overlayWith(f){f instanceof Ut||(f=new Ut(f));const Ve=this.getSource(),Ue=f.getSource(),[Je,Bn,Vn]=Ve.map((Nn,Un)=>Math.round(.5*Nn+.5*Ue[Un]));return this.setSource([Je,Bn,Vn,Ve[3]]),this}static fromRgb(f){return Ut.fromRgba(f)}static fromRgba(f){return new Ut(Ut.sourceFromRgb(f))}static sourceFromRgb(f){const Ve=f.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(Ve){const[Ue,Je,Bn]=Ve.slice(1,4).map(Vn=>{const Nn=parseFloat(Vn);return Vn.endsWith("%")?Math.round(2.55*Nn):Nn});return[Ue,Je,Bn,Ht(Ve[4])]}}static fromHsl(f){return Ut.fromHsla(f)}static fromHsla(f){return new Ut(Ut.sourceFromHsl(f))}static sourceFromHsl(f){const Ve=f.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!Ve)return;const Ue=(Ut.parseAngletoDegrees(Ve[1])%360+360)%360/360,Je=parseFloat(Ve[2])/100,Bn=parseFloat(Ve[3])/100;let Vn,Nn,Un;if(Je===0)Vn=Nn=Un=Bn;else{const qn=Bn<=.5?Bn*(Je+1):Bn+Je-Bn*Je,qo=2*Bn-qn;Vn=Vt(qo,qn,Ue+1/3),Nn=Vt(qo,qn,Ue),Un=Vt(qo,qn,Ue-1/3)}return[Math.round(255*Vn),Math.round(255*Nn),Math.round(255*Un),Ht(Ve[4])]}static fromHex(f){return new Ut(Ut.sourceFromHex(f))}static sourceFromHex(f){if(f.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const Ve=f.slice(f.indexOf("#")+1);let Ue;Ue=Ve.length<=4?Ve.split("").map(Un=>Un+Un):Ve.match(/.{2}/g);const[Je,Bn,Vn,Nn=255]=Ue.map(Un=>parseInt(Un,16));return[Je,Bn,Vn,Nn/255]}}static parseAngletoDegrees(f){const Ve=f.toLowerCase(),Ue=parseFloat(Ve);return Ve.includes("rad")?xt(Ue):Ve.includes("turn")?360*Ue:Ue}}const qt=(qe,f)=>parseFloat(Number(qe).toFixed(f)),Kt=function(qe){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O;const Ve=/\D{0,2}$/.exec(qe),Ue=parseFloat(qe),Je=o.DPI;switch(Ve==null?void 0:Ve[0]){case"mm":return Ue*Je/25.4;case"cm":return Ue*Je/2.54;case"in":return Ue*Je;case"pt":return Ue*Je/72;case"pc":return Ue*Je/72*12;case"em":return Ue*f;default:return Ue}},Jt=qe=>{const[f,Ve]=qe.trim().split(" "),[Ue,Je]=(Bn=f)&&Bn!==j?[Bn.slice(1,4),Bn.slice(5,8)]:Bn===j?[Bn,Bn]:["Mid","Mid"];var Bn;return{meetOrSlice:Ve||"meet",alignX:Ue,alignY:Je}},Qt=qe=>"matrix("+qe.map(f=>qt(f,o.NUM_FRACTION_DIGITS)).join(" ")+")",Zt=function(qe,f){let Ve,Ue,Je=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(f)if(f.toLive)Ve="url(#SVGID_".concat(f.id,")");else{const Bn=new Ut(f),Vn=Bn.getAlpha();Ve=Bn.toRgb(),Vn!==1&&(Ue=Vn.toString())}else Ve="none";return Je?"".concat(qe,": ").concat(Ve,"; ").concat(Ue?"".concat(qe,"-opacity: ").concat(Ue,"; "):""):"".concat(qe,'="').concat(Ve,'" ').concat(Ue?"".concat(qe,'-opacity="').concat(Ue,'" '):"")},$t=qe=>!!qe&&qe.toLive!==void 0,te=qe=>!!qe&&typeof qe.toObject=="function",ee=qe=>!!qe&&qe.offsetX!==void 0&&"source"in qe,se=qe=>!!qe&&"multiSelectionStacking"in qe;function ie(qe){const f=qe&&re(qe);let Ve=0,Ue=0;if(!qe||!f)return{left:Ve,top:Ue};let Je=qe;const Bn=f.documentElement,Vn=f.body||{scrollLeft:0,scrollTop:0};for(;Je&&(Je.parentNode||Je.host)&&(Je=Je.parentNode||Je.host,Je===f?(Ve=Vn.scrollLeft||Bn.scrollLeft||0,Ue=Vn.scrollTop||Bn.scrollTop||0):(Ve+=Je.scrollLeft||0,Ue+=Je.scrollTop||0),Je.nodeType!==1||Je.style.position!=="fixed"););return{left:Ve,top:Ue}}const re=qe=>qe.ownerDocument||null,ne=qe=>{var f;return((f=qe.ownerDocument)===null||f===void 0?void 0:f.defaultView)||null},oe=function(qe,f,Ve){let{width:Ue,height:Je}=Ve,Bn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;qe.width=Ue,qe.height=Je,Bn>1&&(qe.setAttribute("width",(Ue*Bn).toString()),qe.setAttribute("height",(Je*Bn).toString()),f.scale(Bn,Bn))},ae=(qe,f)=>{let{width:Ve,height:Ue}=f;Ve&&(qe.style.width=typeof Ve=="number"?"".concat(Ve,"px"):Ve),Ue&&(qe.style.height=typeof Ue=="number"?"".concat(Ue,"px"):Ue)};function he(qe){return qe.onselectstart!==void 0&&(qe.onselectstart=()=>!1),qe.style.userSelect=j,qe}class ce{constructor(f){t(this,"_originalCanvasStyle",void 0),t(this,"lower",void 0);const Ve=this.createLowerCanvas(f);this.lower={el:Ve,ctx:Ve.getContext("2d")}}createLowerCanvas(f){const Ve=(Ue=f)&&Ue.getContext!==void 0?f:f&&m().getElementById(f)||pt();var Ue;if(Ve.hasAttribute("data-fabric"))throw new h("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=Ve.style.cssText,Ve.setAttribute("data-fabric","main"),Ve.classList.add("lower-canvas"),Ve}cleanupDOM(f){let{width:Ve,height:Ue}=f;const{el:Je}=this.lower;Je.classList.remove("lower-canvas"),Je.removeAttribute("data-fabric"),Je.setAttribute("width","".concat(Ve)),Je.setAttribute("height","".concat(Ue)),Je.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(f,Ve){const{el:Ue,ctx:Je}=this.lower;oe(Ue,Je,f,Ve)}setCSSDimensions(f){ae(this.lower.el,f)}calcOffset(){return function(f){var Ve;const Ue=f&&re(f),Je={left:0,top:0};if(!Ue)return Je;const Bn=((Ve=ne(f))===null||Ve===void 0?void 0:Ve.getComputedStyle(f,null))||{};Je.left+=parseInt(Bn.borderLeftWidth,10)||0,Je.top+=parseInt(Bn.borderTopWidth,10)||0,Je.left+=parseInt(Bn.paddingLeft,10)||0,Je.top+=parseInt(Bn.paddingTop,10)||0;let Vn={left:0,top:0};const Nn=Ue.documentElement;f.getBoundingClientRect!==void 0&&(Vn=f.getBoundingClientRect());const Un=ie(f);return{left:Vn.left+Un.left-(Nn.clientLeft||0)+Je.left,top:Vn.top+Un.top-(Nn.clientTop||0)+Je.top}}(this.lower.el)}dispose(){p().dispose(this.lower.el),delete this.lower}}const le={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...T]};class ue extends ct(lt){get lowerCanvasEl(){var f;return(f=this.elements.lower)===null||f===void 0?void 0:f.el}get contextContainer(){var f;return(f=this.elements.lower)===null||f===void 0?void 0:f.ctx}static getDefaults(){return ue.ownDefaults}constructor(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(Ve),this.initElements(f),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(f){this.elements=new ce(f)}add(){const f=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),f}insertAt(f){for(var Ve=arguments.length,Ue=new Array(Ve>1?Ve-1:0),Je=1;Je<Ve;Je++)Ue[Je-1]=arguments[Je];const Bn=super.insertAt(f,...Ue);return Ue.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),Bn}remove(){const f=super.remove(...arguments);return f.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),f}_onObjectAdded(f){f.canvas&&f.canvas!==this&&(a("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),f.canvas.remove(f)),f._set("canvas",this),f.setCoords(),this.fire("object:added",{target:f}),f.fire("added",{target:this})}_onObjectRemoved(f){f._set("canvas",void 0),this.fire("object:removed",{target:f}),f.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?y():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(f,Ve){return this.setDimensions({width:f},Ve)}setHeight(f,Ve){return this.setDimensions({height:f},Ve)}_setDimensionsImpl(f){let{cssOnly:Ve=!1,backstoreOnly:Ue=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ve){const Je=s({width:this.width,height:this.height},f);this.elements.setDimensions(Je,this.getRetinaScaling()),this.hasLostContext=!0,this.width=Je.width,this.height=Je.height}Ue||this.elements.setCSSDimensions(f),this.calcOffset()}setDimensions(f,Ve){this._setDimensionsImpl(f,Ve),Ve&&Ve.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(f){this.viewportTransform=f,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(f,Ve){const Ue=f,Je=[...this.viewportTransform],Bn=bt(f,wt(Je));Je[0]=Ve,Je[3]=Ve;const Vn=bt(Bn,Je);Je[4]+=Ue.x-Vn.x,Je[5]+=Ue.y-Vn.y,this.setViewportTransform(Je)}setZoom(f){this.zoomToPoint(new ot(0,0),f)}absolutePan(f){const Ve=[...this.viewportTransform];return Ve[4]=-f.x,Ve[5]=-f.y,this.setViewportTransform(Ve)}relativePan(f){return this.absolutePan(new ot(-f.x-this.viewportTransform[4],-f.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(f){f.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=ut(()=>this.renderAndReset()))}calcViewportBoundaries(){const f=this.width,Ve=this.height,Ue=wt(this.viewportTransform),Je=bt({x:0,y:0},Ue),Bn=bt({x:f,y:Ve},Ue),Vn=Je.min(Bn),Nn=Je.max(Bn);return this.vptCoords={tl:Vn,tr:new ot(Nn.x,Vn.y),bl:new ot(Vn.x,Nn.y),br:Nn}}cancelRequestedRender(){this.nextRenderHandle&&(dt(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(f){}renderCanvas(f,Ve){if(this.destroyed)return;const Ue=this.viewportTransform,Je=this.clipPath;this.calcViewportBoundaries(),this.clearContext(f),f.imageSmoothingEnabled=this.imageSmoothingEnabled,f.patternQuality="best",this.fire("before:render",{ctx:f}),this._renderBackground(f),f.save(),f.transform(Ue[0],Ue[1],Ue[2],Ue[3],Ue[4],Ue[5]),this._renderObjects(f,Ve),f.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(f),Je&&(Je._set("canvas",this),Je.shouldCache(),Je._transformDone=!0,Je.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(f,Je)),this._renderOverlay(f),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(f),this.fire("after:render",{ctx:f}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(f,Ve){const Ue=this.viewportTransform;f.save(),f.transform(...Ue),f.globalCompositeOperation="destination-in",Ve.transform(f),f.scale(1/Ve.zoomX,1/Ve.zoomY),f.drawImage(Ve._cacheCanvas,-Ve.cacheTranslationX,-Ve.cacheTranslationY),f.restore()}_renderObjects(f,Ve){for(let Ue=0,Je=Ve.length;Ue<Je;++Ue)Ve[Ue]&&Ve[Ue].render(f)}_renderBackgroundOrOverlay(f,Ve){const Ue=this["".concat(Ve,"Color")],Je=this["".concat(Ve,"Image")],Bn=this.viewportTransform,Vn=this["".concat(Ve,"Vpt")];if(!Ue&&!Je)return;const Nn=$t(Ue);if(Ue){if(f.save(),f.beginPath(),f.moveTo(0,0),f.lineTo(this.width,0),f.lineTo(this.width,this.height),f.lineTo(0,this.height),f.closePath(),f.fillStyle=Nn?Ue.toLive(f):Ue,Vn&&f.transform(...Bn),Nn){f.transform(1,0,0,1,Ue.offsetX||0,Ue.offsetY||0);const Un=Ue.gradientTransform||Ue.patternTransform;Un&&f.transform(...Un)}f.fill(),f.restore()}if(Je){f.save();const{skipOffscreen:Un}=this;this.skipOffscreen=Vn,Vn&&f.transform(...Bn),Je.render(f),this.skipOffscreen=Un,f.restore()}}_renderBackground(f){this._renderBackgroundOrOverlay(f,"background")}_renderOverlay(f){this._renderBackgroundOrOverlay(f,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new ot(this.width/2,this.height/2)}centerObjectH(f){return this._centerObject(f,new ot(this.getCenterPoint().x,f.getCenterPoint().y))}centerObjectV(f){return this._centerObject(f,new ot(f.getCenterPoint().x,this.getCenterPoint().y))}centerObject(f){return this._centerObject(f,this.getCenterPoint())}viewportCenterObject(f){return this._centerObject(f,this.getVpCenter())}viewportCenterObjectH(f){return this._centerObject(f,new ot(this.getVpCenter().x,f.getCenterPoint().y))}viewportCenterObjectV(f){return this._centerObject(f,new ot(f.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return bt(this.getCenterPoint(),wt(this.viewportTransform))}_centerObject(f,Ve){f.setXY(Ve,D,D),f.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(f){return this.toDatalessObject(f)}toObject(f){return this._toObjectMethod("toObject",f)}toJSON(){return this.toObject()}toDatalessObject(f){return this._toObjectMethod("toDatalessObject",f)}_toObjectMethod(f,Ve){const Ue=this.clipPath,Je=Ue&&!Ue.excludeFromExport?this._toObject(Ue,f,Ve):null;return s(s(s({version:x},Xt(this,Ve)),{},{objects:this._objects.filter(Bn=>!Bn.excludeFromExport).map(Bn=>this._toObject(Bn,f,Ve))},this.__serializeBgOverlay(f,Ve)),Je?{clipPath:Je}:null)}_toObject(f,Ve,Ue){let Je;this.includeDefaultValues||(Je=f.includeDefaultValues,f.includeDefaultValues=!1);const Bn=f[Ve](Ue);return this.includeDefaultValues||(f.includeDefaultValues=!!Je),Bn}__serializeBgOverlay(f,Ve){const Ue={},Je=this.backgroundImage,Bn=this.overlayImage,Vn=this.backgroundColor,Nn=this.overlayColor;return $t(Vn)?Vn.excludeFromExport||(Ue.background=Vn.toObject(Ve)):Vn&&(Ue.background=Vn),$t(Nn)?Nn.excludeFromExport||(Ue.overlay=Nn.toObject(Ve)):Nn&&(Ue.overlay=Nn),Je&&!Je.excludeFromExport&&(Ue.backgroundImage=this._toObject(Je,f,Ve)),Bn&&!Bn.excludeFromExport&&(Ue.overlayImage=this._toObject(Bn,f,Ve)),Ue}toSVG(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ve=arguments.length>1?arguments[1]:void 0;f.reviver=Ve;const Ue=[];return this._setSVGPreamble(Ue,f),this._setSVGHeader(Ue,f),this.clipPath&&Ue.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(Ue,"background"),this._setSVGBgOverlayImage(Ue,"backgroundImage",Ve),this._setSVGObjects(Ue,Ve),this.clipPath&&Ue.push(`</g>
`),this._setSVGBgOverlayColor(Ue,"overlay"),this._setSVGBgOverlayImage(Ue,"overlayImage",Ve),Ue.push("</svg>"),Ue.join("")}_setSVGPreamble(f,Ve){Ve.suppressPreamble||f.push('<?xml version="1.0" encoding="',Ve.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(f,Ve){const Ue=Ve.width||"".concat(this.width),Je=Ve.height||"".concat(this.height),Bn=o.NUM_FRACTION_DIGITS,Vn=Ve.viewBox;let Nn;if(Vn)Nn='viewBox="'.concat(Vn.x," ").concat(Vn.y," ").concat(Vn.width," ").concat(Vn.height,'" ');else if(this.svgViewportTransformation){const Un=this.viewportTransform;Nn='viewBox="'.concat(qt(-Un[4]/Un[0],Bn)," ").concat(qt(-Un[5]/Un[3],Bn)," ").concat(qt(this.width/Un[0],Bn)," ").concat(qt(this.height/Un[3],Bn),'" ')}else Nn='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');f.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',Ue,'" ','height="',Je,'" ',Nn,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",x,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(Ve),`</defs>
`)}createSVGClipPathMarkup(f){const Ve=this.clipPath;return Ve?(Ve.clipPathId="CLIPPATH_".concat(ft()),'<clipPath id="'.concat(Ve.clipPathId,`" >
`).concat(Ve.toClipPathSVG(f.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(f=>{const Ve=this["".concat(f,"Color")];if($t(Ve)){const Ue=this["".concat(f,"Vpt")],Je=this.viewportTransform,Bn={isType:()=>!1,width:this.width/(Ue?Je[0]:1),height:this.height/(Ue?Je[3]:1)};return Ve.toSVG(Bn,{additionalTransform:Ue?Qt(Je):""})}}).join("")}createSVGFontFacesMarkup(){const f=[],Ve={},Ue=o.fontPaths;this._objects.forEach(function Bn(Vn){f.push(Vn),ht(Vn)&&Vn._objects.forEach(Bn)}),f.forEach(Bn=>{if(!(Vn=Bn)||typeof Vn._renderText!="function")return;var Vn;const{styles:Nn,fontFamily:Un}=Bn;!Ve[Un]&&Ue[Un]&&(Ve[Un]=!0,Nn&&Object.values(Nn).forEach(qn=>{Object.values(qn).forEach(qo=>{let{fontFamily:$o=""}=qo;!Ve[$o]&&Ue[$o]&&(Ve[$o]=!0)})}))});const Je=Object.keys(Ve).map(Bn=>`		@font-face {
			font-family: '`.concat(Bn,`';
			src: url('`).concat(Ue[Bn],`');
		}
`)).join("");return Je?`	<style type="text/css"><![CDATA[
`.concat(Je,`]]></style>
`):""}_setSVGObjects(f,Ve){this.forEachObject(Ue=>{Ue.excludeFromExport||this._setSVGObject(f,Ue,Ve)})}_setSVGObject(f,Ve,Ue){f.push(Ve.toSVG(Ue))}_setSVGBgOverlayImage(f,Ve,Ue){const Je=this[Ve];Je&&!Je.excludeFromExport&&Je.toSVG&&f.push(Je.toSVG(Ue))}_setSVGBgOverlayColor(f,Ve){const Ue=this["".concat(Ve,"Color")];if(Ue)if($t(Ue)){const Je=Ue.repeat||"",Bn=this.width,Vn=this.height,Nn=this["".concat(Ve,"Vpt")]?Qt(wt(this.viewportTransform)):"";f.push('<rect transform="'.concat(Nn," translate(").concat(Bn/2,",").concat(Vn/2,')" x="').concat(Ue.offsetX-Bn/2,'" y="').concat(Ue.offsetY-Vn/2,'" width="').concat(Je!=="repeat-y"&&Je!=="no-repeat"||!ee(Ue)?Bn:Ue.source.width,'" height="').concat(Je!=="repeat-x"&&Je!=="no-repeat"||!ee(Ue)?Vn:Ue.source.height,'" fill="url(#SVGID_').concat(Ue.id,`)"></rect>
`))}else f.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',Ue,'"',`></rect>
`)}loadFromJSON(f,Ve){let{signal:Ue}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!f)return Promise.reject(new h("`json` is undefined"));const Je=typeof f=="string"?JSON.parse(f):f,{objects:Bn=[],backgroundImage:Vn,background:Nn,overlayImage:Un,overlay:qn,clipPath:qo}=Je,$o=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([It(Bn,{reviver:Ve,signal:Ue}),Bt({backgroundImage:Vn,backgroundColor:Nn,overlayImage:Un,overlayColor:qn,clipPath:qo},{signal:Ue})]).then(Zo=>{let[ta,ea]=Zo;return this.clear(),this.add(...ta),this.set(Je),this.set(ea),this.renderOnAddRemove=$o,this})}clone(f){const Ve=this.toObject(f);return this.cloneWithoutData().loadFromJSON(Ve)}cloneWithoutData(){const f=vt(this);return new this.constructor(f)}toDataURL(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:Ve="png",quality:Ue=1,multiplier:Je=1,enableRetinaScaling:Bn=!1}=f,Vn=Je*(Bn?this.getRetinaScaling():1);return yt(this.toCanvasElement(Vn,f),Ve,Ue)}toCanvasElement(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:Ve,height:Ue,left:Je,top:Bn,filter:Vn}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const Nn=(Ve||this.width)*f,Un=(Ue||this.height)*f,qn=this.getZoom(),qo=this.width,$o=this.height,Zo=this.skipControlsDrawing,ta=qn*f,ea=this.viewportTransform,ra=[ta,0,0,ta,(ea[4]-(Je||0))*f,(ea[5]-(Bn||0))*f],na=this.enableRetinaScaling,oa=vt({width:Nn,height:Un}),ca=Vn?this._objects.filter(pa=>Vn(pa)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=ra,this.width=Nn,this.height=Un,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(oa.getContext("2d"),ca),this.viewportTransform=ea,this.width=qo,this.height=$o,this.calcViewportBoundaries(),this.enableRetinaScaling=na,this.skipControlsDrawing=Zo,oa}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),et.cancelByCanvas(this),this.disposed=!0,new Promise((f,Ve)=>{const Ue=()=>{this.destroy(),f(!0)};Ue.kill=Ve,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?f(!1):this.nextRenderHandle?this.__cleanupTask=Ue:Ue()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(f=>f.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}t(ue,"ownDefaults",le);const de=["touchstart","touchmove","touchend"],ge=qe=>{const f=ie(qe.target),Ve=function(Ue){const Je=Ue.changedTouches;return Je&&Je[0]?Je[0]:Ue}(qe);return new ot(Ve.clientX+f.left,Ve.clientY+f.top)},fe=qe=>de.includes(qe.type)||qe.pointerType==="touch",pe=qe=>{qe.preventDefault(),qe.stopPropagation()},me=qe=>{let f=0,Ve=0,Ue=0,Je=0;for(let Bn=0,Vn=qe.length;Bn<Vn;Bn++){const{x:Nn,y:Un}=qe[Bn];(Nn>Ue||!Bn)&&(Ue=Nn),(Nn<f||!Bn)&&(f=Nn),(Un>Je||!Bn)&&(Je=Un),(Un<Ve||!Bn)&&(Ve=Un)}return{left:f,top:Ve,width:Ue-f,height:Je-Ve}},ve=["translateX","translateY","scaleX","scaleY"],ye=(qe,f)=>_e(qe,St(f,qe.calcOwnMatrix())),_e=(qe,f)=>{const Ve=kt(f),{translateX:Ue,translateY:Je,scaleX:Bn,scaleY:Vn}=Ve,Nn=i(Ve,ve),Un=new ot(Ue,Je);qe.flipX=!1,qe.flipY=!1,Object.assign(qe,Nn),qe.set({scaleX:Bn,scaleY:Vn}),qe.setPositionByOrigin(Un,D,D)},xe=qe=>{qe.scaleX=1,qe.scaleY=1,qe.skewX=0,qe.skewY=0,qe.flipX=!1,qe.flipY=!1,qe.rotate(0)},Ce=qe=>({scaleX:qe.scaleX,scaleY:qe.scaleY,skewX:qe.skewX,skewY:qe.skewY,angle:qe.angle,left:qe.left,flipX:qe.flipX,flipY:qe.flipY,top:qe.top}),be=(qe,f,Ve)=>{const Ue=qe/2,Je=f/2,Bn=[new ot(-Ue,-Je),new ot(Ue,-Je),new ot(-Ue,Je),new ot(Ue,Je)].map(Nn=>Nn.transform(Ve)),Vn=me(Bn);return new ot(Vn.width,Vn.height)},we=function(){let qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T;return St(wt(arguments.length>1&&arguments[1]!==void 0?arguments[1]:T),qe)},Se=function(qe){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T,Ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T;return qe.transform(we(f,Ve))},Te=function(qe){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T,Ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T;return qe.transform(we(f,Ve),!0)},Oe=(qe,f,Ve)=>{const Ue=we(f,Ve);return _e(qe,St(Ue,qe.calcOwnMatrix())),Ue},ke=(qe,f)=>{var Ve;const{transform:{target:Ue}}=f;(Ve=Ue.canvas)===null||Ve===void 0||Ve.fire("object:".concat(qe),s(s({},f),{},{target:Ue})),Ue.fire(qe,f)},De={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Me=qe=>typeof qe=="string"?De[qe]:qe-.5,Pe="not-allowed";function Ee(qe){return Me(qe.originX)===Me(D)&&Me(qe.originY)===Me(D)}function Ae(qe){return .5-Me(qe)}const je=(qe,f)=>qe[f],Fe=(qe,f,Ve,Ue)=>({e:qe,transform:f,pointer:new ot(Ve,Ue)});function Le(qe,f){const Ve=qe.getTotalAngle()+xt(Math.atan2(f.y,f.x))+360;return Math.round(Ve%360/45)}function Re(qe,f,Ve,Ue,Je){var Bn;let{target:Vn,corner:Nn}=qe;const Un=Vn.controls[Nn],qn=((Bn=Vn.canvas)===null||Bn===void 0?void 0:Bn.getZoom())||1,qo=Vn.padding/qn,$o=function(Zo,ta,ea,ra){const na=Zo.getRelativeCenterPoint(),oa=ea!==void 0&&ra!==void 0?Zo.translateToGivenOrigin(na,D,D,ea,ra):new ot(Zo.left,Zo.top);return(Zo.angle?ta.rotate(-_t(Zo.angle),na):ta).subtract(oa)}(Vn,new ot(Ue,Je),f,Ve);return $o.x>=qo&&($o.x-=qo),$o.x<=-qo&&($o.x+=qo),$o.y>=qo&&($o.y-=qo),$o.y<=qo&&($o.y+=qo),$o.x-=Un.offsetX,$o.y-=Un.offsetY,$o}const Ie=(qe,f,Ve,Ue)=>{const{target:Je,offsetX:Bn,offsetY:Vn}=f,Nn=Ve-Bn,Un=Ue-Vn,qn=!je(Je,"lockMovementX")&&Je.left!==Nn,qo=!je(Je,"lockMovementY")&&Je.top!==Un;return qn&&Je.set(M,Nn),qo&&Je.set(P,Un),(qn||qo)&&ke(L,Fe(qe,f,Ve,Ue)),qn||qo};class Be{getSvgStyles(f){const Ve=this.fillRule?this.fillRule:"nonzero",Ue=this.strokeWidth?this.strokeWidth:"0",Je=this.strokeDashArray?this.strokeDashArray.join(" "):j,Bn=this.strokeDashOffset?this.strokeDashOffset:"0",Vn=this.strokeLineCap?this.strokeLineCap:"butt",Nn=this.strokeLineJoin?this.strokeLineJoin:"miter",Un=this.strokeMiterLimit?this.strokeMiterLimit:"4",qn=this.opacity!==void 0?this.opacity:"1",qo=this.visible?"":" visibility: hidden;",$o=f?"":this.getSvgFilter(),Zo=Zt(K,this.fill);return[Zt(J,this.stroke),"stroke-width: ",Ue,"; ","stroke-dasharray: ",Je,"; ","stroke-linecap: ",Vn,"; ","stroke-dashoffset: ",Bn,"; ","stroke-linejoin: ",Nn,"; ","stroke-miterlimit: ",Un,"; ",Zo,"fill-rule: ",Ve,"; ","opacity: ",qn,";",$o,qo].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const Ue=f?this.calcTransformMatrix():this.calcOwnMatrix(),Je='transform="'.concat(Qt(Ue));return"".concat(Je).concat(Ve,'" ')}_toSVG(f){return[""]}toSVG(f){return this._createBaseSVGMarkup(this._toSVG(f),{reviver:f})}toClipPathSVG(f){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(f),{reviver:f})}_createBaseClipPathSVGMarkup(f){let{reviver:Ve,additionalTransform:Ue=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const Je=[this.getSvgTransform(!0,Ue),this.getSvgCommons()].join(""),Bn=f.indexOf("COMMON_PARTS");return f[Bn]=Je,Ve?Ve(f.join("")):f.join("")}_createBaseSVGMarkup(f){let{noStyle:Ve,reviver:Ue,withShadow:Je,additionalTransform:Bn}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const Vn=Ve?"":'style="'.concat(this.getSvgStyles(),'" '),Nn=Je?'style="'.concat(this.getSvgFilter(),'" '):"",Un=this.clipPath,qn=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",qo=Un&&Un.absolutePositioned,$o=this.stroke,Zo=this.fill,ta=this.shadow,ea=[],ra=f.indexOf("COMMON_PARTS");let na;Un&&(Un.clipPathId="CLIPPATH_".concat(ft()),na='<clipPath id="'.concat(Un.clipPathId,`" >
`).concat(Un.toClipPathSVG(Ue),`</clipPath>
`)),qo&&ea.push("<g ",Nn,this.getSvgCommons(),` >
`),ea.push("<g ",this.getSvgTransform(!1),qo?"":Nn+this.getSvgCommons(),` >
`);const oa=[Vn,qn,Ve?"":this.addPaintOrder()," ",Bn?'transform="'.concat(Bn,'" '):""].join("");return f[ra]=oa,$t(Zo)&&ea.push(Zo.toSVG(this)),$t($o)&&ea.push($o.toSVG(this)),ta&&ea.push(ta.toSVG(this)),Un&&ea.push(na),ea.push(f.join("")),ea.push(`</g>
`),qo&&ea.push(`</g>
`),Ue?Ue(ea.join("")):ea.join("")}addPaintOrder(){return this.paintFirst!==K?' paint-order="'.concat(this.paintFirst,'" '):""}}function Xe(qe){return new RegExp("^("+qe.join("|")+")\\b","i")}var Ye;const We=String.raw(Ye||(Ye=r(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),ze=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+We+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+We+"))?\\s+(.*)"),He={cx:M,x:M,r:"radius",cy:P,y:P,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Ge="font-size",Ne="clip-path";Xe(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);Xe(["symbol","image","marker","pattern","view","svg"]);const Ke=Xe(["symbol","g","a","svg","clipPath","defs"]),Qe=new ot(1,0),Ze=new ot,$e=(qe,f)=>qe.rotate(f),ts=(qe,f)=>new ot(f).subtract(qe),es=qe=>qe.distanceFrom(Ze),ss=(qe,f)=>Math.atan2(os(qe,f),as(qe,f)),is=qe=>ss(Qe,qe),rs=qe=>qe.eq(Ze)?qe:qe.scalarDivide(es(qe)),ns=function(qe){let f=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return rs(new ot(-qe.y,qe.x).scalarMultiply(f?1:-1))},os=(qe,f)=>qe.x*f.y-qe.y*f.x,as=(qe,f)=>qe.x*f.x+qe.y*f.y,hs=(qe,f,Ve)=>{if(qe.eq(f)||qe.eq(Ve))return!0;const Ue=os(f,Ve),Je=os(f,qe),Bn=os(Ve,qe);return Ue>=0?Je>=0&&Bn<=0:!(Je<=0&&Bn>=0)},cs="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",ls=new RegExp("(?:\\s|^)"+cs+cs+"("+We+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class us{constructor(f){const Ve=typeof f=="string"?us.parseShadow(f):f;Object.assign(this,us.ownDefaults,Ve),this.id=ft()}static parseShadow(f){const Ve=f.trim(),[,Ue=0,Je=0,Bn=0]=(ls.exec(Ve)||[]).map(Vn=>parseFloat(Vn)||0);return{color:(Ve.replace(ls,"")||"rgb(0,0,0)").trim(),offsetX:Ue,offsetY:Je,blur:Bn}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(f){const Ve=$e(new ot(this.offsetX,this.offsetY),_t(-f.angle)),Ue=new Ut(this.color);let Je=40,Bn=40;return f.width&&f.height&&(Je=100*qt((Math.abs(Ve.x)+this.blur)/f.width,o.NUM_FRACTION_DIGITS)+20,Bn=100*qt((Math.abs(Ve.y)+this.blur)/f.height,o.NUM_FRACTION_DIGITS)+20),f.flipX&&(Ve.x*=-1),f.flipY&&(Ve.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(Bn,'%" height="').concat(100+2*Bn,'%" x="-').concat(Je,'%" width="').concat(100+2*Je,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(qt(this.blur?this.blur/2:0,o.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(qt(Ve.x,o.NUM_FRACTION_DIGITS),'" dy="').concat(qt(Ve.y,o.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(Ue.toRgb(),'" flood-opacity="').concat(Ue.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const f={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},Ve=us.ownDefaults;return this.includeDefaultValues?f:Yt(f,(Ue,Je)=>Ue!==Ve[Je])}static async fromObject(f){return new this(f)}}t(us,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),t(us,"type","shadow"),tt.setClass(us,"shadow");const ds=(qe,f,Ve)=>Math.max(qe,Math.min(f,Ve)),gs=[P,M,G,N,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",U,q],fs=[K,J,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],ps={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:M,originY:P,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:K,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},ms=(qe,f,Ve,Ue)=>(qe<Math.abs(f)?(qe=f,Ue=Ve/4):Ue=f===0&&qe===0?Ve/w*Math.asin(1):Ve/w*Math.asin(f/qe),{a:qe,c:f,p:Ve,s:Ue}),vs=(qe,f,Ve,Ue,Je)=>qe*Math.pow(2,10*(Ue-=1))*Math.sin((Ue*Je-f)*w/Ve),ys=(qe,f,Ve,Ue)=>-Ve*Math.cos(qe/Ue*b)+Ve+f,_s=(qe,f,Ve,Ue)=>(qe/=Ue)<1/2.75?Ve*(7.5625*qe*qe)+f:qe<2/2.75?Ve*(7.5625*(qe-=1.5/2.75)*qe+.75)+f:qe<2.5/2.75?Ve*(7.5625*(qe-=2.25/2.75)*qe+.9375)+f:Ve*(7.5625*(qe-=2.625/2.75)*qe+.984375)+f,xs=(qe,f,Ve,Ue)=>Ve-_s(Ue-qe,0,Ve,Ue)+f;var Cs=Object.freeze({__proto__:null,defaultEasing:ys,easeInBack:function(qe,f,Ve,Ue){let Je=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return Ve*(qe/=Ue)*qe*((Je+1)*qe-Je)+f},easeInBounce:xs,easeInCirc:(qe,f,Ve,Ue)=>-Ve*(Math.sqrt(1-(qe/=Ue)*qe)-1)+f,easeInCubic:(qe,f,Ve,Ue)=>Ve*(qe/Ue)**3+f,easeInElastic:(qe,f,Ve,Ue)=>{const Je=Ve;let Bn=0;if(qe===0)return f;if((qe/=Ue)===1)return f+Ve;Bn||(Bn=.3*Ue);const{a:Vn,s:Nn,p:Un}=ms(Je,Ve,Bn,1.70158);return-vs(Vn,Nn,Un,qe,Ue)+f},easeInExpo:(qe,f,Ve,Ue)=>qe===0?f:Ve*2**(10*(qe/Ue-1))+f,easeInOutBack:function(qe,f,Ve,Ue){let Je=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(qe/=Ue/2)<1?Ve/2*(qe*qe*((1+(Je*=1.525))*qe-Je))+f:Ve/2*((qe-=2)*qe*((1+(Je*=1.525))*qe+Je)+2)+f},easeInOutBounce:(qe,f,Ve,Ue)=>qe<Ue/2?.5*xs(2*qe,0,Ve,Ue)+f:.5*_s(2*qe-Ue,0,Ve,Ue)+.5*Ve+f,easeInOutCirc:(qe,f,Ve,Ue)=>(qe/=Ue/2)<1?-Ve/2*(Math.sqrt(1-qe**2)-1)+f:Ve/2*(Math.sqrt(1-(qe-=2)*qe)+1)+f,easeInOutCubic:(qe,f,Ve,Ue)=>(qe/=Ue/2)<1?Ve/2*qe**3+f:Ve/2*((qe-2)**3+2)+f,easeInOutElastic:(qe,f,Ve,Ue)=>{const Je=Ve;let Bn=0;if(qe===0)return f;if((qe/=Ue/2)===2)return f+Ve;Bn||(Bn=Ue*(.3*1.5));const{a:Vn,s:Nn,p:Un,c:qn}=ms(Je,Ve,Bn,1.70158);return qe<1?-.5*vs(Vn,Nn,Un,qe,Ue)+f:Vn*Math.pow(2,-10*(qe-=1))*Math.sin((qe*Ue-Nn)*w/Un)*.5+qn+f},easeInOutExpo:(qe,f,Ve,Ue)=>qe===0?f:qe===Ue?f+Ve:(qe/=Ue/2)<1?Ve/2*2**(10*(qe-1))+f:Ve/2*-(2**(-10*--qe)+2)+f,easeInOutQuad:(qe,f,Ve,Ue)=>(qe/=Ue/2)<1?Ve/2*qe**2+f:-Ve/2*(--qe*(qe-2)-1)+f,easeInOutQuart:(qe,f,Ve,Ue)=>(qe/=Ue/2)<1?Ve/2*qe**4+f:-Ve/2*((qe-=2)*qe**3-2)+f,easeInOutQuint:(qe,f,Ve,Ue)=>(qe/=Ue/2)<1?Ve/2*qe**5+f:Ve/2*((qe-2)**5+2)+f,easeInOutSine:(qe,f,Ve,Ue)=>-Ve/2*(Math.cos(Math.PI*qe/Ue)-1)+f,easeInQuad:(qe,f,Ve,Ue)=>Ve*(qe/=Ue)*qe+f,easeInQuart:(qe,f,Ve,Ue)=>Ve*(qe/=Ue)*qe**3+f,easeInQuint:(qe,f,Ve,Ue)=>Ve*(qe/Ue)**5+f,easeInSine:(qe,f,Ve,Ue)=>-Ve*Math.cos(qe/Ue*b)+Ve+f,easeOutBack:function(qe,f,Ve,Ue){let Je=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return Ve*((qe=qe/Ue-1)*qe*((Je+1)*qe+Je)+1)+f},easeOutBounce:_s,easeOutCirc:(qe,f,Ve,Ue)=>Ve*Math.sqrt(1-(qe=qe/Ue-1)*qe)+f,easeOutCubic:(qe,f,Ve,Ue)=>Ve*((qe/Ue-1)**3+1)+f,easeOutElastic:(qe,f,Ve,Ue)=>{const Je=Ve;let Bn=0;if(qe===0)return f;if((qe/=Ue)===1)return f+Ve;Bn||(Bn=.3*Ue);const{a:Vn,s:Nn,p:Un,c:qn}=ms(Je,Ve,Bn,1.70158);return Vn*2**(-10*qe)*Math.sin((qe*Ue-Nn)*w/Un)+qn+f},easeOutExpo:(qe,f,Ve,Ue)=>qe===Ue?f+Ve:Ve*-(2**(-10*qe/Ue)+1)+f,easeOutQuad:(qe,f,Ve,Ue)=>-Ve*(qe/=Ue)*(qe-2)+f,easeOutQuart:(qe,f,Ve,Ue)=>-Ve*((qe=qe/Ue-1)*qe**3-1)+f,easeOutQuint:(qe,f,Ve,Ue)=>Ve*((qe/Ue-1)**5+1)+f,easeOutSine:(qe,f,Ve,Ue)=>Ve*Math.sin(qe/Ue*b)+f});const bs=()=>!1;class ws{constructor(f){let{startValue:Ve,byValue:Ue,duration:Je=500,delay:Bn=0,easing:Vn=ys,onStart:Nn=C,onChange:Un=C,onComplete:qn=C,abort:qo=bs,target:$o}=f;t(this,"_state","pending"),t(this,"durationProgress",0),t(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=Je,this.delay=Bn,this.easing=Vn,this._onStart=Nn,this._onChange=Un,this._onComplete=qn,this._abort=qo,this.target=$o,this.startValue=Ve,this.byValue=Ue,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const f=Ve=>{this._state==="pending"&&(this.startTime=Ve||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>ut(f),this.delay):ut(f)}tick(f){const Ve=(f||+new Date)-this.startTime,Ue=Math.min(Ve,this.duration);this.durationProgress=Ue/this.duration;const{value:Je,valueProgress:Bn}=this.calculate(Ue);this.value=Object.freeze(Je),this.valueProgress=Bn,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):Ve>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),ut(this.tick)))}register(){et.push(this)}unregister(){et.remove(this)}abort(){this._state="aborted",this.unregister()}}const Ss=["startValue","endValue"];class Ts extends ws{constructor(f){let{startValue:Ve=0,endValue:Ue=100}=f;super(s(s({},i(f,Ss)),{},{startValue:Ve,byValue:Ue-Ve}))}calculate(f){const Ve=this.easing(f,this.startValue,this.byValue,this.duration);return{value:Ve,valueProgress:Math.abs((Ve-this.startValue)/this.byValue)}}}const Os=["startValue","endValue"];class ks extends ws{constructor(f){let{startValue:Ve=[0],endValue:Ue=[100]}=f;super(s(s({},i(f,Os)),{},{startValue:Ve,byValue:Ue.map((Je,Bn)=>Je-Ve[Bn])}))}calculate(f){const Ve=this.startValue.map((Ue,Je)=>this.easing(f,Ue,this.byValue[Je],this.duration,Je));return{value:Ve,valueProgress:Math.abs((Ve[0]-this.startValue[0])/this.byValue[0])}}}const Ds=["startValue","endValue","easing","onChange","onComplete","abort"],Ms=(qe,f,Ve,Ue)=>f+Ve*(1-Math.cos(qe/Ue*b)),Ps=qe=>qe&&((f,Ve,Ue)=>qe(new Ut(f).toRgba(),Ve,Ue));class Es extends ws{constructor(f){let{startValue:Ve,endValue:Ue,easing:Je=Ms,onChange:Bn,onComplete:Vn,abort:Nn}=f,Un=i(f,Ds);const qn=new Ut(Ve).getSource(),qo=new Ut(Ue).getSource();super(s(s({},Un),{},{startValue:qn,byValue:qo.map(($o,Zo)=>$o-qn[Zo]),easing:Je,onChange:Ps(Bn),onComplete:Ps(Vn),abort:Ps(Nn)}))}calculate(f){const[Ve,Ue,Je,Bn]=this.startValue.map((Nn,Un)=>this.easing(f,Nn,this.byValue[Un],this.duration,Un)),Vn=[...[Ve,Ue,Je].map(Math.round),ds(0,Bn,1)];return{value:Vn,valueProgress:Vn.map((Nn,Un)=>this.byValue[Un]!==0?Math.abs((Nn-this.startValue[Un])/this.byValue[Un]):0).find(Nn=>Nn!==0)||0}}}function As(qe){const f=(Ve=>Array.isArray(Ve.startValue)||Array.isArray(Ve.endValue))(qe)?new ks(qe):new Ts(qe);return f.start(),f}function js(qe){const f=new Es(qe);return f.start(),f}class Fs{constructor(f){this.status=f,this.points=[]}includes(f){return this.points.some(Ve=>Ve.eq(f))}append(){for(var f=arguments.length,Ve=new Array(f),Ue=0;Ue<f;Ue++)Ve[Ue]=arguments[Ue];return this.points=this.points.concat(Ve.filter(Je=>!this.includes(Je))),this}static isPointContained(f,Ve,Ue){let Je=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(Ve.eq(Ue))return f.eq(Ve);if(Ve.x===Ue.x)return f.x===Ve.x&&(Je||f.y>=Math.min(Ve.y,Ue.y)&&f.y<=Math.max(Ve.y,Ue.y));if(Ve.y===Ue.y)return f.y===Ve.y&&(Je||f.x>=Math.min(Ve.x,Ue.x)&&f.x<=Math.max(Ve.x,Ue.x));{const Bn=ts(Ve,Ue),Vn=ts(Ve,f).divide(Bn);return Je?Math.abs(Vn.x)===Math.abs(Vn.y):Vn.x===Vn.y&&Vn.x>=0&&Vn.x<=1}}static isPointInPolygon(f,Ve){const Ue=new ot(f).setX(Math.min(f.x-1,...Ve.map(Bn=>Bn.x)));let Je=0;for(let Bn=0;Bn<Ve.length;Bn++){const Vn=this.intersectSegmentSegment(Ve[Bn],Ve[(Bn+1)%Ve.length],f,Ue);if(Vn.includes(f))return!0;Je+=+(Vn.status==="Intersection")}return Je%2==1}static intersectLineLine(f,Ve,Ue,Je){let Bn=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],Vn=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const Nn=Ve.x-f.x,Un=Ve.y-f.y,qn=Je.x-Ue.x,qo=Je.y-Ue.y,$o=f.x-Ue.x,Zo=f.y-Ue.y,ta=qn*Zo-qo*$o,ea=Nn*Zo-Un*$o,ra=qo*Nn-qn*Un;if(ra!==0){const na=ta/ra,oa=ea/ra;return(Bn||0<=na&&na<=1)&&(Vn||0<=oa&&oa<=1)?new Fs("Intersection").append(new ot(f.x+na*Nn,f.y+na*Un)):new Fs}if(ta===0||ea===0){const na=Bn||Vn||Fs.isPointContained(f,Ue,Je)||Fs.isPointContained(Ve,Ue,Je)||Fs.isPointContained(Ue,f,Ve)||Fs.isPointContained(Je,f,Ve);return new Fs(na?"Coincident":void 0)}return new Fs("Parallel")}static intersectSegmentLine(f,Ve,Ue,Je){return Fs.intersectLineLine(f,Ve,Ue,Je,!1,!0)}static intersectSegmentSegment(f,Ve,Ue,Je){return Fs.intersectLineLine(f,Ve,Ue,Je,!1,!1)}static intersectLinePolygon(f,Ve,Ue){let Je=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const Bn=new Fs,Vn=Ue.length;for(let Nn,Un,qn,qo=0;qo<Vn;qo++){if(Nn=Ue[qo],Un=Ue[(qo+1)%Vn],qn=Fs.intersectLineLine(f,Ve,Nn,Un,Je,!1),qn.status==="Coincident")return qn;Bn.append(...qn.points)}return Bn.points.length>0&&(Bn.status="Intersection"),Bn}static intersectSegmentPolygon(f,Ve,Ue){return Fs.intersectLinePolygon(f,Ve,Ue,!1)}static intersectPolygonPolygon(f,Ve){const Ue=new Fs,Je=f.length,Bn=[];for(let Vn=0;Vn<Je;Vn++){const Nn=f[Vn],Un=f[(Vn+1)%Je],qn=Fs.intersectSegmentPolygon(Nn,Un,Ve);qn.status==="Coincident"?(Bn.push(qn),Ue.append(Nn,Un)):Ue.append(...qn.points)}return Bn.length>0&&Bn.length===f.length?new Fs("Coincident"):(Ue.points.length>0&&(Ue.status="Intersection"),Ue)}static intersectPolygonRectangle(f,Ve,Ue){const Je=Ve.min(Ue),Bn=Ve.max(Ue),Vn=new ot(Bn.x,Je.y),Nn=new ot(Je.x,Bn.y);return Fs.intersectPolygonPolygon(f,[Je,Vn,Bn,Nn])}}class Ls extends lt{getX(){return this.getXY().x}setX(f){this.setXY(this.getXY().setX(f))}getY(){return this.getXY().y}setY(f){this.setXY(this.getXY().setY(f))}getRelativeX(){return this.left}setRelativeX(f){this.left=f}getRelativeY(){return this.top}setRelativeY(f){this.top=f}getXY(){const f=this.getRelativeXY();return this.group?bt(f,this.group.calcTransformMatrix()):f}setXY(f,Ve,Ue){this.group&&(f=bt(f,wt(this.group.calcTransformMatrix()))),this.setRelativeXY(f,Ve,Ue)}getRelativeXY(){return new ot(this.left,this.top)}setRelativeXY(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(f,Ve,Ue)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:f,tr:Ve,br:Ue,bl:Je}=this.aCoords||(this.aCoords=this.calcACoords()),Bn=[f,Ve,Ue,Je];if(this.group){const Vn=this.group.calcTransformMatrix();return Bn.map(Nn=>bt(Nn,Vn))}return Bn}intersectsWithRect(f,Ve){return Fs.intersectPolygonRectangle(this.getCoords(),f,Ve).status==="Intersection"}intersectsWithObject(f){const Ve=Fs.intersectPolygonPolygon(this.getCoords(),f.getCoords());return Ve.status==="Intersection"||Ve.status==="Coincident"||f.isContainedWithinObject(this)||this.isContainedWithinObject(f)}isContainedWithinObject(f){return this.getCoords().every(Ve=>f.containsPoint(Ve))}isContainedWithinRect(f,Ve){const{left:Ue,top:Je,width:Bn,height:Vn}=this.getBoundingRect();return Ue>=f.x&&Ue+Bn<=Ve.x&&Je>=f.y&&Je+Vn<=Ve.y}isOverlapping(f){return this.intersectsWithObject(f)||this.isContainedWithinObject(f)||f.isContainedWithinObject(this)}containsPoint(f){return Fs.isPointInPolygon(f,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:f,br:Ve}=this.canvas.vptCoords;return!!this.getCoords().some(Ue=>Ue.x<=Ve.x&&Ue.x>=f.x&&Ue.y<=Ve.y&&Ue.y>=f.y)||!!this.intersectsWithRect(f,Ve)||this.containsPoint(f.midPointFrom(Ve))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:f,br:Ve}=this.canvas.vptCoords;return this.intersectsWithRect(f,Ve)?!0:this.getCoords().every(Ue=>(Ue.x>=Ve.x||Ue.x<=f.x)&&(Ue.y>=Ve.y||Ue.y<=f.y))&&this.containsPoint(f.midPointFrom(Ve))}getBoundingRect(){return me(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(f){this._set(G,f),this._set(N,f),this.setCoords()}scaleToWidth(f){const Ve=this.getBoundingRect().width/this.getScaledWidth();return this.scale(f/this.width/Ve)}scaleToHeight(f){const Ve=this.getBoundingRect().height/this.getScaledHeight();return this.scale(f/this.height/Ve)}getCanvasRetinaScaling(){var f;return((f=this.canvas)===null||f===void 0?void 0:f.getRetinaScaling())||1}getTotalAngle(){return this.group?xt(Ot(this.calcTransformMatrix())):this.angle}getViewportTransform(){var f;return((f=this.canvas)===null||f===void 0?void 0:f.viewportTransform)||T.concat()}calcACoords(){const f=Mt({angle:this.angle}),{x:Ve,y:Ue}=this.getRelativeCenterPoint(),Je=Dt(Ve,Ue),Bn=St(Je,f),Vn=this._getTransformedDimensions(),Nn=Vn.x/2,Un=Vn.y/2;return{tl:bt({x:-Nn,y:-Un},Bn),tr:bt({x:Nn,y:-Un},Bn),bl:bt({x:-Nn,y:Un},Bn),br:bt({x:Nn,y:Un},Bn)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let f=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Ve=[];return!f&&this.group&&(Ve=this.group.transformMatrixKey(f)),Ve.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Me(this.originX),Me(this.originY)),Ve}calcTransformMatrix(){let f=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Ve=this.calcOwnMatrix();if(f||!this.group)return Ve;const Ue=this.transformMatrixKey(f),Je=this.matrixCache;return Je&&Je.key.every((Bn,Vn)=>Bn===Ue[Vn])?Je.value:(this.group&&(Ve=St(this.group.calcTransformMatrix(!1),Ve)),this.matrixCache={key:Ue,value:Ve},Ve)}calcOwnMatrix(){const f=this.transformMatrixKey(!0),Ve=this.ownMatrixCache;if(Ve&&Ve.key===f)return Ve.value;const Ue=this.getRelativeCenterPoint(),Je={angle:this.angle,translateX:Ue.x,translateY:Ue.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},Bn=Lt(Je);return this.ownMatrixCache={key:f,value:Bn},Bn}_getNonTransformedDimensions(){return new ot(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(f){return this._getTransformedDimensions(f).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const Ve=s({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},f),Ue=Ve.strokeWidth;let Je=Ue,Bn=0;this.strokeUniform&&(Je=0,Bn=Ue);const Vn=Ve.width+Je,Nn=Ve.height+Je;let Un;return Un=Ve.skewX===0&&Ve.skewY===0?new ot(Vn*Ve.scaleX,Nn*Ve.scaleY):be(Vn,Nn,Ft(Ve)),Un.scalarAdd(Bn)}translateToGivenOrigin(f,Ve,Ue,Je,Bn){let Vn=f.x,Nn=f.y;const Un=Me(Je)-Me(Ve),qn=Me(Bn)-Me(Ue);if(Un||qn){const qo=this._getTransformedDimensions();Vn+=Un*qo.x,Nn+=qn*qo.y}return new ot(Vn,Nn)}translateToCenterPoint(f,Ve,Ue){if(Ve===D&&Ue===D)return f;const Je=this.translateToGivenOrigin(f,Ve,Ue,D,D);return this.angle?Je.rotate(_t(this.angle),f):Je}translateToOriginPoint(f,Ve,Ue){const Je=this.translateToGivenOrigin(f,D,D,Ve,Ue);return this.angle?Je.rotate(_t(this.angle),f):Je}getCenterPoint(){const f=this.getRelativeCenterPoint();return this.group?bt(f,this.group.calcTransformMatrix()):f}getRelativeCenterPoint(){return this.translateToCenterPoint(new ot(this.left,this.top),this.originX,this.originY)}getPointByOrigin(f,Ve){return this.translateToOriginPoint(this.getRelativeCenterPoint(),f,Ve)}setPositionByOrigin(f,Ve,Ue){const Je=this.translateToCenterPoint(f,Ve,Ue),Bn=this.translateToOriginPoint(Je,this.originX,this.originY);this.set({left:Bn.x,top:Bn.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),M,P)}}const Rs=["type"],Is=["extraParam"];let Bs=class wc extends Ls{static getDefaults(){return wc.ownDefaults}get type(){const f=this.constructor.type;return f==="FabricObject"?"object":f.toLowerCase()}set type(f){a("warn","Setting type has no effect",f)}constructor(f){super(),t(this,"_cacheContext",null),Object.assign(this,wc.ownDefaults),this.setOptions(f)}_createCacheCanvas(){this._cacheCanvas=pt(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(f){const Ve=f.width,Ue=f.height,Je=o.maxCacheSideLimit,Bn=o.minCacheSideLimit;if(Ve<=Je&&Ue<=Je&&Ve*Ue<=o.perfLimitSizeTotal)return Ve<Bn&&(f.width=Bn),Ue<Bn&&(f.height=Bn),f;const Vn=Ve/Ue,[Nn,Un]=_.limitDimsByArea(Vn),qn=ds(Bn,Nn,Je),qo=ds(Bn,Un,Je);return Ve>qn&&(f.zoomX/=Ve/qn,f.width=qn,f.capped=!0),Ue>qo&&(f.zoomY/=Ue/qo,f.height=qo,f.capped=!0),f}_getCacheCanvasDimensions(){const f=this.getTotalObjectScaling(),Ve=this._getTransformedDimensions({skewX:0,skewY:0}),Ue=Ve.x*f.x/this.scaleX,Je=Ve.y*f.y/this.scaleY;return{width:Math.ceil(Ue+2),height:Math.ceil(Je+2),zoomX:f.x,zoomY:f.y,x:Ue,y:Je}}_updateCacheCanvas(){const f=this._cacheCanvas,Ve=this._cacheContext,{width:Ue,height:Je,zoomX:Bn,zoomY:Vn,x:Nn,y:Un}=this._limitCacheSize(this._getCacheCanvasDimensions()),qn=Ue!==f.width||Je!==f.height,qo=this.zoomX!==Bn||this.zoomY!==Vn;if(!f||!Ve)return!1;if(qn||qo){Ue!==f.width||Je!==f.height?(f.width=Ue,f.height=Je):(Ve.setTransform(1,0,0,1,0,0),Ve.clearRect(0,0,f.width,f.height));const $o=Nn/2,Zo=Un/2;return this.cacheTranslationX=Math.round(f.width/2-$o)+$o,this.cacheTranslationY=Math.round(f.height/2-Zo)+Zo,Ve.translate(this.cacheTranslationX,this.cacheTranslationY),Ve.scale(Bn,Vn),this.zoomX=Bn,this.zoomY=Vn,!0}return!1}setOptions(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(f)}transform(f){const Ve=this.group&&!this.group._transformDone||this.group&&this.canvas&&f===this.canvas.contextTop,Ue=this.calcTransformMatrix(!Ve);f.transform(Ue[0],Ue[1],Ue[2],Ue[3],Ue[4],Ue[5])}getObjectScaling(){if(!this.group)return new ot(Math.abs(this.scaleX),Math.abs(this.scaleY));const f=kt(this.calcTransformMatrix());return new ot(Math.abs(f.scaleX),Math.abs(f.scaleY))}getTotalObjectScaling(){const f=this.getObjectScaling();if(this.canvas){const Ve=this.canvas.getZoom(),Ue=this.getCanvasRetinaScaling();return f.scalarMultiply(Ve*Ue)}return f}getObjectOpacity(){let f=this.opacity;return this.group&&(f*=this.group.getObjectOpacity()),f}_constrainScale(f){return Math.abs(f)<this.minScaleLimit?f<0?-this.minScaleLimit:this.minScaleLimit:f===0?1e-4:f}_set(f,Ve){f!==G&&f!==N||(Ve=this._constrainScale(Ve)),f===G&&Ve<0?(this.flipX=!this.flipX,Ve*=-1):f==="scaleY"&&Ve<0?(this.flipY=!this.flipY,Ve*=-1):f!=="shadow"||!Ve||Ve instanceof us||(Ve=new us(Ve));const Ue=this[f]!==Ve;return this[f]=Ve,Ue&&this.constructor.cacheProperties.includes(f)&&(this.dirty=!0),this.parent&&(this.dirty||Ue&&this.constructor.stateProperties.includes(f))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(f){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(f.save(),this._setupCompositeOperation(f),this.drawSelectionBackground(f),this.transform(f),this._setOpacity(f),this._setShadow(f),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(f)):(this._removeCacheCanvas(),this.drawObject(f,!1,{}),this.dirty=!1),f.restore())}drawSelectionBackground(f){}renderCache(f){if(f=f||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:Ve,zoomY:Ue,cacheTranslationX:Je,cacheTranslationY:Bn}=this,{width:Vn,height:Nn}=this._cacheCanvas;this.drawObject(this._cacheContext,f.forClipping,{zoomX:Ve,zoomY:Ue,cacheTranslationX:Je,cacheTranslationY:Bn,width:Vn,height:Nn,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===J&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.parent||!this.parent.isOnACache()),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(f,Ve,Ue){f.save(),Ve.inverted?f.globalCompositeOperation="destination-out":f.globalCompositeOperation="destination-in",f.setTransform(1,0,0,1,0,0),f.drawImage(Ue,0,0),f.restore()}drawObject(f,Ve,Ue){const Je=this.fill,Bn=this.stroke;Ve?(this.fill="black",this.stroke="",this._setClippingProperties(f)):this._renderBackground(f),this._render(f),this._drawClipPath(f,this.clipPath,Ue),this.fill=Je,this.stroke=Bn}createClipPathLayer(f,Ve){const Ue=vt(Ve),Je=Ue.getContext("2d");if(Je.translate(Ve.cacheTranslationX,Ve.cacheTranslationY),Je.scale(Ve.zoomX,Ve.zoomY),f._cacheCanvas=Ue,Ve.parentClipPaths.forEach(Bn=>{Bn.transform(Je)}),Ve.parentClipPaths.push(f),f.absolutePositioned){const Bn=wt(this.calcTransformMatrix());Je.transform(Bn[0],Bn[1],Bn[2],Bn[3],Bn[4],Bn[5])}return f.transform(Je),f.drawObject(Je,!0,Ve),Ue}_drawClipPath(f,Ve,Ue){if(!Ve)return;Ve._transformDone=!0;const Je=this.createClipPathLayer(Ve,Ue);this.drawClipPathOnCache(f,Ve,Je)}drawCacheOnCanvas(f){f.scale(1/this.zoomX,1/this.zoomY),f.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let f=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const Ve=this._cacheCanvas,Ue=this._cacheContext;return!(!Ve||!Ue||f||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(Ve&&Ue&&!f&&(Ue.save(),Ue.setTransform(1,0,0,1,0,0),Ue.clearRect(0,0,Ve.width,Ve.height),Ue.restore()),!0)}_renderBackground(f){if(!this.backgroundColor)return;const Ve=this._getNonTransformedDimensions();f.fillStyle=this.backgroundColor,f.fillRect(-Ve.x/2,-Ve.y/2,Ve.x,Ve.y),this._removeShadow(f)}_setOpacity(f){this.group&&!this.group._transformDone?f.globalAlpha=this.getObjectOpacity():f.globalAlpha*=this.opacity}_setStrokeStyles(f,Ve){const Ue=Ve.stroke;Ue&&(f.lineWidth=Ve.strokeWidth,f.lineCap=Ve.strokeLineCap,f.lineDashOffset=Ve.strokeDashOffset,f.lineJoin=Ve.strokeLineJoin,f.miterLimit=Ve.strokeMiterLimit,$t(Ue)?Ue.gradientUnits==="percentage"||Ue.gradientTransform||Ue.patternTransform?this._applyPatternForTransformedGradient(f,Ue):(f.strokeStyle=Ue.toLive(f),this._applyPatternGradientTransform(f,Ue)):f.strokeStyle=Ve.stroke)}_setFillStyles(f,Ve){let{fill:Ue}=Ve;Ue&&($t(Ue)?(f.fillStyle=Ue.toLive(f),this._applyPatternGradientTransform(f,Ue)):f.fillStyle=Ue)}_setClippingProperties(f){f.globalAlpha=1,f.strokeStyle="transparent",f.fillStyle="#000000"}_setLineDash(f,Ve){Ve&&Ve.length!==0&&f.setLineDash(Ve)}_setShadow(f){if(!this.shadow)return;const Ve=this.shadow,Ue=this.canvas,Je=this.getCanvasRetinaScaling(),[Bn,,,Vn]=(Ue==null?void 0:Ue.viewportTransform)||T,Nn=Bn*Je,Un=Vn*Je,qn=Ve.nonScaling?new ot(1,1):this.getObjectScaling();f.shadowColor=Ve.color,f.shadowBlur=Ve.blur*o.browserShadowBlurConstant*(Nn+Un)*(qn.x+qn.y)/4,f.shadowOffsetX=Ve.offsetX*Nn*qn.x,f.shadowOffsetY=Ve.offsetY*Un*qn.y}_removeShadow(f){this.shadow&&(f.shadowColor="",f.shadowBlur=f.shadowOffsetX=f.shadowOffsetY=0)}_applyPatternGradientTransform(f,Ve){if(!$t(Ve))return{offsetX:0,offsetY:0};const Ue=Ve.gradientTransform||Ve.patternTransform,Je=-this.width/2+Ve.offsetX||0,Bn=-this.height/2+Ve.offsetY||0;return Ve.gradientUnits==="percentage"?f.transform(this.width,0,0,this.height,Je,Bn):f.transform(1,0,0,1,Je,Bn),Ue&&f.transform(Ue[0],Ue[1],Ue[2],Ue[3],Ue[4],Ue[5]),{offsetX:Je,offsetY:Bn}}_renderPaintInOrder(f){this.paintFirst===J?(this._renderStroke(f),this._renderFill(f)):(this._renderFill(f),this._renderStroke(f))}_render(f){}_renderFill(f){this.fill&&(f.save(),this._setFillStyles(f,this),this.fillRule==="evenodd"?f.fill("evenodd"):f.fill(),f.restore())}_renderStroke(f){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this.strokeUniform){const Ve=this.getObjectScaling();f.scale(1/Ve.x,1/Ve.y)}this._setLineDash(f,this.strokeDashArray),this._setStrokeStyles(f,this),f.stroke(),f.restore()}}_applyPatternForTransformedGradient(f,Ve){var Ue;const Je=this._limitCacheSize(this._getCacheCanvasDimensions()),Bn=this.getCanvasRetinaScaling(),Vn=Je.x/this.scaleX/Bn,Nn=Je.y/this.scaleY/Bn,Un=vt({width:Math.ceil(Vn),height:Math.ceil(Nn)}),qn=Un.getContext("2d");qn&&(qn.beginPath(),qn.moveTo(0,0),qn.lineTo(Vn,0),qn.lineTo(Vn,Nn),qn.lineTo(0,Nn),qn.closePath(),qn.translate(Vn/2,Nn/2),qn.scale(Je.zoomX/this.scaleX/Bn,Je.zoomY/this.scaleY/Bn),this._applyPatternGradientTransform(qn,Ve),qn.fillStyle=Ve.toLive(f),qn.fill(),f.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),f.scale(Bn*this.scaleX/Je.zoomX,Bn*this.scaleY/Je.zoomY),f.strokeStyle=(Ue=qn.createPattern(Un,"no-repeat"))!==null&&Ue!==void 0?Ue:"")}_findCenterFromElement(){return new ot(this.left+this.width/2,this.top+this.height/2)}clone(f){const Ve=this.toObject(f);return this.constructor.fromObject(Ve)}cloneAsImage(f){const Ve=this.toCanvasElement(f);return new(tt.getClass("image"))(Ve)}toCanvasElement(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const Ve=Ce(this),Ue=this.group,Je=this.shadow,Bn=Math.abs,Vn=f.enableRetinaScaling?y():1,Nn=(f.multiplier||1)*Vn,Un=f.canvasProvider||(ca=>new ue(ca,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,f.withoutTransform&&xe(this),f.withoutShadow&&(this.shadow=null),f.viewportTransform&&Oe(this,this.getViewportTransform()),this.setCoords();const qn=pt(),qo=this.getBoundingRect(),$o=this.shadow,Zo=new ot;if($o){const ca=$o.blur,pa=$o.nonScaling?new ot(1,1):this.getObjectScaling();Zo.x=2*Math.round(Bn($o.offsetX)+ca)*Bn(pa.x),Zo.y=2*Math.round(Bn($o.offsetY)+ca)*Bn(pa.y)}const ta=qo.width+Zo.x,ea=qo.height+Zo.y;qn.width=Math.ceil(ta),qn.height=Math.ceil(ea);const ra=Un(qn);f.format==="jpeg"&&(ra.backgroundColor="#fff"),this.setPositionByOrigin(new ot(ra.width/2,ra.height/2),D,D);const na=this.canvas;ra._objects=[this],this.set("canvas",ra),this.setCoords();const oa=ra.toCanvasElement(Nn||1,f);return this.set("canvas",na),this.shadow=Je,Ue&&(this.group=Ue),this.set(Ve),this.setCoords(),ra._objects=[],ra.destroy(),oa}toDataURL(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yt(this.toCanvasElement(f),f.format||"png",f.quality||1)}isType(){for(var f=arguments.length,Ve=new Array(f),Ue=0;Ue<f;Ue++)Ve[Ue]=arguments[Ue];return Ve.includes(this.constructor.type)||Ve.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(f){const{centeredRotation:Ve,originX:Ue,originY:Je}=this;if(Ve){const{x:Bn,y:Vn}=this.getRelativeCenterPoint();this.originX=D,this.originY=D,this.left=Bn,this.top=Vn}if(this.set("angle",f),Ve){const{x:Bn,y:Vn}=this.translateToOriginPoint(this.getRelativeCenterPoint(),Ue,Je);this.left=Bn,this.top=Vn,this.originX=Ue,this.originY=Je}}setOnGroup(){}_setupCompositeOperation(f){this.globalCompositeOperation&&(f.globalCompositeOperation=this.globalCompositeOperation)}dispose(){et.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&p().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(f,Ve){return Object.entries(f).reduce((Ue,Je)=>{let[Bn,Vn]=Je;return Ue[Bn]=this._animate(Bn,Vn,Ve),Ue},{})}_animate(f,Ve){let Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const Je=f.split("."),Bn=this.constructor.colorProperties.includes(Je[Je.length-1]),{abort:Vn,startValue:Nn,onChange:Un,onComplete:qn}=Ue,qo=s(s({},Ue),{},{target:this,startValue:Nn??Je.reduce(($o,Zo)=>$o[Zo],this),endValue:Ve,abort:Vn==null?void 0:Vn.bind(this),onChange:($o,Zo,ta)=>{Je.reduce((ea,ra,na)=>(na===Je.length-1&&(ea[ra]=$o),ea[ra]),this),Un&&Un($o,Zo,ta)},onComplete:($o,Zo,ta)=>{this.setCoords(),qn&&qn($o,Zo,ta)}});return Bn?js(qo):As(qo)}isDescendantOf(f){const{parent:Ve,group:Ue}=this;return Ve===f||Ue===f||!!Ve&&Ve.isDescendantOf(f)||!!Ue&&Ue!==Ve&&Ue.isDescendantOf(f)}getAncestors(){const f=[];let Ve=this;do Ve=Ve.parent,Ve&&f.push(Ve);while(Ve);return f}findCommonAncestors(f){if(this===f)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const Ve=this.getAncestors(),Ue=f.getAncestors();if(Ve.length===0&&Ue.length>0&&this===Ue[Ue.length-1])return{fork:[],otherFork:[f,...Ue.slice(0,Ue.length-1)],common:[this]};for(let Je,Bn=0;Bn<Ve.length;Bn++){if(Je=Ve[Bn],Je===f)return{fork:[this,...Ve.slice(0,Bn)],otherFork:[],common:Ve.slice(Bn)};for(let Vn=0;Vn<Ue.length;Vn++){if(this===Ue[Vn])return{fork:[],otherFork:[f,...Ue.slice(0,Vn)],common:[this,...Ve]};if(Je===Ue[Vn])return{fork:[this,...Ve.slice(0,Bn)],otherFork:[f,...Ue.slice(0,Vn)],common:Ve.slice(Bn)}}}return{fork:[this,...Ve],otherFork:[f,...Ue],common:[]}}hasCommonAncestors(f){const Ve=this.findCommonAncestors(f);return Ve&&!!Ve.common.length}isInFrontOf(f){if(this===f)return;const Ve=this.findCommonAncestors(f);if(Ve.fork.includes(f))return!0;if(Ve.otherFork.includes(this))return!1;const Ue=Ve.common[0]||this.canvas;if(!Ue)return;const Je=Ve.fork.pop(),Bn=Ve.otherFork.pop(),Vn=Ue._objects.indexOf(Je),Nn=Ue._objects.indexOf(Bn);return Vn>-1&&Vn>Nn}toObject(){const f=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(wc.customProperties,this.constructor.customProperties||[]);let Ve;const Ue=o.NUM_FRACTION_DIGITS,{clipPath:Je,fill:Bn,stroke:Vn,shadow:Nn,strokeDashArray:Un,left:qn,top:qo,originX:$o,originY:Zo,width:ta,height:ea,strokeWidth:ra,strokeLineCap:na,strokeDashOffset:oa,strokeLineJoin:ca,strokeUniform:pa,strokeMiterLimit:la,scaleX:ma,scaleY:Ca,angle:Sa,flipX:ga,flipY:ba,opacity:Ha,visible:Ja,backgroundColor:tc,fillRule:Ua,paintFirst:sc,globalCompositeOperation:ic,skewX:Ka,skewY:Na}=this;Je&&!Je.excludeFromExport&&(Ve=Je.toObject(f.concat("inverted","absolutePositioned")));const Ta=oc=>qt(oc,Ue),nc=s(s({},Xt(this,f)),{},{type:this.constructor.type,version:x,originX:$o,originY:Zo,left:Ta(qn),top:Ta(qo),width:Ta(ta),height:Ta(ea),fill:te(Bn)?Bn.toObject():Bn,stroke:te(Vn)?Vn.toObject():Vn,strokeWidth:Ta(ra),strokeDashArray:Un&&Un.concat(),strokeLineCap:na,strokeDashOffset:oa,strokeLineJoin:ca,strokeUniform:pa,strokeMiterLimit:Ta(la),scaleX:Ta(ma),scaleY:Ta(Ca),angle:Ta(Sa),flipX:ga,flipY:ba,opacity:Ta(Ha),shadow:Nn&&Nn.toObject(),visible:Ja,backgroundColor:tc,fillRule:Ua,paintFirst:sc,globalCompositeOperation:ic,skewX:Ta(Ka),skewY:Ta(Na)},Ve?{clipPath:Ve}:null);return this.includeDefaultValues?nc:this._removeDefaultValues(nc)}toDatalessObject(f){return this.toObject(f)}_removeDefaultValues(f){const Ve=this.constructor.getDefaults(),Ue=Object.keys(Ve).length>0?Ve:Object.getPrototypeOf(this);return Yt(f,(Je,Bn)=>{if(Bn===M||Bn===P||Bn==="type")return!0;const Vn=Ue[Bn];return Je!==Vn&&!(Array.isArray(Je)&&Array.isArray(Vn)&&Je.length===0&&Vn.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(f){let Ve=i(f,Rs),Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:Je}=Ue,Bn=i(Ue,Is);return Bt(Ve,Bn).then(Vn=>Je?(delete Vn[Je],new this(Ve[Je],Vn)):new this(Vn))}static fromObject(f,Ve){return this._fromObject(f,Ve)}};t(Bs,"stateProperties",gs),t(Bs,"cacheProperties",fs),t(Bs,"ownDefaults",ps),t(Bs,"type","FabricObject"),t(Bs,"colorProperties",[K,J,"backgroundColor"]),t(Bs,"customProperties",[]),tt.setClass(Bs),tt.setClass(Bs,"object");const Xs=(qe,f,Ve)=>(Ue,Je,Bn,Vn)=>{const Nn=f(Ue,Je,Bn,Vn);return Nn&&ke(qe,s(s({},Fe(Ue,Je,Bn,Vn)),Ve)),Nn};function Ys(qe){return(f,Ve,Ue,Je)=>{const{target:Bn,originX:Vn,originY:Nn}=Ve,Un=Bn.getRelativeCenterPoint(),qn=Bn.translateToOriginPoint(Un,Vn,Nn),qo=qe(f,Ve,Ue,Je);return Bn.setPositionByOrigin(qn,Ve.originX,Ve.originY),qo}}const Ws=Xs(Y,Ys((qe,f,Ve,Ue)=>{const Je=Re(f,f.originX,f.originY,Ve,Ue);if(Me(f.originX)===Me(D)||Me(f.originX)===Me(A)&&Je.x<0||Me(f.originX)===Me(M)&&Je.x>0){const{target:Bn}=f,Vn=Bn.strokeWidth/(Bn.strokeUniform?Bn.scaleX:1),Nn=Ee(f)?2:1,Un=Bn.width,qn=Math.abs(Je.x*Nn/Bn.scaleX)-Vn;return Bn.set("width",Math.max(qn,1)),Un!==Bn.width}return!1}));function Vs(qe,f,Ve,Ue,Je){Ue=Ue||{};const Bn=this.sizeX||Ue.cornerSize||Je.cornerSize,Vn=this.sizeY||Ue.cornerSize||Je.cornerSize,Nn=Ue.transparentCorners!==void 0?Ue.transparentCorners:Je.transparentCorners,Un=Nn?J:K,qn=!Nn&&(Ue.cornerStrokeColor||Je.cornerStrokeColor);let qo,$o=f,Zo=Ve;qe.save(),qe.fillStyle=Ue.cornerColor||Je.cornerColor||"",qe.strokeStyle=Ue.cornerStrokeColor||Je.cornerStrokeColor||"",Bn>Vn?(qo=Bn,qe.scale(1,Vn/Bn),Zo=Ve*Bn/Vn):Vn>Bn?(qo=Vn,qe.scale(Bn/Vn,1),$o=f*Vn/Bn):qo=Bn,qe.beginPath(),qe.arc($o,Zo,qo/2,0,w,!1),qe[Un](),qn&&qe.stroke(),qe.restore()}function zs(qe,f,Ve,Ue,Je){Ue=Ue||{};const Bn=this.sizeX||Ue.cornerSize||Je.cornerSize,Vn=this.sizeY||Ue.cornerSize||Je.cornerSize,Nn=Ue.transparentCorners!==void 0?Ue.transparentCorners:Je.transparentCorners,Un=Nn?J:K,qn=!Nn&&(Ue.cornerStrokeColor||Je.cornerStrokeColor),qo=Bn/2,$o=Vn/2;qe.save(),qe.fillStyle=Ue.cornerColor||Je.cornerColor||"",qe.strokeStyle=Ue.cornerStrokeColor||Je.cornerStrokeColor||"",qe.translate(f,Ve);const Zo=Je.getTotalAngle();qe.rotate(_t(Zo)),qe["".concat(Un,"Rect")](-qo,-$o,Bn,Vn),qn&&qe.strokeRect(-qo,-$o,Bn,Vn),qe.restore()}class Hs{constructor(f){t(this,"visible",!0),t(this,"actionName",H),t(this,"angle",0),t(this,"x",0),t(this,"y",0),t(this,"offsetX",0),t(this,"offsetY",0),t(this,"sizeX",0),t(this,"sizeY",0),t(this,"touchSizeX",0),t(this,"touchSizeY",0),t(this,"cursorStyle","crosshair"),t(this,"withConnection",!1),Object.assign(this,f)}shouldActivate(f,Ve,Ue,Je){var Bn;let{tl:Vn,tr:Nn,br:Un,bl:qn}=Je;return((Bn=Ve.canvas)===null||Bn===void 0?void 0:Bn.getActiveObject())===Ve&&Ve.isControlVisible(f)&&Fs.isPointInPolygon(Ue,[Vn,Nn,Un,qn])}getActionHandler(f,Ve,Ue){return this.actionHandler}getMouseDownHandler(f,Ve,Ue){return this.mouseDownHandler}getMouseUpHandler(f,Ve,Ue){return this.mouseUpHandler}cursorStyleHandler(f,Ve,Ue){return Ve.cursorStyle}getActionName(f,Ve,Ue){return Ve.actionName}getVisibility(f,Ve){var Ue,Je;return(Ue=(Je=f._controlsVisibility)===null||Je===void 0?void 0:Je[Ve])!==null&&Ue!==void 0?Ue:this.visible}setVisibility(f,Ve,Ue){this.visible=f}positionHandler(f,Ve,Ue,Je){return new ot(this.x*f.x+this.offsetX,this.y*f.y+this.offsetY).transform(Ve)}calcCornerCoords(f,Ve,Ue,Je,Bn,Vn){const Nn=Tt([Dt(Ue,Je),Mt({angle:f}),Pt((Bn?this.touchSizeX:this.sizeX)||Ve,(Bn?this.touchSizeY:this.sizeY)||Ve)]);return{tl:new ot(-.5,-.5).transform(Nn),tr:new ot(.5,-.5).transform(Nn),br:new ot(.5,.5).transform(Nn),bl:new ot(-.5,.5).transform(Nn)}}render(f,Ve,Ue,Je,Bn){((Je=Je||{}).cornerStyle||Bn.cornerStyle)==="circle"?Vs.call(this,f,Ve,Ue,Je,Bn):zs.call(this,f,Ve,Ue,Je,Bn)}}const Gs=(qe,f,Ve)=>Ve.lockRotation?Pe:f.cursorStyle,Ns=Xs(I,Ys((qe,f,Ve,Ue)=>{let{target:Je,ex:Bn,ey:Vn,theta:Nn,originX:Un,originY:qn}=f;const qo=Je.translateToOriginPoint(Je.getRelativeCenterPoint(),Un,qn);if(je(Je,"lockRotation"))return!1;const $o=Math.atan2(Vn-qo.y,Bn-qo.x),Zo=Math.atan2(Ue-qo.y,Ve-qo.x);let ta=xt(Zo-$o+Nn);if(Je.snapAngle&&Je.snapAngle>0){const ra=Je.snapAngle,na=Je.snapThreshold||ra,oa=Math.ceil(ta/ra)*ra,ca=Math.floor(ta/ra)*ra;Math.abs(ta-ca)<na?ta=ca:Math.abs(ta-oa)<na&&(ta=oa)}ta<0&&(ta=360+ta),ta%=360;const ea=Je.angle!==ta;return Je.angle=ta,ea}));function Us(qe,f){const Ve=f.canvas,Ue=qe[Ve.uniScaleKey];return Ve.uniformScaling&&!Ue||!Ve.uniformScaling&&Ue}function qs(qe,f,Ve){const Ue=je(qe,"lockScalingX"),Je=je(qe,"lockScalingY");if(Ue&&Je||!f&&(Ue||Je)&&Ve||Ue&&f==="x"||Je&&f==="y")return!0;const{width:Bn,height:Vn,strokeWidth:Nn}=qe;return Bn===0&&Nn===0&&f!=="y"||Vn===0&&Nn===0&&f!=="x"}const Ks=["e","se","s","sw","w","nw","n","ne","e"],Js=(qe,f,Ve)=>{const Ue=Us(qe,Ve);if(qs(Ve,f.x!==0&&f.y===0?"x":f.x===0&&f.y!==0?"y":"",Ue))return Pe;const Je=Le(Ve,f);return"".concat(Ks[Je],"-resize")};function Qs(qe,f,Ve,Ue){let Je=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const Bn=f.target,Vn=Je.by,Nn=Us(qe,Bn);let Un,qn,qo,$o,Zo,ta;if(qs(Bn,Vn,Nn))return!1;if(f.gestureScale)qn=f.scaleX*f.gestureScale,qo=f.scaleY*f.gestureScale;else{if(Un=Re(f,f.originX,f.originY,Ve,Ue),Zo=Vn!=="y"?Math.sign(Un.x||f.signX||1):1,ta=Vn!=="x"?Math.sign(Un.y||f.signY||1):1,f.signX||(f.signX=Zo),f.signY||(f.signY=ta),je(Bn,"lockScalingFlip")&&(f.signX!==Zo||f.signY!==ta))return!1;if($o=Bn._getTransformedDimensions(),Nn&&!Vn){const na=Math.abs(Un.x)+Math.abs(Un.y),{original:oa}=f,ca=na/(Math.abs($o.x*oa.scaleX/Bn.scaleX)+Math.abs($o.y*oa.scaleY/Bn.scaleY));qn=oa.scaleX*ca,qo=oa.scaleY*ca}else qn=Math.abs(Un.x*Bn.scaleX/$o.x),qo=Math.abs(Un.y*Bn.scaleY/$o.y);Ee(f)&&(qn*=2,qo*=2),f.signX!==Zo&&Vn!=="y"&&(f.originX=Ae(f.originX),qn*=-1,f.signX=Zo),f.signY!==ta&&Vn!=="x"&&(f.originY=Ae(f.originY),qo*=-1,f.signY=ta)}const ea=Bn.scaleX,ra=Bn.scaleY;return Vn?(Vn==="x"&&Bn.set(G,qn),Vn==="y"&&Bn.set(N,qo)):(!je(Bn,"lockScalingX")&&Bn.set(G,qn),!je(Bn,"lockScalingY")&&Bn.set(N,qo)),ea!==Bn.scaleX||ra!==Bn.scaleY}const Zs=Xs(R,Ys((qe,f,Ve,Ue)=>Qs(qe,f,Ve,Ue))),$s=Xs(R,Ys((qe,f,Ve,Ue)=>Qs(qe,f,Ve,Ue,{by:"x"}))),ti=Xs(R,Ys((qe,f,Ve,Ue)=>Qs(qe,f,Ve,Ue,{by:"y"}))),ei=["target","ex","ey","skewingSide"],si={x:{counterAxis:"y",scale:G,skew:U,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:N,skew:q,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},ii=["ns","nesw","ew","nwse"],ri=(qe,f,Ve)=>{if(f.x!==0&&je(Ve,"lockSkewingY")||f.y!==0&&je(Ve,"lockSkewingX"))return Pe;const Ue=Le(Ve,f)%4;return"".concat(ii[Ue],"-resize")};function ni(qe,f,Ve,Ue,Je){const{target:Bn}=Ve,{counterAxis:Vn,origin:Nn,lockSkewing:Un,skew:qn,flip:qo}=si[qe];if(je(Bn,Un))return!1;const{origin:$o,flip:Zo}=si[Vn],ta=Me(Ve[$o])*(Bn[Zo]?-1:1),ea=-Math.sign(ta)*(Bn[qo]?-1:1),ra=.5*-((Bn[qn]===0&&Re(Ve,D,D,Ue,Je)[qe]>0||Bn[qn]>0?1:-1)*ea)+.5;return Xs(X,Ys((oa,ca,pa,la)=>function(ma,Ca,Sa){let{target:ga,ex:ba,ey:Ha,skewingSide:Ja}=Ca,tc=i(Ca,ei);const{skew:Ua}=si[ma],sc=Sa.subtract(new ot(ba,Ha)).divide(new ot(ga.scaleX,ga.scaleY))[ma],ic=ga[Ua],Ka=tc[Ua],Na=Math.tan(_t(Ka)),Ta=ma==="y"?ga._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:ga._getTransformedDimensions({scaleX:1,scaleY:1}).y,nc=2*sc*Ja/Math.max(Ta,1)+Na,oc=xt(Math.atan(nc));ga.set(Ua,oc);const fc=ic!==ga[Ua];if(fc&&ma==="y"){const{skewX:ac,scaleX:_c}=ga,gc=ga._getTransformedDimensions({skewY:ic}),xc=ga._getTransformedDimensions(),hc=ac!==0?gc.x/xc.x:1;hc!==1&&ga.set(G,hc*_c)}return fc}(qe,ca,new ot(pa,la))))(f,s(s({},Ve),{},{[Nn]:ra,skewingSide:ea}),Ue,Je)}const oi=(qe,f,Ve,Ue)=>ni("x",qe,f,Ve,Ue),ai=(qe,f,Ve,Ue)=>ni("y",qe,f,Ve,Ue);function hi(qe,f){return qe[f.canvas.altActionKey]}const ci=(qe,f,Ve)=>{const Ue=hi(qe,Ve);return f.x===0?Ue?U:N:f.y===0?Ue?q:G:""},li=(qe,f,Ve)=>hi(qe,Ve)?ri(0,f,Ve):Js(qe,f,Ve),ui=(qe,f,Ve,Ue)=>hi(qe,f.target)?ai(qe,f,Ve,Ue):$s(qe,f,Ve,Ue),di=(qe,f,Ve,Ue)=>hi(qe,f.target)?oi(qe,f,Ve,Ue):ti(qe,f,Ve,Ue),gi=()=>({ml:new Hs({x:-.5,y:0,cursorStyleHandler:li,actionHandler:ui,getActionName:ci}),mr:new Hs({x:.5,y:0,cursorStyleHandler:li,actionHandler:ui,getActionName:ci}),mb:new Hs({x:0,y:.5,cursorStyleHandler:li,actionHandler:di,getActionName:ci}),mt:new Hs({x:0,y:-.5,cursorStyleHandler:li,actionHandler:di,getActionName:ci}),tl:new Hs({x:-.5,y:-.5,cursorStyleHandler:Js,actionHandler:Zs}),tr:new Hs({x:.5,y:-.5,cursorStyleHandler:Js,actionHandler:Zs}),bl:new Hs({x:-.5,y:.5,cursorStyleHandler:Js,actionHandler:Zs}),br:new Hs({x:.5,y:.5,cursorStyleHandler:Js,actionHandler:Zs}),mtr:new Hs({x:0,y:-.5,actionHandler:Ns,cursorStyleHandler:Gs,offsetY:-40,withConnection:!0,actionName:B})}),fi=()=>({mr:new Hs({x:.5,y:0,actionHandler:Ws,cursorStyleHandler:li,actionName:Y}),ml:new Hs({x:-.5,y:0,actionHandler:Ws,cursorStyleHandler:li,actionName:Y})}),pi=()=>s(s({},gi()),fi());class mi extends Bs{static getDefaults(){return s(s({},super.getDefaults()),mi.ownDefaults)}constructor(f){super(),Object.assign(this,this.constructor.createControls(),mi.ownDefaults),this.setOptions(f)}static createControls(){return{controls:gi()}}_updateCacheCanvas(){const f=this.canvas;if(this.noScaleCache&&f&&f._currentTransform){const Ve=f._currentTransform,Ue=Ve.target,Je=Ve.action;if(this===Ue&&Je&&Je.startsWith(H))return!1}return super._updateCacheCanvas()}getActiveControl(){const f=this.__corner;return f?{key:f,control:this.controls[f],coord:this.oCoords[f]}:void 0}findControl(f){let Ve=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const Ue=Object.entries(this.oCoords);for(let Je=Ue.length-1;Je>=0;Je--){const[Bn,Vn]=Ue[Je],Nn=this.controls[Bn];if(Nn.shouldActivate(Bn,this,f,Ve?Vn.touchCorner:Vn.corner))return this.__corner=Bn,{key:Bn,control:Nn,coord:this.oCoords[Bn]}}}calcOCoords(){const f=this.getViewportTransform(),Ve=this.getCenterPoint(),Ue=Dt(Ve.x,Ve.y),Je=Mt({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),Bn=St(Ue,Je),Vn=St(f,Bn),Nn=St(Vn,[1/f[0],0,0,1/f[3],0,0]),Un=this.group?kt(this.calcTransformMatrix()):void 0;Un&&(Un.scaleX=Math.abs(Un.scaleX),Un.scaleY=Math.abs(Un.scaleY));const qn=this._calculateCurrentDimensions(Un),qo={};return this.forEachControl(($o,Zo)=>{const ta=$o.positionHandler(qn,Nn,this,$o);qo[Zo]=Object.assign(ta,this._calcCornerCoords($o,ta))}),qo}_calcCornerCoords(f,Ve){const Ue=this.getTotalAngle();return{corner:f.calcCornerCoords(Ue,this.cornerSize,Ve.x,Ve.y,!1,this),touchCorner:f.calcCornerCoords(Ue,this.touchCornerSize,Ve.x,Ve.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(f){for(const Ve in this.controls)f(this.controls[Ve],Ve,this)}drawSelectionBackground(f){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;f.save();const Ve=this.getRelativeCenterPoint(),Ue=this._calculateCurrentDimensions(),Je=this.getViewportTransform();f.translate(Ve.x,Ve.y),f.scale(1/Je[0],1/Je[3]),f.rotate(_t(this.angle)),f.fillStyle=this.selectionBackgroundColor,f.fillRect(-Ue.x/2,-Ue.y/2,Ue.x,Ue.y),f.restore()}strokeBorders(f,Ve){f.strokeRect(-Ve.x/2,-Ve.y/2,Ve.x,Ve.y)}_drawBorders(f,Ve){let Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const Je=s({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},Ue);f.save(),f.strokeStyle=Je.borderColor,this._setLineDash(f,Je.borderDashArray),this.strokeBorders(f,Ve),Je.hasControls&&this.drawControlsConnectingLines(f,Ve),f.restore()}_renderControls(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:Ue,hasControls:Je}=this,Bn=s({hasBorders:Ue,hasControls:Je},Ve),Vn=this.getViewportTransform(),Nn=Bn.hasBorders,Un=Bn.hasControls,qn=St(Vn,this.calcTransformMatrix()),qo=kt(qn);f.save(),f.translate(qo.translateX,qo.translateY),f.lineWidth=this.borderScaleFactor,this.group===this.parent&&(f.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(qo.angle-=180),f.rotate(_t(this.group?qo.angle:this.angle)),Nn&&this.drawBorders(f,qo,Ve),Un&&this.drawControls(f,Ve),f.restore()}drawBorders(f,Ve,Ue){let Je;if(Ue&&Ue.forActiveSelection||this.group){const Bn=be(this.width,this.height,Ft(Ve)),Vn=this.isStrokeAccountedForInDimensions()?at:(this.strokeUniform?new ot().scalarAdd(this.canvas?this.canvas.getZoom():1):new ot(Ve.scaleX,Ve.scaleY)).scalarMultiply(this.strokeWidth);Je=Bn.add(Vn).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else Je=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(f,Je,Ue)}drawControlsConnectingLines(f,Ve){let Ue=!1;f.beginPath(),this.forEachControl((Je,Bn)=>{Je.withConnection&&Je.getVisibility(this,Bn)&&(Ue=!0,f.moveTo(Je.x*Ve.x,Je.y*Ve.y),f.lineTo(Je.x*Ve.x+Je.offsetX,Je.y*Ve.y+Je.offsetY))}),Ue&&f.stroke()}drawControls(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f.save();const Ue=this.getCanvasRetinaScaling(),{cornerStrokeColor:Je,cornerDashArray:Bn,cornerColor:Vn}=this,Nn=s({cornerStrokeColor:Je,cornerDashArray:Bn,cornerColor:Vn},Ve);f.setTransform(Ue,0,0,Ue,0,0),f.strokeStyle=f.fillStyle=Nn.cornerColor,this.transparentCorners||(f.strokeStyle=Nn.cornerStrokeColor),this._setLineDash(f,Nn.cornerDashArray),this.forEachControl((Un,qn)=>{if(Un.getVisibility(this,qn)){const qo=this.oCoords[qn];Un.render(f,qo.x,qo.y,Nn,this)}}),f.restore()}isControlVisible(f){return this.controls[f]&&this.controls[f].getVisibility(this,f)}setControlVisible(f,Ve){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[f]=Ve}setControlsVisibility(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(f).forEach(Ve=>{let[Ue,Je]=Ve;return this.setControlVisible(Ue,Je)})}clearContextTop(f){if(!this.canvas)return;const Ve=this.canvas.contextTop;if(!Ve)return;const Ue=this.canvas.viewportTransform;Ve.save(),Ve.transform(Ue[0],Ue[1],Ue[2],Ue[3],Ue[4],Ue[5]),this.transform(Ve);const Je=this.width+4,Bn=this.height+4;return Ve.clearRect(-Je/2,-Bn/2,Je,Bn),f||Ve.restore(),Ve}onDeselect(f){return!1}onSelect(f){return!1}shouldStartDragging(f){return!1}onDragStart(f){return!1}canDrop(f){return!1}renderDragSourceEffect(f){}renderDropTargetEffect(f){}}function vi(qe,f){return f.forEach(Ve=>{Object.getOwnPropertyNames(Ve.prototype).forEach(Ue=>{Ue!=="constructor"&&Object.defineProperty(qe.prototype,Ue,Object.getOwnPropertyDescriptor(Ve.prototype,Ue)||Object.create(null))})}),qe}t(mi,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class yi extends mi{}vi(yi,[Be]),tt.setClass(yi),tt.setClass(yi,"object");const _i=(qe,f,Ve,Ue)=>{const Je=2*(Ue=Math.round(Ue))+1,{data:Bn}=qe.getImageData(f-Ue,Ve-Ue,Je,Je);for(let Vn=3;Vn<Bn.length;Vn+=4)if(Bn[Vn]>0)return!1;return!0};class xi{constructor(f){this.options=f,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new ot(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new ot(1/this.options.scaleX,1/this.options.scaleY):new ot(1,1)}createSideVector(f,Ve){const Ue=ts(f,Ve);return this.options.strokeUniform?Ue.multiply(this.scale):Ue}projectOrthogonally(f,Ve,Ue){return this.applySkew(f.add(this.calcOrthogonalProjection(f,Ve,Ue)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(f){const Ve=new ot(f);return Ve.y+=Ve.x*Math.tan(_t(this.options.skewY)),Ve.x+=Ve.y*Math.tan(_t(this.options.skewX)),Ve}scaleUnitVector(f,Ve){return f.multiply(this.strokeUniformScalar).scalarMultiply(Ve)}}const Ci=new ot;class bi extends xi{static getOrthogonalRotationFactor(f,Ve){const Ue=Ve?ss(f,Ve):is(f);return Math.abs(Ue)<b?-1:1}constructor(f,Ve,Ue,Je){super(Je),t(this,"AB",void 0),t(this,"AC",void 0),t(this,"alpha",void 0),t(this,"bisector",void 0),this.A=new ot(f),this.B=new ot(Ve),this.C=new ot(Ue),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=ss(this.AB,this.AC),this.bisector=rs($e(this.AB.eq(Ci)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(f,Ve){let Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const Je=this.createSideVector(f,Ve),Bn=ns(Je),Vn=bi.getOrthogonalRotationFactor(Bn,this.bisector);return this.scaleUnitVector(Bn,Ue*Vn)}projectBevel(){const f=[];return(this.alpha%w==0?[this.B]:[this.B,this.C]).forEach(Ve=>{f.push(this.projectOrthogonally(this.A,Ve)),f.push(this.projectOrthogonally(this.A,Ve,-this.strokeProjectionMagnitude))}),f}projectMiter(){const f=[],Ve=Math.abs(this.alpha),Ue=1/Math.sin(Ve/2),Je=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*Ue),Bn=this.options.strokeUniform?es(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return es(Je)/this.strokeProjectionMagnitude<=Bn&&f.push(this.applySkew(this.A.add(Je))),f.push(...this.projectBevel()),f}projectRoundNoSkew(f,Ve){const Ue=[],Je=new ot(bi.getOrthogonalRotationFactor(this.bisector),bi.getOrthogonalRotationFactor(new ot(this.bisector.y,this.bisector.x)));return[new ot(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(Je),new ot(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(Je)].forEach(Bn=>{hs(Bn,f,Ve)&&Ue.push(this.A.add(Bn))}),Ue}projectRoundWithSkew(f,Ve){const Ue=[],{skewX:Je,skewY:Bn,scaleX:Vn,scaleY:Nn,strokeUniform:Un}=this.options,qn=new ot(Math.tan(_t(Je)),Math.tan(_t(Bn))),qo=this.strokeProjectionMagnitude,$o=Un?qo/Nn/Math.sqrt(1/Nn**2+1/Vn**2*qn.y**2):qo/Math.sqrt(1+qn.y**2),Zo=new ot(Math.sqrt(Math.max(qo**2-$o**2,0)),$o),ta=Un?qo/Math.sqrt(1+qn.x**2*(1/Nn)**2/(1/Vn+1/Vn*qn.x*qn.y)**2):qo/Math.sqrt(1+qn.x**2/(1+qn.x*qn.y)**2),ea=new ot(ta,Math.sqrt(Math.max(qo**2-ta**2,0)));return[ea,ea.scalarMultiply(-1),Zo,Zo.scalarMultiply(-1)].map(ra=>this.applySkew(Un?ra.multiply(this.strokeUniformScalar):ra)).forEach(ra=>{hs(ra,f,Ve)&&Ue.push(this.applySkew(this.A).add(ra))}),Ue}projectRound(){const f=[];f.push(...this.projectBevel());const Ve=this.alpha%w==0,Ue=this.applySkew(this.A),Je=f[Ve?0:2].subtract(Ue),Bn=f[Ve?1:0].subtract(Ue),Vn=Ve?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),Nn=os(Je,Vn)>0,Un=Nn?Je:Bn,qn=Nn?Bn:Je;return this.isSkewed()?f.push(...this.projectRoundWithSkew(Un,qn)):f.push(...this.projectRoundNoSkew(Un,qn)),f}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(f=>({originPoint:this.A,projectedPoint:f,angle:this.alpha,bisector:this.bisector}))}}class wi extends xi{constructor(f,Ve,Ue){super(Ue),this.A=new ot(f),this.T=new ot(Ve)}calcOrthogonalProjection(f,Ve){let Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const Je=this.createSideVector(f,Ve);return this.scaleUnitVector(ns(Je),Ue)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const f=[];if(!this.isSkewed()&&this.A.eq(this.T)){const Ve=new ot(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);f.push(this.applySkew(this.A.add(Ve)),this.applySkew(this.A.subtract(Ve)))}else f.push(...new bi(this.A,this.T,this.T,this.options).projectRound());return f}projectSquare(){const f=[];if(this.A.eq(this.T)){const Ve=new ot(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);f.push(this.A.add(Ve),this.A.subtract(Ve))}else{const Ve=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),Ue=this.scaleUnitVector(rs(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),Je=this.A.add(Ue);f.push(Je.add(Ve),Je.subtract(Ve))}return f.map(Ve=>this.applySkew(Ve))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(f=>({originPoint:this.A,projectedPoint:f}))}}const Si=function(qe,f){let Ve=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const Ue=[];if(qe.length===0)return Ue;const Je=qe.reduce((Bn,Vn)=>(Bn[Bn.length-1].eq(Vn)||Bn.push(new ot(Vn)),Bn),[new ot(qe[0])]);if(Je.length===1)Ve=!0;else if(!Ve){const Bn=Je[0],Vn=((Nn,Un)=>{for(let qn=Nn.length-1;qn>=0;qn--)if(Un(Nn[qn],qn,Nn))return qn;return-1})(Je,Nn=>!Nn.eq(Bn));Je.splice(Vn+1)}return Je.forEach((Bn,Vn,Nn)=>{let Un,qn;Vn===0?(qn=Nn[1],Un=Ve?Bn:Nn[Nn.length-1]):Vn===Nn.length-1?(Un=Nn[Vn-1],qn=Ve?Bn:Nn[0]):(Un=Nn[Vn-1],qn=Nn[Vn+1]),Ve&&Nn.length===1?Ue.push(...new wi(Bn,Bn,f).project()):!Ve||Vn!==0&&Vn!==Nn.length-1?Ue.push(...new bi(Bn,Un,qn,f).project()):Ue.push(...new wi(Bn,Vn===0?qn:Un,f).project())}),Ue},Ti=qe=>{const f={};return Object.keys(qe).forEach(Ve=>{f[Ve]={},Object.keys(qe[Ve]).forEach(Ue=>{f[Ve][Ue]=s({},qe[Ve][Ue])})}),f},Oi=qe=>qe.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ki=qe=>{const f=[];for(let Ve,Ue=0;Ue<qe.length;Ue++)(Ve=Di(qe,Ue))!==!1&&f.push(Ve);return f},Di=(qe,f)=>{const Ve=qe.charCodeAt(f);if(isNaN(Ve))return"";if(Ve<55296||Ve>57343)return qe.charAt(f);if(55296<=Ve&&Ve<=56319){if(qe.length<=f+1)throw"High surrogate without following low surrogate";const Je=qe.charCodeAt(f+1);if(56320>Je||Je>57343)throw"High surrogate without following low surrogate";return qe.charAt(f)+qe.charAt(f+1)}if(f===0)throw"Low surrogate without preceding high surrogate";const Ue=qe.charCodeAt(f-1);if(55296>Ue||Ue>56319)throw"Low surrogate without preceding high surrogate";return!1};var Mi=Object.freeze({__proto__:null,capitalize:function(qe){let f=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(qe.charAt(0).toUpperCase()).concat(f?qe.slice(1):qe.slice(1).toLowerCase())},escapeXml:Oi,graphemeSplit:ki});const Pi=function(qe,f){let Ve=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return qe.fill!==f.fill||qe.stroke!==f.stroke||qe.strokeWidth!==f.strokeWidth||qe.fontSize!==f.fontSize||qe.fontFamily!==f.fontFamily||qe.fontWeight!==f.fontWeight||qe.fontStyle!==f.fontStyle||qe.textBackgroundColor!==f.textBackgroundColor||qe.deltaY!==f.deltaY||Ve&&(qe.overline!==f.overline||qe.underline!==f.underline||qe.linethrough!==f.linethrough)},Ei=(qe,f)=>{const Ve=f.split(`
`),Ue=[];let Je=-1,Bn={};qe=Ti(qe);for(let Vn=0;Vn<Ve.length;Vn++){const Nn=ki(Ve[Vn]);if(qe[Vn])for(let Un=0;Un<Nn.length;Un++){Je++;const qn=qe[Vn][Un];qn&&Object.keys(qn).length>0&&(Pi(Bn,qn,!0)?Ue.push({start:Je,end:Je+1,style:qn}):Ue[Ue.length-1].end++),Bn=qn||{}}else Je+=Nn.length,Bn={}}return Ue},Ai=(qe,f)=>{if(!Array.isArray(qe))return Ti(qe);const Ve=f.split(F),Ue={};let Je=-1,Bn=0;for(let Vn=0;Vn<Ve.length;Vn++){const Nn=ki(Ve[Vn]);for(let Un=0;Un<Nn.length;Un++)Je++,qe[Bn]&&qe[Bn].start<=Je&&Je<qe[Bn].end&&(Ue[Vn]=Ue[Vn]||{},Ue[Vn][Un]=s({},qe[Bn].style),Je===qe[Bn].end-1&&Bn++)}return Ue},ji=["display","transform",K,"fill-opacity","fill-rule","opacity",J,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Fi(qe,f){const Ve=qe.nodeName,Ue=qe.getAttribute("class"),Je=qe.getAttribute("id"),Bn="(?![a-zA-Z\\-]+)";let Vn;if(Vn=new RegExp("^"+Ve,"i"),f=f.replace(Vn,""),Je&&f.length&&(Vn=new RegExp("#"+Je+Bn,"i"),f=f.replace(Vn,"")),Ue&&f.length){const Nn=Ue.split(" ");for(let Un=Nn.length;Un--;)Vn=new RegExp("\\."+Nn[Un]+Bn,"i"),f=f.replace(Vn,"")}return f.length===0}function Li(qe,f){let Ve=!0;const Ue=Fi(qe,f.pop());return Ue&&f.length&&(Ve=function(Je,Bn){let Vn,Nn=!0;for(;Je.parentElement&&Je.parentElement.nodeType===1&&Bn.length;)Nn&&(Vn=Bn.pop()),Nn=Fi(Je=Je.parentElement,Vn);return Bn.length===0}(qe,f)),Ue&&Ve&&f.length===0}const Ri=qe=>{var f;return(f=He[qe])!==null&&f!==void 0?f:qe},Ii=new RegExp("(".concat(We,")"),"gi"),Bi=qe=>qe.replace(Ii," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var Xi,Yi,Wi,Vi,zi,Hi,Gi;const Ni="(".concat(We,")"),Ui=String.raw(Xi||(Xi=r(["(skewX)(",")"],["(skewX)\\(","\\)"])),Ni),qi=String.raw(Yi||(Yi=r(["(skewY)(",")"],["(skewY)\\(","\\)"])),Ni),Ki=String.raw(Wi||(Wi=r(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Ni,Ni,Ni),Ji=String.raw(Vi||(Vi=r(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Ni,Ni),Qi=String.raw(zi||(zi=r(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Ni,Ni),Zi=String.raw(Hi||(Hi=r(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Ni,Ni,Ni,Ni,Ni,Ni),$i="(?:".concat(Zi,"|").concat(Qi,"|").concat(Ki,"|").concat(Ji,"|").concat(Ui,"|").concat(qi,")"),tr="(?:".concat($i,"*)"),er=String.raw(Gi||(Gi=r(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),tr),sr=new RegExp(er),ir=new RegExp($i),rr=new RegExp($i,"g");function nr(qe){const f=[];if(!(qe=Bi(qe).replace(/\s*([()])\s*/gi,"$1"))||qe&&!sr.test(qe))return[...T];for(const Ve of qe.matchAll(rr)){const Ue=ir.exec(Ve[0]);if(!Ue)continue;let Je=T;const Bn=Ue.filter(ea=>!!ea),[,Vn,...Nn]=Bn,[Un,qn,qo,$o,Zo,ta]=Nn.map(ea=>parseFloat(ea));switch(Vn){case"translate":Je=Dt(Un,qn);break;case B:Je=Mt({angle:Un},{x:qn,y:qo});break;case H:Je=Pt(Un,qn);break;case U:Je=At(Un);break;case q:Je=jt(Un);break;case"matrix":Je=[Un,qn,qo,$o,Zo,ta]}f.push(Je)}return Tt(f)}function or(qe,f,Ve,Ue){const Je=Array.isArray(f);let Bn,Vn=f;if(qe!==K&&qe!==J||f!==j){if(qe==="strokeUniform")return f==="non-scaling-stroke";if(qe==="strokeDashArray")Vn=f===j?null:f.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(qe==="transformMatrix")Vn=Ve&&Ve.transformMatrix?St(Ve.transformMatrix,nr(f)):nr(f);else if(qe==="visible")Vn=f!==j&&f!=="hidden",Ve&&Ve.visible===!1&&(Vn=!1);else if(qe==="opacity")Vn=parseFloat(f),Ve&&Ve.opacity!==void 0&&(Vn*=Ve.opacity);else if(qe==="textAnchor")Vn=f==="start"?M:f==="end"?A:D;else if(qe==="charSpacing")Bn=Kt(f,Ue)/Ue*1e3;else if(qe==="paintFirst"){const Nn=f.indexOf(K),Un=f.indexOf(J);Vn=K,(Nn>-1&&Un>-1&&Un<Nn||Nn===-1&&Un>-1)&&(Vn=J)}else{if(qe==="href"||qe==="xlink:href"||qe==="font"||qe==="id")return f;if(qe==="imageSmoothing")return f==="optimizeQuality";Bn=Je?f.map(Kt):Kt(f,Ue)}}else Vn="";return!Je&&isNaN(Bn)?Vn:Bn}function ar(qe,f){const Ve=qe.match(ze);if(!Ve)return;const Ue=Ve[1],Je=Ve[3],Bn=Ve[4],Vn=Ve[5],Nn=Ve[6];Ue&&(f.fontStyle=Ue),Je&&(f.fontWeight=isNaN(parseFloat(Je))?Je:parseFloat(Je)),Bn&&(f.fontSize=Kt(Bn)),Nn&&(f.fontFamily=Nn),Vn&&(f.lineHeight=Vn==="normal"?1:Vn)}function hr(qe,f){qe.replace(/;\s*$/,"").split(";").forEach(Ve=>{if(!Ve)return;const[Ue,Je]=Ve.split(":");f[Ue.trim().toLowerCase()]=Je.trim()})}function cr(qe){const f={},Ve=qe.getAttribute("style");return Ve&&(typeof Ve=="string"?hr(Ve,f):function(Ue,Je){Object.entries(Ue).forEach(Bn=>{let[Vn,Nn]=Bn;Nn!==void 0&&(Je[Vn.toLowerCase()]=Nn)})}(Ve,f)),f}const lr={stroke:"strokeOpacity",fill:"fillOpacity"};function ur(qe,f,Ve){if(!qe)return{};let Ue,Je={},Bn=O;qe.parentNode&&Ke.test(qe.parentNode.nodeName)&&(Je=ur(qe.parentElement,f,Ve),Je.fontSize&&(Ue=Bn=Kt(Je.fontSize)));const Vn=s(s(s({},f.reduce((qn,qo)=>{const $o=qe.getAttribute(qo);return $o&&(qn[qo]=$o),qn},{})),function(qn){let qo=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$o={};for(const Zo in qo)Li(qn,Zo.split(" "))&&($o=s(s({},$o),qo[Zo]));return $o}(qe,Ve)),cr(qe));Vn[Ne]&&qe.setAttribute(Ne,Vn[Ne]),Vn[Ge]&&(Ue=Kt(Vn[Ge],Bn),Vn[Ge]="".concat(Ue));const Nn={};for(const qn in Vn){const qo=Ri(qn),$o=or(qo,Vn[qn],Je,Ue);Nn[qo]=$o}Nn.font&&ar(Nn.font,Nn);const Un=s(s({},Je),Nn);return Ke.test(qe.nodeName)?Un:function(qn){const qo=yi.getDefaults();return Object.entries(lr).forEach($o=>{let[Zo,ta]=$o;if(qn[ta]===void 0||qn[Zo]==="")return;if(qn[Zo]===void 0){if(!qo[Zo])return;qn[Zo]=qo[Zo]}if(qn[Zo].indexOf("url(")===0)return;const ea=new Ut(qn[Zo]);qn[Zo]=ea.setAlpha(qt(ea.getAlpha()*qn[ta],2)).toRgba()}),qn}(Un)}const dr=["left","top","width","height","visible"],gr=["rx","ry"];class fr extends yi{static getDefaults(){return s(s({},super.getDefaults()),fr.ownDefaults)}constructor(f){super(),Object.assign(this,fr.ownDefaults),this.setOptions(f),this._initRxRy()}_initRxRy(){const{rx:f,ry:Ve}=this;f&&!Ve?this.ry=f:Ve&&!f&&(this.rx=Ve)}_render(f){const{width:Ve,height:Ue}=this,Je=-Ve/2,Bn=-Ue/2,Vn=this.rx?Math.min(this.rx,Ve/2):0,Nn=this.ry?Math.min(this.ry,Ue/2):0,Un=Vn!==0||Nn!==0;f.beginPath(),f.moveTo(Je+Vn,Bn),f.lineTo(Je+Ve-Vn,Bn),Un&&f.bezierCurveTo(Je+Ve-k*Vn,Bn,Je+Ve,Bn+k*Nn,Je+Ve,Bn+Nn),f.lineTo(Je+Ve,Bn+Ue-Nn),Un&&f.bezierCurveTo(Je+Ve,Bn+Ue-k*Nn,Je+Ve-k*Vn,Bn+Ue,Je+Ve-Vn,Bn+Ue),f.lineTo(Je+Vn,Bn+Ue),Un&&f.bezierCurveTo(Je+k*Vn,Bn+Ue,Je,Bn+Ue-k*Nn,Je,Bn+Ue-Nn),f.lineTo(Je,Bn+Nn),Un&&f.bezierCurveTo(Je,Bn+k*Nn,Je+k*Vn,Bn,Je+Vn,Bn),f.closePath(),this._renderPaintInOrder(f)}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...gr,...f])}_toSVG(){const{width:f,height:Ve,rx:Ue,ry:Je}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-f/2,'" y="').concat(-Ve/2,'" rx="').concat(Ue,'" ry="').concat(Je,'" width="').concat(f,'" height="').concat(Ve,`" />
`)]}static async fromElement(f,Ve,Ue){const Je=ur(f,this.ATTRIBUTE_NAMES,Ue),{left:Bn=0,top:Vn=0,width:Nn=0,height:Un=0,visible:qn=!0}=Je,qo=i(Je,dr);return new this(s(s(s({},Ve),qo),{},{left:Bn,top:Vn,width:Nn,height:Un,visible:!!(qn&&Nn&&Un)}))}}t(fr,"type","Rect"),t(fr,"cacheProperties",[...fs,...gr]),t(fr,"ownDefaults",{rx:0,ry:0}),t(fr,"ATTRIBUTE_NAMES",[...ji,"x","y","rx","ry","width","height"]),tt.setClass(fr),tt.setSVGClass(fr);const pr="initialization",mr="added",vr="removed",yr="imperative",_r=(qe,f)=>{const{strokeUniform:Ve,strokeWidth:Ue,width:Je,height:Bn,group:Vn}=f,Nn=Vn&&Vn!==qe?we(Vn.calcTransformMatrix(),qe.calcTransformMatrix()):null,Un=Nn?f.getRelativeCenterPoint().transform(Nn):f.getRelativeCenterPoint(),qn=!f.isStrokeAccountedForInDimensions(),qo=Ve&&qn?Te(new ot(Ue,Ue),void 0,qe.calcTransformMatrix()):at,$o=!Ve&&qn?Ue:0,Zo=be(Je+$o,Bn+$o,Tt([Nn,f.calcOwnMatrix()],!0)).add(qo).scalarDivide(2);return[Un.subtract(Zo),Un.add(Zo)]};class xr{calcLayoutResult(f,Ve){if(this.shouldPerformLayout(f))return this.calcBoundingBox(Ve,f)}shouldPerformLayout(f){let{type:Ve,prevStrategy:Ue,strategy:Je}=f;return Ve===pr||Ve===yr||!!Ue&&Je!==Ue}shouldLayoutClipPath(f){let{type:Ve,target:{clipPath:Ue}}=f;return Ve!==pr&&Ue&&!Ue.absolutePositioned}getInitialSize(f,Ve){return Ve.size}calcBoundingBox(f,Ve){const{type:Ue,target:Je}=Ve;if(Ue===yr&&Ve.overrides)return Ve.overrides;if(f.length===0)return;const{left:Bn,top:Vn,width:Nn,height:Un}=me(f.map($o=>_r(Je,$o)).reduce(($o,Zo)=>$o.concat(Zo),[])),qn=new ot(Nn,Un),qo=new ot(Bn,Vn).add(qn.scalarDivide(2));if(Ue===pr){const $o=this.getInitialSize(Ve,{size:qn,center:qo});return{center:qo,relativeCorrection:new ot(0,0),size:$o}}return{center:qo.transform(Je.calcOwnMatrix()),size:qn}}}t(xr,"type","strategy");class Cr extends xr{shouldPerformLayout(f){return!0}}t(Cr,"type","fit-content"),tt.setClass(Cr);const br=["strategy"],wr=["target","strategy","bubbles","prevStrategy"],Sr="layoutManager";class Tr{constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Cr;t(this,"strategy",void 0),this.strategy=f,this._subscriptions=new Map}performLayout(f){const Ve=s(s({bubbles:!0,strategy:this.strategy},f),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(Ve);const Ue=this.getLayoutResult(Ve);Ue&&this.commitLayout(Ve,Ue),this.onAfterLayout(Ve,Ue),this._prevLayoutStrategy=Ve.strategy}attachHandlers(f,Ve){const{target:Ue}=Ve;return[Q,L,Y,I,R,X,z,W,V].map(Je=>f.on(Je,Bn=>this.performLayout(Je===Q?{type:"object_modified",trigger:Je,e:Bn,target:Ue}:{type:"object_modifying",trigger:Je,e:Bn,target:Ue})))}subscribe(f,Ve){this.unsubscribe(f,Ve);const Ue=this.attachHandlers(f,Ve);this._subscriptions.set(f,Ue)}unsubscribe(f,Ve){(this._subscriptions.get(f)||[]).forEach(Ue=>Ue()),this._subscriptions.delete(f)}unsubscribeTargets(f){f.targets.forEach(Ve=>this.unsubscribe(Ve,f))}subscribeTargets(f){f.targets.forEach(Ve=>this.subscribe(Ve,f))}onBeforeLayout(f){const{target:Ve,type:Ue}=f,{canvas:Je}=Ve;if(Ue===pr||Ue===mr?this.subscribeTargets(f):Ue===vr&&this.unsubscribeTargets(f),Ve.fire("layout:before",{context:f}),Je&&Je.fire("object:layout:before",{target:Ve,context:f}),Ue===yr&&f.deep){const Bn=i(f,br);Ve.forEachObject(Vn=>Vn.layoutManager&&Vn.layoutManager.performLayout(s(s({},Bn),{},{bubbles:!1,target:Vn})))}}getLayoutResult(f){const{target:Ve,strategy:Ue,type:Je}=f,Bn=Ue.calcLayoutResult(f,Ve.getObjects());if(!Bn)return;const Vn=Je===pr?new ot:Ve.getRelativeCenterPoint(),{center:Nn,correction:Un=new ot,relativeCorrection:qn=new ot}=Bn,qo=Vn.subtract(Nn).add(Un).transform(Je===pr?T:wt(Ve.calcOwnMatrix()),!0).add(qn);return{result:Bn,prevCenter:Vn,nextCenter:Nn,offset:qo}}commitLayout(f,Ve){const{target:Ue}=f,{result:{size:Je},nextCenter:Bn}=Ve;var Vn,Nn;Ue.set({width:Je.x,height:Je.y}),this.layoutObjects(f,Ve),f.type===pr?Ue.set({left:(Vn=f.x)!==null&&Vn!==void 0?Vn:Bn.x+Je.x*Me(Ue.originX),top:(Nn=f.y)!==null&&Nn!==void 0?Nn:Bn.y+Je.y*Me(Ue.originY)}):(Ue.setPositionByOrigin(Bn,D,D),Ue.setCoords(),Ue.set("dirty",!0))}layoutObjects(f,Ve){const{target:Ue}=f;Ue.forEachObject(Je=>{Je.group===Ue&&this.layoutObject(f,Ve,Je)}),f.strategy.shouldLayoutClipPath(f)&&this.layoutObject(f,Ve,Ue.clipPath)}layoutObject(f,Ve,Ue){let{offset:Je}=Ve;Ue.set({left:Ue.left+Je.x,top:Ue.top+Je.y})}onAfterLayout(f,Ve){const{target:Ue,strategy:Je,bubbles:Bn,prevStrategy:Vn}=f,Nn=i(f,wr),{canvas:Un}=Ue;Ue.fire("layout:after",{context:f,result:Ve}),Un&&Un.fire("object:layout:after",{context:f,result:Ve,target:Ue});const qn=Ue.parent;Bn&&qn!=null&&qn.layoutManager&&((Nn.path||(Nn.path=[])).push(Ue),qn.layoutManager.performLayout(s(s({},Nn),{},{target:qn}))),Ue.set("dirty",!0)}dispose(){const{_subscriptions:f}=this;f.forEach(Ve=>Ve.forEach(Ue=>Ue())),f.clear()}toObject(){return{type:Sr,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}tt.setClass(Tr,Sr);const Or=["type","objects","layoutManager"];class kr extends Tr{performLayout(){}}class Dr extends ct(yi){static getDefaults(){return s(s({},super.getDefaults()),Dr.ownDefaults)}constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),t(this,"_activeObjects",[]),t(this,"__objectSelectionTracker",void 0),t(this,"__objectSelectionDisposer",void 0),Object.assign(this,Dr.ownDefaults),this.setOptions(Ve),this.groupInit(f,Ve)}groupInit(f,Ve){var Ue;this._objects=[...f],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(Je=>{this.enterGroup(Je,!1)}),this.layoutManager=(Ue=Ve.layoutManager)!==null&&Ue!==void 0?Ue:new Tr,this.layoutManager.performLayout({type:pr,target:this,targets:[...f],x:Ve.left,y:Ve.top})}canEnterGroup(f){return f===this||this.isDescendantOf(f)?(a("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(f)===-1||(a("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(f){return f.filter((Ve,Ue,Je)=>this.canEnterGroup(Ve)&&Je.indexOf(Ve)===Ue)}add(){for(var f=arguments.length,Ve=new Array(f),Ue=0;Ue<f;Ue++)Ve[Ue]=arguments[Ue];const Je=this._filterObjectsBeforeEnteringGroup(Ve),Bn=super.add(...Je);return this._onAfterObjectsChange(mr,Je),Bn}insertAt(f){for(var Ve=arguments.length,Ue=new Array(Ve>1?Ve-1:0),Je=1;Je<Ve;Je++)Ue[Je-1]=arguments[Je];const Bn=this._filterObjectsBeforeEnteringGroup(Ue),Vn=super.insertAt(f,...Bn);return this._onAfterObjectsChange(mr,Bn),Vn}remove(){const f=super.remove(...arguments);return this._onAfterObjectsChange(vr,f),f}_onObjectAdded(f){this.enterGroup(f,!0),this.fire("object:added",{target:f}),f.fire("added",{target:this})}_onObjectRemoved(f,Ve){this.exitGroup(f,Ve),this.fire("object:removed",{target:f}),f.fire("removed",{target:this})}_onAfterObjectsChange(f,Ve){this.layoutManager.performLayout({type:f,targets:Ve,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(f,Ve){const Ue=this[f];return super._set(f,Ve),f==="canvas"&&Ue!==Ve&&(this._objects||[]).forEach(Je=>{Je._set(f,Ve)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(f,Ve){let{target:Ue}=Ve;const Je=this._activeObjects;if(f)Je.push(Ue),this._set("dirty",!0);else if(Je.length>0){const Bn=Je.indexOf(Ue);Bn>-1&&(Je.splice(Bn,1),this._set("dirty",!0))}}_watchObject(f,Ve){f&&this._watchObject(!1,Ve),f?(Ve.on("selected",this.__objectSelectionTracker),Ve.on("deselected",this.__objectSelectionDisposer)):(Ve.off("selected",this.__objectSelectionTracker),Ve.off("deselected",this.__objectSelectionDisposer))}enterGroup(f,Ve){f.group&&f.group.remove(f),f._set("parent",this),this._enterGroup(f,Ve)}_enterGroup(f,Ve){Ve&&_e(f,St(wt(this.calcTransformMatrix()),f.calcTransformMatrix())),this._shouldSetNestedCoords()&&f.setCoords(),f._set("group",this),f._set("canvas",this.canvas),this._watchObject(!0,f);const Ue=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();Ue&&(Ue===f||f.isDescendantOf(Ue))&&this._activeObjects.push(f)}exitGroup(f,Ve){this._exitGroup(f,Ve),f._set("parent",void 0),f._set("canvas",void 0)}_exitGroup(f,Ve){f._set("group",void 0),Ve||(_e(f,St(this.calcTransformMatrix(),f.calcTransformMatrix())),f.setCoords()),this._watchObject(!1,f);const Ue=this._activeObjects.length>0?this._activeObjects.indexOf(f):-1;Ue>-1&&this._activeObjects.splice(Ue,1)}shouldCache(){const f=yi.prototype.shouldCache.call(this);if(f){for(let Ve=0;Ve<this._objects.length;Ve++)if(this._objects[Ve].willDrawShadow())return this.ownCaching=!1,!1}return f}willDrawShadow(){if(super.willDrawShadow())return!0;for(let f=0;f<this._objects.length;f++)if(this._objects[f].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(f,Ve,Ue){this._renderBackground(f);for(let Bn=0;Bn<this._objects.length;Bn++){var Je;const Vn=this._objects[Bn];(Je=this.canvas)!==null&&Je!==void 0&&Je.preserveObjectStacking&&Vn.group!==this?(f.save(),f.transform(...wt(this.calcTransformMatrix())),Vn.render(f),f.restore()):Vn.group===this&&Vn.render(f)}this._drawClipPath(f,this.clipPath,Ue)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(f=>f.setCoords())}triggerLayout(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(s({target:this,type:yr},f))}render(f){this._transformDone=!0,super.render(f),this._transformDone=!1}__serializeObjects(f,Ve){const Ue=this.includeDefaultValues;return this._objects.filter(function(Je){return!Je.excludeFromExport}).map(function(Je){const Bn=Je.includeDefaultValues;Je.includeDefaultValues=Ue;const Vn=Je[f||"toObject"](Ve);return Je.includeDefaultValues=Bn,Vn})}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const Ve=this.layoutManager.toObject();return s(s(s({},super.toObject(["subTargetCheck","interactive",...f])),Ve.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:Ve}:{}),{},{objects:this.__serializeObjects("toObject",f)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(f=>{this._watchObject(!1,f),f.dispose()}),super.dispose()}_createSVGBgRect(f){if(!this.backgroundColor)return"";const Ve=fr.prototype._toSVG.call(this),Ue=Ve.indexOf("COMMON_PARTS");Ve[Ue]='for="group" ';const Je=Ve.join("");return f?f(Je):Je}_toSVG(f){const Ve=["<g ","COMMON_PARTS",` >
`],Ue=this._createSVGBgRect(f);Ue&&Ve.push("		",Ue);for(let Je=0;Je<this._objects.length;Je++)Ve.push("		",this._objects[Je].toSVG(f));return Ve.push(`</g>
`),Ve}getSvgStyles(){const f=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",Ve=this.visible?"":" visibility: hidden;";return[f,this.getSvgFilter(),Ve].join("")}toClipPathSVG(f){const Ve=[],Ue=this._createSVGBgRect(f);Ue&&Ve.push("	",Ue);for(let Je=0;Je<this._objects.length;Je++)Ve.push("	",this._objects[Je].toClipPathSVG(f));return this._createBaseClipPathSVGMarkup(Ve,{reviver:f})}static fromObject(f,Ve){let{type:Ue,objects:Je=[],layoutManager:Bn}=f,Vn=i(f,Or);return Promise.all([It(Je,Ve),Bt(Vn,Ve)]).then(Nn=>{let[Un,qn]=Nn;const qo=new this(Un,s(s(s({},Vn),qn),{},{layoutManager:new kr}));if(Bn){const $o=tt.getClass(Bn.type),Zo=tt.getClass(Bn.strategy);qo.layoutManager=new $o(new Zo)}else qo.layoutManager=new Tr;return qo.layoutManager.subscribeTargets({type:pr,target:qo,targets:qo.getObjects()}),qo.setCoords(),qo})}}t(Dr,"type","Group"),t(Dr,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),tt.setClass(Dr);const Mr=(qe,f)=>Math.min(f.width/qe.width,f.height/qe.height),Pr=(qe,f)=>Math.max(f.width/qe.width,f.height/qe.height),Er="\\s*,?\\s*",Ar="".concat(Er,"(").concat(We,")"),jr="".concat(Ar).concat(Ar).concat(Ar).concat(Er,"([01])").concat(Er,"([01])").concat(Ar).concat(Ar),Fr={m:"l",M:"L"},Lr=(qe,f,Ve,Ue,Je,Bn,Vn,Nn,Un,qn,qo)=>{const $o=rt(qe),Zo=nt(qe),ta=rt(f),ea=nt(f),ra=Ve*Je*ta-Ue*Bn*ea+Vn,na=Ue*Je*ta+Ve*Bn*ea+Nn;return["C",qn+Un*(-Ve*Je*Zo-Ue*Bn*$o),qo+Un*(-Ue*Je*Zo+Ve*Bn*$o),ra+Un*(Ve*Je*ea+Ue*Bn*ta),na+Un*(Ue*Je*ea-Ve*Bn*ta),ra,na]},Rr=(qe,f,Ve,Ue)=>{const Je=Math.atan2(f,qe),Bn=Math.atan2(Ue,Ve);return Bn>=Je?Bn-Je:2*Math.PI-(Je-Bn)};function Ir(qe,f,Ve,Ue,Je,Bn,Vn,Nn){let Un;if(o.cachesBoundsOfCurve&&(Un=[...arguments].join(),_.boundsOfCurveCache[Un]))return _.boundsOfCurveCache[Un];const qn=Math.sqrt,qo=Math.abs,$o=[],Zo=[[0,0],[0,0]];let ta=6*qe-12*Ve+6*Je,ea=-3*qe+9*Ve-9*Je+3*Vn,ra=3*Ve-3*qe;for(let la=0;la<2;++la){if(la>0&&(ta=6*f-12*Ue+6*Bn,ea=-3*f+9*Ue-9*Bn+3*Nn,ra=3*Ue-3*f),qo(ea)<1e-12){if(qo(ta)<1e-12)continue;const ba=-ra/ta;0<ba&&ba<1&&$o.push(ba);continue}const ma=ta*ta-4*ra*ea;if(ma<0)continue;const Ca=qn(ma),Sa=(-ta+Ca)/(2*ea);0<Sa&&Sa<1&&$o.push(Sa);const ga=(-ta-Ca)/(2*ea);0<ga&&ga<1&&$o.push(ga)}let na=$o.length;const oa=na,ca=Wr(qe,f,Ve,Ue,Je,Bn,Vn,Nn);for(;na--;){const{x:la,y:ma}=ca($o[na]);Zo[0][na]=la,Zo[1][na]=ma}Zo[0][oa]=qe,Zo[1][oa]=f,Zo[0][oa+1]=Vn,Zo[1][oa+1]=Nn;const pa=[new ot(Math.min(...Zo[0]),Math.min(...Zo[1])),new ot(Math.max(...Zo[0]),Math.max(...Zo[1]))];return o.cachesBoundsOfCurve&&(_.boundsOfCurveCache[Un]=pa),pa}const Br=(qe,f,Ve)=>{let[Ue,Je,Bn,Vn,Nn,Un,qn,qo]=Ve;const $o=((Zo,ta,ea,ra,na,oa,ca)=>{if(ea===0||ra===0)return[];let pa=0,la=0,ma=0;const Ca=Math.PI,Sa=ca*S,ga=nt(Sa),ba=rt(Sa),Ha=.5*(-ba*Zo-ga*ta),Ja=.5*(-ba*ta+ga*Zo),tc=ea**2,Ua=ra**2,sc=Ja**2,ic=Ha**2,Ka=tc*Ua-tc*sc-Ua*ic;let Na=Math.abs(ea),Ta=Math.abs(ra);if(Ka<0){const cc=Math.sqrt(1-Ka/(tc*Ua));Na*=cc,Ta*=cc}else ma=(na===oa?-1:1)*Math.sqrt(Ka/(tc*sc+Ua*ic));const nc=ma*Na*Ja/Ta,oc=-ma*Ta*Ha/Na,fc=ba*nc-ga*oc+.5*Zo,ac=ga*nc+ba*oc+.5*ta;let _c=Rr(1,0,(Ha-nc)/Na,(Ja-oc)/Ta),gc=Rr((Ha-nc)/Na,(Ja-oc)/Ta,(-Ha-nc)/Na,(-Ja-oc)/Ta);oa===0&&gc>0?gc-=2*Ca:oa===1&&gc<0&&(gc+=2*Ca);const xc=Math.ceil(Math.abs(gc/Ca*2)),hc=[],pc=gc/xc,Sc=8/3*Math.sin(pc/4)*Math.sin(pc/4)/Math.sin(pc/2);let bc=_c+pc;for(let cc=0;cc<xc;cc++)hc[cc]=Lr(_c,bc,ba,ga,Na,Ta,fc,ac,Sc,pa,la),pa=hc[cc][5],la=hc[cc][6],_c=bc,bc+=pc;return hc})(qn-qe,qo-f,Je,Bn,Nn,Un,Vn);for(let Zo=0,ta=$o.length;Zo<ta;Zo++)$o[Zo][1]+=qe,$o[Zo][2]+=f,$o[Zo][3]+=qe,$o[Zo][4]+=f,$o[Zo][5]+=qe,$o[Zo][6]+=f;return $o},Xr=qe=>{let f=0,Ve=0,Ue=0,Je=0;const Bn=[];let Vn,Nn=0,Un=0;for(const qn of qe){const qo=[...qn];let $o;switch(qo[0]){case"l":qo[1]+=f,qo[2]+=Ve;case"L":f=qo[1],Ve=qo[2],$o=["L",f,Ve];break;case"h":qo[1]+=f;case"H":f=qo[1],$o=["L",f,Ve];break;case"v":qo[1]+=Ve;case"V":Ve=qo[1],$o=["L",f,Ve];break;case"m":qo[1]+=f,qo[2]+=Ve;case"M":f=qo[1],Ve=qo[2],Ue=qo[1],Je=qo[2],$o=["M",f,Ve];break;case"c":qo[1]+=f,qo[2]+=Ve,qo[3]+=f,qo[4]+=Ve,qo[5]+=f,qo[6]+=Ve;case"C":Nn=qo[3],Un=qo[4],f=qo[5],Ve=qo[6],$o=["C",qo[1],qo[2],Nn,Un,f,Ve];break;case"s":qo[1]+=f,qo[2]+=Ve,qo[3]+=f,qo[4]+=Ve;case"S":Vn==="C"?(Nn=2*f-Nn,Un=2*Ve-Un):(Nn=f,Un=Ve),f=qo[3],Ve=qo[4],$o=["C",Nn,Un,qo[1],qo[2],f,Ve],Nn=$o[3],Un=$o[4];break;case"q":qo[1]+=f,qo[2]+=Ve,qo[3]+=f,qo[4]+=Ve;case"Q":Nn=qo[1],Un=qo[2],f=qo[3],Ve=qo[4],$o=["Q",Nn,Un,f,Ve];break;case"t":qo[1]+=f,qo[2]+=Ve;case"T":Vn==="Q"?(Nn=2*f-Nn,Un=2*Ve-Un):(Nn=f,Un=Ve),f=qo[1],Ve=qo[2],$o=["Q",Nn,Un,f,Ve];break;case"a":qo[6]+=f,qo[7]+=Ve;case"A":Br(f,Ve,qo).forEach(Zo=>Bn.push(Zo)),f=qo[6],Ve=qo[7];break;case"z":case"Z":f=Ue,Ve=Je,$o=["Z"]}$o?(Bn.push($o),Vn=$o[0]):Vn=""}return Bn},Yr=(qe,f,Ve,Ue)=>Math.sqrt((Ve-qe)**2+(Ue-f)**2),Wr=(qe,f,Ve,Ue,Je,Bn,Vn,Nn)=>Un=>{const qn=Un**3,qo=(ta=>3*ta**2*(1-ta))(Un),$o=(ta=>3*ta*(1-ta)**2)(Un),Zo=(ta=>(1-ta)**3)(Un);return new ot(Vn*qn+Je*qo+Ve*$o+qe*Zo,Nn*qn+Bn*qo+Ue*$o+f*Zo)},Vr=qe=>qe**2,zr=qe=>2*qe*(1-qe),Hr=qe=>(1-qe)**2,Gr=(qe,f,Ve,Ue,Je,Bn,Vn,Nn)=>Un=>{const qn=Vr(Un),qo=zr(Un),$o=Hr(Un),Zo=3*($o*(Ve-qe)+qo*(Je-Ve)+qn*(Vn-Je)),ta=3*($o*(Ue-f)+qo*(Bn-Ue)+qn*(Nn-Bn));return Math.atan2(ta,Zo)},Nr=(qe,f,Ve,Ue,Je,Bn)=>Vn=>{const Nn=Vr(Vn),Un=zr(Vn),qn=Hr(Vn);return new ot(Je*Nn+Ve*Un+qe*qn,Bn*Nn+Ue*Un+f*qn)},Ur=(qe,f,Ve,Ue,Je,Bn)=>Vn=>{const Nn=1-Vn,Un=2*(Nn*(Ve-qe)+Vn*(Je-Ve)),qn=2*(Nn*(Ue-f)+Vn*(Bn-Ue));return Math.atan2(qn,Un)},qr=(qe,f,Ve)=>{let Ue=new ot(f,Ve),Je=0;for(let Bn=1;Bn<=100;Bn+=1){const Vn=qe(Bn/100);Je+=Yr(Ue.x,Ue.y,Vn.x,Vn.y),Ue=Vn}return Je},Kr=(qe,f)=>{let Ve,Ue=0,Je=0,Bn={x:qe.x,y:qe.y},Vn=s({},Bn),Nn=.01,Un=0;const qn=qe.iterator,qo=qe.angleFinder;for(;Je<f&&Nn>1e-4;)Vn=qn(Ue),Un=Ue,Ve=Yr(Bn.x,Bn.y,Vn.x,Vn.y),Ve+Je>f?(Ue-=Nn,Nn/=2):(Bn=Vn,Ue+=Nn,Je+=Ve);return s(s({},Vn),{},{angle:qo(Un)})},Jr=qe=>{let f,Ve,Ue=0,Je=0,Bn=0,Vn=0,Nn=0;const Un=[];for(const qn of qe){const qo={x:Je,y:Bn,command:qn[0],length:0};switch(qn[0]){case"M":Ve=qo,Ve.x=Vn=Je=qn[1],Ve.y=Nn=Bn=qn[2];break;case"L":Ve=qo,Ve.length=Yr(Je,Bn,qn[1],qn[2]),Je=qn[1],Bn=qn[2];break;case"C":f=Wr(Je,Bn,qn[1],qn[2],qn[3],qn[4],qn[5],qn[6]),Ve=qo,Ve.iterator=f,Ve.angleFinder=Gr(Je,Bn,qn[1],qn[2],qn[3],qn[4],qn[5],qn[6]),Ve.length=qr(f,Je,Bn),Je=qn[5],Bn=qn[6];break;case"Q":f=Nr(Je,Bn,qn[1],qn[2],qn[3],qn[4]),Ve=qo,Ve.iterator=f,Ve.angleFinder=Ur(Je,Bn,qn[1],qn[2],qn[3],qn[4]),Ve.length=qr(f,Je,Bn),Je=qn[3],Bn=qn[4];break;case"Z":Ve=qo,Ve.destX=Vn,Ve.destY=Nn,Ve.length=Yr(Je,Bn,Vn,Nn),Je=Vn,Bn=Nn}Ue+=Ve.length,Un.push(Ve)}return Un.push({length:Ue,x:Je,y:Bn}),Un},Qr=function(qe,f){let Ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jr(qe),Ue=0;for(;f-Ve[Ue].length>0&&Ue<Ve.length-2;)f-=Ve[Ue].length,Ue++;const Je=Ve[Ue],Bn=f/Je.length,Vn=qe[Ue];switch(Je.command){case"M":return{x:Je.x,y:Je.y,angle:0};case"Z":return s(s({},new ot(Je.x,Je.y).lerp(new ot(Je.destX,Je.destY),Bn)),{},{angle:Math.atan2(Je.destY-Je.y,Je.destX-Je.x)});case"L":return s(s({},new ot(Je.x,Je.y).lerp(new ot(Vn[1],Vn[2]),Bn)),{},{angle:Math.atan2(Vn[2]-Je.y,Vn[1]-Je.x)});case"C":case"Q":return Kr(Je,f)}},Zr=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),$r=new RegExp(jr,"g"),tn=new RegExp(We,"gi"),en={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},sn=qe=>{var f;const Ve=[],Ue=(f=qe.match(Zr))!==null&&f!==void 0?f:[];for(const Je of Ue){const Bn=Je[0];if(Bn==="z"||Bn==="Z"){Ve.push([Bn]);continue}const Vn=en[Bn.toLowerCase()];let Nn=[];if(Bn==="a"||Bn==="A"){$r.lastIndex=0;for(let Un=null;Un=$r.exec(Je);)Nn.push(...Un.slice(1))}else Nn=Je.match(tn)||[];for(let Un=0;Un<Nn.length;Un+=Vn){const qn=new Array(Vn),qo=Fr[Bn];qn[0]=Un>0&&qo?qo:Bn;for(let $o=0;$o<Vn;$o++)qn[$o+1]=parseFloat(Nn[Un+$o]);Ve.push(qn)}}return Ve},rn=function(qe){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,Ve=new ot(qe[0]),Ue=new ot(qe[1]),Je=1,Bn=0;const Vn=[],Nn=qe.length,Un=Nn>2;let qn;for(Un&&(Je=qe[2].x<Ue.x?-1:qe[2].x===Ue.x?0:1,Bn=qe[2].y<Ue.y?-1:qe[2].y===Ue.y?0:1),Vn.push(["M",Ve.x-Je*f,Ve.y-Bn*f]),qn=1;qn<Nn;qn++){if(!Ve.eq(Ue)){const qo=Ve.midPointFrom(Ue);Vn.push(["Q",Ve.x,Ve.y,qo.x,qo.y])}Ve=qe[qn],qn+1<qe.length&&(Ue=qe[qn+1])}return Un&&(Je=Ve.x>qe[qn-2].x?1:Ve.x===qe[qn-2].x?0:-1,Bn=Ve.y>qe[qn-2].y?1:Ve.y===qe[qn-2].y?0:-1),Vn.push(["L",Ve.x+Je*f,Ve.y+Bn*f]),Vn},nn=(qe,f)=>qe.map(Ve=>Ve.map((Ue,Je)=>Je===0||f===void 0?Ue:qt(Ue,f)).join(" ")).join(" ");function on(qe,f){const Ve=qe.style;Ve&&f&&(typeof f=="string"?Ve.cssText+=";"+f:Object.entries(f).forEach(Ue=>{let[Je,Bn]=Ue;return Ve.setProperty(Je,Bn)}))}const an=(qe,f)=>Math.floor(Math.random()*(f-qe+1))+qe;function hn(qe){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const Ve=f.onComplete||C,Ue=new(v()).XMLHttpRequest,Je=f.signal,Bn=function(){Ue.abort()},Vn=function(){Je&&Je.removeEventListener("abort",Bn),Ue.onerror=Ue.ontimeout=C};if(Je&&Je.aborted)throw new c("request");return Je&&Je.addEventListener("abort",Bn,{once:!0}),Ue.onreadystatechange=function(){Ue.readyState===4&&(Vn(),Ve(Ue),Ue.onreadystatechange=C)},Ue.onerror=Ue.ontimeout=Vn,Ue.open("get",qe,!0),Ue.send(),Ue}const cn=(qe,f)=>{let Ve=qe._findCenterFromElement();qe.transformMatrix&&((Ue=>{if(Ue.transformMatrix){const{scaleX:Je,scaleY:Bn,angle:Vn,skewX:Nn}=kt(Ue.transformMatrix);Ue.flipX=!1,Ue.flipY=!1,Ue.set(G,Je),Ue.set(N,Bn),Ue.angle=Vn,Ue.skewX=Nn,Ue.skewY=0}})(qe),Ve=Ve.transform(qe.transformMatrix)),delete qe.transformMatrix,f&&(qe.scaleX*=f.scaleX,qe.scaleY*=f.scaleY,qe.cropX=f.cropX,qe.cropY=f.cropY,Ve.x+=f.offsetLeft,Ve.y+=f.offsetTop,qe.width=f.width,qe.height=f.height),qe.setPositionByOrigin(Ve,D,D)};var ln=Object.freeze({__proto__:null,addTransformToObject:ye,animate:As,animateColor:js,applyTransformToObject:_e,calcAngleBetweenVectors:ss,calcDimensionsMatrix:Ft,calcPlaneChangeMatrix:we,calcVectorRotation:is,cancelAnimFrame:dt,capValue:ds,composeMatrix:Lt,copyCanvasElement:qe=>{var f;const Ve=vt(qe);return(f=Ve.getContext("2d"))===null||f===void 0||f.drawImage(qe,0,0),Ve},cos:rt,createCanvasElement:pt,createImage:mt,createRotateMatrix:Mt,createScaleMatrix:Pt,createSkewXMatrix:At,createSkewYMatrix:jt,createTranslateMatrix:Dt,createVector:ts,crossProduct:os,degreesToRadians:_t,dotProduct:as,ease:Cs,enlivenObjectEnlivables:Bt,enlivenObjects:It,findScaleToCover:Pr,findScaleToFit:Mr,getBoundsOfCurve:Ir,getOrthonormalVector:ns,getPathSegmentsInfo:Jr,getPointOnPath:Qr,getPointer:ge,getRandomInt:an,getRegularPolygonPath:(qe,f)=>{const Ve=2*Math.PI/qe;let Ue=-b;qe%2==0&&(Ue+=Ve/2);const Je=new Array(qe+1);for(let Bn=0;Bn<qe;Bn++){const Vn=Bn*Ve+Ue,{x:Nn,y:Un}=new ot(rt(Vn),nt(Vn)).scalarMultiply(f);Je[Bn]=[Bn===0?"M":"L",Nn,Un]}return Je[qe]=["Z"],Je},getSmoothPathFromPoints:rn,getSvgAttributes:qe=>{const f=["instantiated_by_use","style","id","class"];switch(qe){case"linearGradient":return f.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return f.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return f.concat(["offset","stop-color","stop-opacity"])}return f},getUnitVector:rs,groupSVGElements:(qe,f)=>qe&&qe.length===1?qe[0]:new Dr(qe,f),hasStyleChanged:Pi,invertTransform:wt,isBetweenVectors:hs,isIdentityMatrix:Ct,isTouchEvent:fe,isTransparent:_i,joinPath:nn,loadImage:Rt,magnitude:es,makeBoundingBoxFromPoints:me,makePathSimpler:Xr,matrixToSVG:Qt,mergeClipPaths:(qe,f)=>{var Ve;let Ue=qe,Je=f;Ue.inverted&&!Je.inverted&&(Ue=f,Je=qe),Oe(Je,(Ve=Je.group)===null||Ve===void 0?void 0:Ve.calcTransformMatrix(),Ue.calcTransformMatrix());const Bn=Ue.inverted&&Je.inverted;return Bn&&(Ue.inverted=Je.inverted=!1),new Dr([Ue],{clipPath:Je,inverted:Bn})},multiplyTransformMatrices:St,multiplyTransformMatrixArray:Tt,parsePath:sn,parsePreserveAspectRatioAttribute:Jt,parseUnit:Kt,pick:Xt,projectStrokeOnPoints:Si,qrDecompose:kt,radiansToDegrees:xt,removeFromArray:it,removeTransformFromObject:(qe,f)=>{const Ve=wt(f),Ue=St(Ve,qe.calcOwnMatrix());_e(qe,Ue)},removeTransformMatrixForSvgParsing:cn,request:hn,requestAnimFrame:ut,resetObjectTransform:xe,rotatePoint:(qe,f,Ve)=>qe.rotate(Ve,f),rotateVector:$e,saveObjectTransform:Ce,sendObjectToPlane:Oe,sendPointToPlane:Se,sendVectorToPlane:Te,setStyle:on,sin:nt,sizeAfterTransform:be,string:Mi,stylesFromArray:Ai,stylesToArray:Ei,toDataURL:yt,toFixed:qt,transformPath:(qe,f,Ve)=>(Ve&&(f=St(f,[1,0,0,1,-Ve.x,-Ve.y])),qe.map(Ue=>{const Je=[...Ue];for(let Bn=1;Bn<Ue.length-1;Bn+=2){const{x:Vn,y:Nn}=bt({x:Ue[Bn],y:Ue[Bn+1]},f);Je[Bn]=Vn,Je[Bn+1]=Nn}return Je})),transformPoint:bt});class un extends ce{constructor(f){let{allowTouchScrolling:Ve=!1,containerClass:Ue=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(f),t(this,"upper",void 0),t(this,"container",void 0);const{el:Je}=this.lower,Bn=this.createUpperCanvas();this.upper={el:Bn,ctx:Bn.getContext("2d")},this.applyCanvasStyle(Je,{allowTouchScrolling:Ve}),this.applyCanvasStyle(Bn,{allowTouchScrolling:Ve,styles:{position:"absolute",left:"0",top:"0"}});const Vn=this.createContainerElement();Vn.classList.add(Ue),Je.parentNode&&Je.parentNode.replaceChild(Vn,Je),Vn.append(Je,Bn),this.container=Vn}createUpperCanvas(){const{el:f}=this.lower,Ve=pt();return Ve.className=f.className,Ve.classList.remove("lower-canvas"),Ve.classList.add("upper-canvas"),Ve.setAttribute("data-fabric","top"),Ve.style.cssText=f.style.cssText,Ve.setAttribute("draggable","true"),Ve}createContainerElement(){const f=m().createElement("div");return f.setAttribute("data-fabric","wrapper"),on(f,{position:"relative"}),he(f),f}applyCanvasStyle(f,Ve){const{styles:Ue,allowTouchScrolling:Je}=Ve;on(f,s(s({},Ue),{},{"touch-action":Je?"manipulation":j})),he(f)}setDimensions(f,Ve){super.setDimensions(f,Ve);const{el:Ue,ctx:Je}=this.upper;oe(Ue,Je,f,Ve)}setCSSDimensions(f){super.setCSSDimensions(f),ae(this.upper.el,f),ae(this.container,f)}cleanupDOM(f){const Ve=this.container,{el:Ue}=this.lower,{el:Je}=this.upper;super.cleanupDOM(f),Ve.removeChild(Je),Ve.removeChild(Ue),Ve.parentNode&&Ve.parentNode.replaceChild(Ue,Ve)}dispose(){super.dispose(),p().dispose(this.upper.el),delete this.upper,delete this.container}}class dn extends ue{constructor(){super(...arguments),t(this,"targets",[]),t(this,"_hoveredTargets",[]),t(this,"_objectsToRender",void 0),t(this,"_currentTransform",null),t(this,"_groupSelector",null),t(this,"contextTopDirty",!1)}static getDefaults(){return s(s({},super.getDefaults()),dn.ownDefaults)}get upperCanvasEl(){var f;return(f=this.elements.upper)===null||f===void 0?void 0:f.el}get contextTop(){var f;return(f=this.elements.upper)===null||f===void 0?void 0:f.ctx}get wrapperEl(){return this.elements.container}initElements(f){this.elements=new un(f,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(f){this._objectsToRender=void 0,super._onObjectAdded(f)}_onObjectRemoved(f){this._objectsToRender=void 0,f===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[f]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[f]}),f.fire("deselected",{target:f})),f===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(f)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const f=this._activeObject;return!this.preserveObjectStacking&&f?this._objects.filter(Ve=>!Ve.group&&Ve!==f).concat(f):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(f){f.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(f),this.contextTopDirty=!0),f.restore()}renderTop(){const f=this.contextTop;this.clearContext(f),this.renderTopLayer(f),this.fire("after:render",{ctx:f})}setTargetFindTolerance(f){f=Math.round(f),this.targetFindTolerance=f;const Ve=this.getRetinaScaling(),Ue=Math.ceil((2*f+1)*Ve);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=Ue,this.pixelFindContext.scale(Ve,Ve)}isTargetTransparent(f,Ve,Ue){const Je=this.targetFindTolerance,Bn=this.pixelFindContext;this.clearContext(Bn),Bn.save(),Bn.translate(-Ve+Je,-Ue+Je),Bn.transform(...this.viewportTransform);const Vn=f.selectionBackgroundColor;f.selectionBackgroundColor="",f.render(Bn),f.selectionBackgroundColor=Vn,Bn.restore();const Nn=Math.round(Je*this.getRetinaScaling());return _i(Bn,Nn,Nn,Nn)}_isSelectionKeyPressed(f){const Ve=this.selectionKey;return!!Ve&&(Array.isArray(Ve)?!!Ve.find(Ue=>!!Ue&&f[Ue]===!0):f[Ve])}_shouldClearSelection(f,Ve){const Ue=this.getActiveObjects(),Je=this._activeObject;return!!(!Ve||Ve&&Je&&Ue.length>1&&Ue.indexOf(Ve)===-1&&Je!==Ve&&!this._isSelectionKeyPressed(f)||Ve&&!Ve.evented||Ve&&!Ve.selectable&&Je&&Je!==Ve)}_shouldCenterTransform(f,Ve,Ue){if(!f)return;let Je;return Ve===H||Ve===G||Ve===N||Ve===Y?Je=this.centeredScaling||f.centeredScaling:Ve===B&&(Je=this.centeredRotation||f.centeredRotation),Je?!Ue:Ue}_getOriginFromCorner(f,Ve){const Ue={x:f.originX,y:f.originY};return Ve&&(["ml","tl","bl"].includes(Ve)?Ue.x=A:["mr","tr","br"].includes(Ve)&&(Ue.x=M),["tl","mt","tr"].includes(Ve)?Ue.y=E:["bl","mb","br"].includes(Ve)&&(Ue.y=P)),Ue}_setupCurrentTransform(f,Ve,Ue){var Je;const Bn=Ve.group?Se(this.getScenePoint(f),void 0,Ve.group.calcTransformMatrix()):this.getScenePoint(f),{key:Vn="",control:Nn}=Ve.getActiveControl()||{},Un=Ue&&Nn?(Je=Nn.getActionHandler(f,Ve,Nn))===null||Je===void 0?void 0:Je.bind(Nn):Ie,qn=((ta,ea,ra,na)=>{if(!ea||!ta)return"drag";const oa=na.controls[ea];return oa.getActionName(ra,oa,na)})(Ue,Vn,f,Ve),qo=f[this.centeredKey],$o=this._shouldCenterTransform(Ve,qn,qo)?{x:D,y:D}:this._getOriginFromCorner(Ve,Vn),Zo={target:Ve,action:qn,actionHandler:Un,actionPerformed:!1,corner:Vn,scaleX:Ve.scaleX,scaleY:Ve.scaleY,skewX:Ve.skewX,skewY:Ve.skewY,offsetX:Bn.x-Ve.left,offsetY:Bn.y-Ve.top,originX:$o.x,originY:$o.y,ex:Bn.x,ey:Bn.y,lastX:Bn.x,lastY:Bn.y,theta:_t(Ve.angle),width:Ve.width,height:Ve.height,shiftKey:f.shiftKey,altKey:qo,original:s(s({},Ce(Ve)),{},{originX:$o.x,originY:$o.y})};this._currentTransform=Zo,this.fire("before:transform",{e:f,transform:Zo})}setCursor(f){this.upperCanvasEl.style.cursor=f}_drawSelection(f){const{x:Ve,y:Ue,deltaX:Je,deltaY:Bn}=this._groupSelector,Vn=new ot(Ve,Ue).transform(this.viewportTransform),Nn=new ot(Ve+Je,Ue+Bn).transform(this.viewportTransform),Un=this.selectionLineWidth/2;let qn=Math.min(Vn.x,Nn.x),qo=Math.min(Vn.y,Nn.y),$o=Math.max(Vn.x,Nn.x),Zo=Math.max(Vn.y,Nn.y);this.selectionColor&&(f.fillStyle=this.selectionColor,f.fillRect(qn,qo,$o-qn,Zo-qo)),this.selectionLineWidth&&this.selectionBorderColor&&(f.lineWidth=this.selectionLineWidth,f.strokeStyle=this.selectionBorderColor,qn+=Un,qo+=Un,$o-=Un,Zo-=Un,yi.prototype._setLineDash.call(this,f,this.selectionDashArray),f.strokeRect(qn,qo,$o-qn,Zo-qo))}findTarget(f){if(this.skipTargetFind)return;const Ve=this.getViewportPoint(f),Ue=this._activeObject,Je=this.getActiveObjects();if(this.targets=[],Ue&&Je.length>=1){if(Ue.findControl(Ve,fe(f))||Je.length>1&&this.searchPossibleTargets([Ue],Ve))return Ue;if(Ue===this.searchPossibleTargets([Ue],Ve)){if(this.preserveObjectStacking){const Bn=this.targets;this.targets=[];const Vn=this.searchPossibleTargets(this._objects,Ve);return f[this.altSelectionKey]&&Vn&&Vn!==Ue?(this.targets=Bn,Ue):Vn}return Ue}}return this.searchPossibleTargets(this._objects,Ve)}_pointIsInObjectSelectionArea(f,Ve){let Ue=f.getCoords();const Je=this.getZoom(),Bn=f.padding/Je;if(Bn){const[Vn,Nn,Un,qn]=Ue,qo=Math.atan2(Nn.y-Vn.y,Nn.x-Vn.x),$o=rt(qo)*Bn,Zo=nt(qo)*Bn,ta=$o+Zo,ea=$o-Zo;Ue=[new ot(Vn.x-ea,Vn.y-ta),new ot(Nn.x+ta,Nn.y-ea),new ot(Un.x+ea,Un.y+ta),new ot(qn.x-ta,qn.y+ea)]}return Fs.isPointInPolygon(Ve,Ue)}_checkTarget(f,Ve){return!!(f&&f.visible&&f.evented&&this._pointIsInObjectSelectionArea(f,Se(Ve,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!f.perPixelTargetFind||f.isEditing||!this.isTargetTransparent(f,Ve.x,Ve.y)))}_searchPossibleTargets(f,Ve){let Ue=f.length;for(;Ue--;){const Je=f[Ue];if(this._checkTarget(Je,Ve)){if(ht(Je)&&Je.subTargetCheck){const Bn=this._searchPossibleTargets(Je._objects,Ve);Bn&&this.targets.push(Bn)}return Je}}}searchPossibleTargets(f,Ve){const Ue=this._searchPossibleTargets(f,Ve);if(Ue&&ht(Ue)&&Ue.interactive&&this.targets[0]){const Je=this.targets;for(let Bn=Je.length-1;Bn>0;Bn--){const Vn=Je[Bn];if(!ht(Vn)||!Vn.interactive)return Vn}return Je[0]}return Ue}getViewportPoint(f){return this._pointer?this._pointer:this.getPointer(f,!0)}getScenePoint(f){return this._absolutePointer?this._absolutePointer:this.getPointer(f)}getPointer(f){let Ve=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const Ue=this.upperCanvasEl,Je=Ue.getBoundingClientRect();let Bn=ge(f),Vn=Je.width||0,Nn=Je.height||0;Vn&&Nn||(P in Je&&E in Je&&(Nn=Math.abs(Je.top-Je.bottom)),A in Je&&M in Je&&(Vn=Math.abs(Je.right-Je.left))),this.calcOffset(),Bn.x=Bn.x-this._offset.left,Bn.y=Bn.y-this._offset.top,Ve||(Bn=Se(Bn,void 0,this.viewportTransform));const Un=this.getRetinaScaling();Un!==1&&(Bn.x/=Un,Bn.y/=Un);const qn=Vn===0||Nn===0?new ot(1,1):new ot(Ue.width/Vn,Ue.height/Nn);return Bn.multiply(qn)}_setDimensionsImpl(f,Ve){this._resetTransformEventData(),super._setDimensionsImpl(f,Ve),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=pt(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const f=this._activeObject;return se(f)?f.getObjects():f?[f]:[]}_fireSelectionEvents(f,Ve){let Ue=!1,Je=!1;const Bn=this.getActiveObjects(),Vn=[],Nn=[];f.forEach(Un=>{Bn.includes(Un)||(Ue=!0,Un.fire("deselected",{e:Ve,target:Un}),Nn.push(Un))}),Bn.forEach(Un=>{f.includes(Un)||(Ue=!0,Un.fire("selected",{e:Ve,target:Un}),Vn.push(Un))}),f.length>0&&Bn.length>0?(Je=!0,Ue&&this.fire("selection:updated",{e:Ve,selected:Vn,deselected:Nn})):Bn.length>0?(Je=!0,this.fire("selection:created",{e:Ve,selected:Vn})):f.length>0&&(Je=!0,this.fire("selection:cleared",{e:Ve,deselected:Nn})),Je&&(this._objectsToRender=void 0)}setActiveObject(f,Ve){const Ue=this.getActiveObjects(),Je=this._setActiveObject(f,Ve);return this._fireSelectionEvents(Ue,Ve),Je}_setActiveObject(f,Ve){const Ue=this._activeObject;return Ue!==f&&!(!this._discardActiveObject(Ve,f)&&this._activeObject)&&!f.onSelect({e:Ve})&&(this._activeObject=f,se(f)&&Ue!==f&&f.set("canvas",this),f.setCoords(),!0)}_discardActiveObject(f,Ve){const Ue=this._activeObject;return!!Ue&&!Ue.onDeselect({e:f,object:Ve})&&(this._currentTransform&&this._currentTransform.target===Ue&&this.endCurrentTransform(f),se(Ue)&&Ue===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(f){const Ve=this.getActiveObjects(),Ue=this.getActiveObject();Ve.length&&this.fire("before:selection:cleared",{e:f,deselected:[Ue]});const Je=this._discardActiveObject(f);return this._fireSelectionEvents(Ve,f),Je}endCurrentTransform(f){const Ve=this._currentTransform;this._finalizeCurrentTransform(f),Ve&&Ve.target&&(Ve.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(f){const Ve=this._currentTransform,Ue=Ve.target,Je={e:f,target:Ue,transform:Ve,action:Ve.action};Ue._scaling&&(Ue._scaling=!1),Ue.setCoords(),Ve.actionPerformed&&(this.fire("object:modified",Je),Ue.fire(Q,Je))}setViewportTransform(f){super.setViewportTransform(f);const Ve=this._activeObject;Ve&&Ve.setCoords()}destroy(){const f=this._activeObject;se(f)&&(f.removeAll(),f.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(f){const Ve=this._activeObject;Ve&&Ve._renderControls(f)}_toObject(f,Ve,Ue){const Je=this._realizeGroupTransformOnObject(f),Bn=super._toObject(f,Ve,Ue);return f.set(Je),Bn}_realizeGroupTransformOnObject(f){const{group:Ve}=f;if(Ve&&se(Ve)&&this._activeObject===Ve){const Ue=Xt(f,["angle","flipX","flipY",M,G,N,U,q,P]);return ye(f,Ve.calcOwnMatrix()),Ue}return{}}_setSVGObject(f,Ve,Ue){const Je=this._realizeGroupTransformOnObject(Ve);super._setSVGObject(f,Ve,Ue),Ve.set(Je)}}t(dn,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class gn{constructor(f){t(this,"targets",[]),t(this,"__disposer",void 0);const Ve=()=>{const{hiddenTextarea:Je}=f.getActiveObject()||{};Je&&Je.focus()},Ue=f.upperCanvasEl;Ue.addEventListener("click",Ve),this.__disposer=()=>Ue.removeEventListener("click",Ve)}exitTextEditing(){this.target=void 0,this.targets.forEach(f=>{f.isEditing&&f.exitEditing()})}add(f){this.targets.push(f)}remove(f){this.unregister(f),it(this.targets,f)}register(f){this.target=f}unregister(f){f===this.target&&(this.target=void 0)}onMouseMove(f){var Ve;!((Ve=this.target)===null||Ve===void 0)&&Ve.isEditing&&this.target.updateSelectionOnMouseMove(f)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const fn=["target","oldTarget","fireCanvas","e"],pn={passive:!1},mn=(qe,f)=>{const Ve=qe.getViewportPoint(f),Ue=qe.getScenePoint(f);return{viewportPoint:Ve,scenePoint:Ue,pointer:Ve,absolutePointer:Ue}},vn=function(qe){for(var f=arguments.length,Ve=new Array(f>1?f-1:0),Ue=1;Ue<f;Ue++)Ve[Ue-1]=arguments[Ue];return qe.addEventListener(...Ve)},yn=function(qe){for(var f=arguments.length,Ve=new Array(f>1?f-1:0),Ue=1;Ue<f;Ue++)Ve[Ue-1]=arguments[Ue];return qe.removeEventListener(...Ve)},_n={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class xn extends dn{constructor(f){super(f,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),t(this,"_isClick",void 0),t(this,"textEditingManager",new gn(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(Ve=>{this[Ve]=this[Ve].bind(this)}),this.addOrRemove(vn,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(f,Ve){const Ue=this.upperCanvasEl,Je=this._getEventPrefix();f(ne(Ue),"resize",this._onResize),f(Ue,Je+"down",this._onMouseDown),f(Ue,"".concat(Je,"move"),this._onMouseMove,pn),f(Ue,"".concat(Je,"out"),this._onMouseOut),f(Ue,"".concat(Je,"enter"),this._onMouseEnter),f(Ue,"wheel",this._onMouseWheel),f(Ue,"contextmenu",this._onContextMenu),f(Ue,"dblclick",this._onDoubleClick),f(Ue,"dragstart",this._onDragStart),f(Ue,"dragend",this._onDragEnd),f(Ue,"dragover",this._onDragOver),f(Ue,"dragenter",this._onDragEnter),f(Ue,"dragleave",this._onDragLeave),f(Ue,"drop",this._onDrop),this.enablePointerEvents||f(Ue,"touchstart",this._onTouchStart,pn)}removeListeners(){this.addOrRemove(yn,"remove");const f=this._getEventPrefix(),Ve=re(this.upperCanvasEl);yn(Ve,"".concat(f,"up"),this._onMouseUp),yn(Ve,"touchend",this._onTouchEnd,pn),yn(Ve,"".concat(f,"move"),this._onMouseMove,pn),yn(Ve,"touchmove",this._onMouseMove,pn),clearTimeout(this._willAddMouseDown)}_onMouseWheel(f){this.__onMouseWheel(f)}_onMouseOut(f){const Ve=this._hoveredTarget,Ue=s({e:f},mn(this,f));this.fire("mouse:out",s(s({},Ue),{},{target:Ve})),this._hoveredTarget=void 0,Ve&&Ve.fire("mouseout",s({},Ue)),this._hoveredTargets.forEach(Je=>{this.fire("mouse:out",s(s({},Ue),{},{target:Je})),Je&&Je.fire("mouseout",s({},Ue))}),this._hoveredTargets=[]}_onMouseEnter(f){this._currentTransform||this.findTarget(f)||(this.fire("mouse:over",s({e:f},mn(this,f))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(f){this._isClick=!1;const Ve=this.getActiveObject();if(Ve&&Ve.onDragStart(f)){this._dragSource=Ve;const Ue={e:f,target:Ve};return this.fire("dragstart",Ue),Ve.fire("dragstart",Ue),void vn(this.upperCanvasEl,"drag",this._onDragProgress)}pe(f)}_renderDragEffects(f,Ve,Ue){let Je=!1;const Bn=this._dropTarget;Bn&&Bn!==Ve&&Bn!==Ue&&(Bn.clearContextTop(),Je=!0),Ve==null||Ve.clearContextTop(),Ue!==Ve&&(Ue==null||Ue.clearContextTop());const Vn=this.contextTop;Vn.save(),Vn.transform(...this.viewportTransform),Ve&&(Vn.save(),Ve.transform(Vn),Ve.renderDragSourceEffect(f),Vn.restore(),Je=!0),Ue&&(Vn.save(),Ue.transform(Vn),Ue.renderDropTargetEffect(f),Vn.restore(),Je=!0),Vn.restore(),Je&&(this.contextTopDirty=!0)}_onDragEnd(f){const Ve=!!f.dataTransfer&&f.dataTransfer.dropEffect!==j,Ue=Ve?this._activeObject:void 0,Je={e:f,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:Ve,dropTarget:Ue};yn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",Je),this._dragSource&&this._dragSource.fire("dragend",Je),delete this._dragSource,this._onMouseUp(f)}_onDragProgress(f){const Ve={e:f,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",Ve),this._dragSource&&this._dragSource.fire("drag",Ve)}findDragTargets(f){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(f)),targets:[...this.targets]}}_onDragOver(f){const Ve="dragover",{target:Ue,targets:Je}=this.findDragTargets(f),Bn=this._dragSource,Vn={e:f,target:Ue,subTargets:Je,dragSource:Bn,canDrop:!1,dropTarget:void 0};let Nn;this.fire(Ve,Vn),this._fireEnterLeaveEvents(Ue,Vn),Ue&&(Ue.canDrop(f)&&(Nn=Ue),Ue.fire(Ve,Vn));for(let Un=0;Un<Je.length;Un++){const qn=Je[Un];qn.canDrop(f)&&(Nn=qn),qn.fire(Ve,Vn)}this._renderDragEffects(f,Bn,Nn),this._dropTarget=Nn}_onDragEnter(f){const{target:Ve,targets:Ue}=this.findDragTargets(f),Je={e:f,target:Ve,subTargets:Ue,dragSource:this._dragSource};this.fire("dragenter",Je),this._fireEnterLeaveEvents(Ve,Je)}_onDragLeave(f){const Ve={e:f,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",Ve),this._fireEnterLeaveEvents(void 0,Ve),this._renderDragEffects(f,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(f){const{target:Ve,targets:Ue}=this.findDragTargets(f),Je=this._basicEventHandler("drop:before",s({e:f,target:Ve,subTargets:Ue,dragSource:this._dragSource},mn(this,f)));Je.didDrop=!1,Je.dropTarget=void 0,this._basicEventHandler("drop",Je),this.fire("drop:after",Je)}_onContextMenu(f){const Ve=this.findTarget(f),Ue=this.targets||[],Je=this._basicEventHandler("contextmenu:before",{e:f,target:Ve,subTargets:Ue});return this.stopContextMenu&&pe(f),this._basicEventHandler("contextmenu",Je),!1}_onDoubleClick(f){this._cacheTransformEventData(f),this._handleEvent(f,"dblclick"),this._resetTransformEventData()}getPointerId(f){const Ve=f.changedTouches;return Ve?Ve[0]&&Ve[0].identifier:this.enablePointerEvents?f.pointerId:-1}_isMainEvent(f){return f.isPrimary===!0||f.isPrimary!==!1&&(f.type==="touchend"&&f.touches.length===0||!f.changedTouches||f.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(f){let Ve=!this.allowTouchScrolling;const Ue=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(f)),this.__onMouseDown(f),(this.isDrawingMode||Ue&&this._target===Ue)&&(Ve=!0),Ve&&f.preventDefault(),this._resetTransformEventData();const Je=this.upperCanvasEl,Bn=this._getEventPrefix(),Vn=re(Je);vn(Vn,"touchend",this._onTouchEnd,pn),Ve&&vn(Vn,"touchmove",this._onMouseMove,pn),yn(Je,"".concat(Bn,"down"),this._onMouseDown)}_onMouseDown(f){this.__onMouseDown(f),this._resetTransformEventData();const Ve=this.upperCanvasEl,Ue=this._getEventPrefix();yn(Ve,"".concat(Ue,"move"),this._onMouseMove,pn);const Je=re(Ve);vn(Je,"".concat(Ue,"up"),this._onMouseUp),vn(Je,"".concat(Ue,"move"),this._onMouseMove,pn)}_onTouchEnd(f){if(f.touches.length>0)return;this.__onMouseUp(f),this._resetTransformEventData(),delete this.mainTouchId;const Ve=this._getEventPrefix(),Ue=re(this.upperCanvasEl);yn(Ue,"touchend",this._onTouchEnd,pn),yn(Ue,"touchmove",this._onMouseMove,pn),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{vn(this.upperCanvasEl,"".concat(Ve,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(f){this.__onMouseUp(f),this._resetTransformEventData();const Ve=this.upperCanvasEl,Ue=this._getEventPrefix();if(this._isMainEvent(f)){const Je=re(this.upperCanvasEl);yn(Je,"".concat(Ue,"up"),this._onMouseUp),yn(Je,"".concat(Ue,"move"),this._onMouseMove,pn),vn(Ve,"".concat(Ue,"move"),this._onMouseMove,pn)}}_onMouseMove(f){const Ve=this.getActiveObject();!this.allowTouchScrolling&&(!Ve||!Ve.shouldStartDragging(f))&&f.preventDefault&&f.preventDefault(),this.__onMouseMove(f)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(f){const Ve=this.getActiveObject();return!!Ve!=!!f||Ve&&f&&Ve!==f}__onMouseUp(f){var Ve;this._cacheTransformEventData(f),this._handleEvent(f,"up:before");const Ue=this._currentTransform,Je=this._isClick,Bn=this._target,{button:Vn}=f;if(Vn)return(this.fireMiddleClick&&Vn===1||this.fireRightClick&&Vn===2)&&this._handleEvent(f,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(f);if(!this._isMainEvent(f))return;let Nn,Un,qn=!1;if(Ue&&(this._finalizeCurrentTransform(f),qn=Ue.actionPerformed),!Je){const qo=Bn===this._activeObject;this.handleSelection(f),qn||(qn=this._shouldRender(Bn)||!qo&&Bn===this._activeObject)}if(Bn){const qo=Bn.findControl(this.getViewportPoint(f),fe(f)),{key:$o,control:Zo}=qo||{};if(Un=$o,Bn.selectable&&Bn!==this._activeObject&&Bn.activeOn==="up")this.setActiveObject(Bn,f),qn=!0;else if(Zo){const ta=Zo.getMouseUpHandler(f,Bn,Zo);ta&&(Nn=this.getScenePoint(f),ta.call(Zo,f,Ue,Nn.x,Nn.y))}Bn.isMoving=!1}if(Ue&&(Ue.target!==Bn||Ue.corner!==Un)){const qo=Ue.target&&Ue.target.controls[Ue.corner],$o=qo&&qo.getMouseUpHandler(f,Ue.target,qo);Nn=Nn||this.getScenePoint(f),$o&&$o.call(qo,f,Ue,Nn.x,Nn.y)}this._setCursorFromEvent(f,Bn),this._handleEvent(f,"up"),this._groupSelector=null,this._currentTransform=null,Bn&&(Bn.__corner=void 0),qn?this.requestRenderAll():Je||(Ve=this._activeObject)!==null&&Ve!==void 0&&Ve.isEditing||this.renderTop()}_basicEventHandler(f,Ve){const{target:Ue,subTargets:Je=[]}=Ve;this.fire(f,Ve),Ue&&Ue.fire(f,Ve);for(let Bn=0;Bn<Je.length;Bn++)Je[Bn]!==Ue&&Je[Bn].fire(f,Ve);return Ve}_handleEvent(f,Ve){const Ue=this._target,Je=this.targets||[],Bn=s(s({e:f,target:Ue,subTargets:Je},mn(this,f)),{},{transform:this._currentTransform},Ve==="up:before"||Ve==="up"?{isClick:this._isClick,currentTarget:this.findTarget(f),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(Ve),Bn),Ue&&Ue.fire("mouse".concat(Ve),Bn);for(let Vn=0;Vn<Je.length;Vn++)Je[Vn]!==Ue&&Je[Vn].fire("mouse".concat(Ve),Bn)}_onMouseDownInDrawingMode(f){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(f),this.requestRenderAll());const Ve=this.getScenePoint(f);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(Ve,{e:f,pointer:Ve}),this._handleEvent(f,"down")}_onMouseMoveInDrawingMode(f){if(this._isCurrentlyDrawing){const Ve=this.getScenePoint(f);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(Ve,{e:f,pointer:Ve})}this.setCursor(this.freeDrawingCursor),this._handleEvent(f,"move")}_onMouseUpInDrawingMode(f){const Ve=this.getScenePoint(f);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:f,pointer:Ve}):this._isCurrentlyDrawing=!1,this._handleEvent(f,"up")}__onMouseDown(f){this._isClick=!0,this._cacheTransformEventData(f),this._handleEvent(f,"down:before");let Ve=this._target;const{button:Ue}=f;if(Ue)return(this.fireMiddleClick&&Ue===1||this.fireRightClick&&Ue===2)&&this._handleEvent(f,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(f);if(!this._isMainEvent(f)||this._currentTransform)return;let Je=this._shouldRender(Ve),Bn=!1;if(this.handleMultiSelection(f,Ve)?(Ve=this._activeObject,Bn=!0,Je=!0):this._shouldClearSelection(f,Ve)&&this.discardActiveObject(f),this.selection&&(!Ve||!Ve.selectable&&!Ve.isEditing&&Ve!==this._activeObject)){const Vn=this.getScenePoint(f);this._groupSelector={x:Vn.x,y:Vn.y,deltaY:0,deltaX:0}}if(Ve){const Vn=Ve===this._activeObject;Ve.selectable&&Ve.activeOn==="down"&&this.setActiveObject(Ve,f);const Nn=Ve.findControl(this.getViewportPoint(f),fe(f));if(Ve===this._activeObject&&(Nn||!Bn)){this._setupCurrentTransform(f,Ve,Vn);const Un=Nn?Nn.control:void 0,qn=this.getScenePoint(f),qo=Un&&Un.getMouseDownHandler(f,Ve,Un);qo&&qo.call(Un,f,this._currentTransform,qn.x,qn.y)}}Je&&(this._objectsToRender=void 0),this._handleEvent(f,"down"),Je&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(f){this._resetTransformEventData(),this._pointer=this.getViewportPoint(f),this._absolutePointer=Se(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(f)}__onMouseMove(f){if(this._isClick=!1,this._cacheTransformEventData(f),this._handleEvent(f,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(f);if(!this._isMainEvent(f))return;const Ve=this._groupSelector;if(Ve){const Ue=this.getScenePoint(f);Ve.deltaX=Ue.x-Ve.x,Ve.deltaY=Ue.y-Ve.y,this.renderTop()}else if(this._currentTransform)this._transformObject(f);else{const Ue=this.findTarget(f);this._setCursorFromEvent(f,Ue),this._fireOverOutEvents(f,Ue)}this.textEditingManager.onMouseMove(f),this._handleEvent(f,"move"),this._resetTransformEventData()}_fireOverOutEvents(f,Ve){const Ue=this._hoveredTarget,Je=this._hoveredTargets,Bn=this.targets,Vn=Math.max(Je.length,Bn.length);this.fireSyntheticInOutEvents("mouse",{e:f,target:Ve,oldTarget:Ue,fireCanvas:!0});for(let Nn=0;Nn<Vn;Nn++)this.fireSyntheticInOutEvents("mouse",{e:f,target:Bn[Nn],oldTarget:Je[Nn]});this._hoveredTarget=Ve,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(f,Ve){const Ue=this._draggedoverTarget,Je=this._hoveredTargets,Bn=this.targets,Vn=Math.max(Je.length,Bn.length);this.fireSyntheticInOutEvents("drag",s(s({},Ve),{},{target:f,oldTarget:Ue,fireCanvas:!0}));for(let Nn=0;Nn<Vn;Nn++)this.fireSyntheticInOutEvents("drag",s(s({},Ve),{},{target:Bn[Nn],oldTarget:Je[Nn]}));this._draggedoverTarget=f}fireSyntheticInOutEvents(f,Ve){let{target:Ue,oldTarget:Je,fireCanvas:Bn,e:Vn}=Ve,Nn=i(Ve,fn);const{targetIn:Un,targetOut:qn,canvasIn:qo,canvasOut:$o}=_n[f],Zo=Je!==Ue;if(Je&&Zo){const ta=s(s({},Nn),{},{e:Vn,target:Je,nextTarget:Ue},mn(this,Vn));Bn&&this.fire($o,ta),Je.fire(qn,ta)}if(Ue&&Zo){const ta=s(s({},Nn),{},{e:Vn,target:Ue,previousTarget:Je},mn(this,Vn));Bn&&this.fire(qo,ta),Ue.fire(Un,ta)}}__onMouseWheel(f){this._cacheTransformEventData(f),this._handleEvent(f,"wheel"),this._resetTransformEventData()}_transformObject(f){const Ve=this.getScenePoint(f),Ue=this._currentTransform,Je=Ue.target,Bn=Je.group?Se(Ve,void 0,Je.group.calcTransformMatrix()):Ve;Ue.shiftKey=f.shiftKey,Ue.altKey=!!this.centeredKey&&f[this.centeredKey],this._performTransformAction(f,Ue,Bn),Ue.actionPerformed&&this.requestRenderAll()}_performTransformAction(f,Ve,Ue){const{action:Je,actionHandler:Bn,target:Vn}=Ve,Nn=!!Bn&&Bn(f,Ve,Ue.x,Ue.y);Nn&&Vn.setCoords(),Je==="drag"&&Nn&&(Ve.target.isMoving=!0,this.setCursor(Ve.target.moveCursor||this.moveCursor)),Ve.actionPerformed=Ve.actionPerformed||Nn}_setCursorFromEvent(f,Ve){if(!Ve)return void this.setCursor(this.defaultCursor);let Ue=Ve.hoverCursor||this.hoverCursor;const Je=se(this._activeObject)?this._activeObject:null,Bn=(!Je||Ve.group!==Je)&&Ve.findControl(this.getViewportPoint(f));if(Bn){const Vn=Bn.control;this.setCursor(Vn.cursorStyleHandler(f,Vn,Ve))}else Ve.subTargetCheck&&this.targets.concat().reverse().map(Vn=>{Ue=Vn.hoverCursor||Ue}),this.setCursor(Ue)}handleMultiSelection(f,Ve){const Ue=this._activeObject,Je=se(Ue);if(Ue&&this._isSelectionKeyPressed(f)&&this.selection&&Ve&&Ve.selectable&&(Ue!==Ve||Je)&&(Je||!Ve.isDescendantOf(Ue)&&!Ue.isDescendantOf(Ve))&&!Ve.onSelect({e:f})&&!Ue.getActiveControl()){if(Je){const Bn=Ue.getObjects();if(Ve===Ue){const Vn=this.getViewportPoint(f);if(!(Ve=this.searchPossibleTargets(Bn,Vn)||this.searchPossibleTargets(this._objects,Vn))||!Ve.selectable)return!1}Ve.group===Ue?(Ue.remove(Ve),this._hoveredTarget=Ve,this._hoveredTargets=[...this.targets],Ue.size()===1&&this._setActiveObject(Ue.item(0),f)):(Ue.multiSelectAdd(Ve),this._hoveredTarget=Ue,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(Bn,f)}else{Ue.isEditing&&Ue.exitEditing();const Bn=new(tt.getClass("ActiveSelection"))([],{canvas:this});Bn.multiSelectAdd(Ue,Ve),this._hoveredTarget=Bn,this._setActiveObject(Bn,f),this._fireSelectionEvents([Ue],f)}return!0}return!1}handleSelection(f){if(!this.selection||!this._groupSelector)return!1;const{x:Ve,y:Ue,deltaX:Je,deltaY:Bn}=this._groupSelector,Vn=new ot(Ve,Ue),Nn=Vn.add(new ot(Je,Bn)),Un=Vn.min(Nn),qn=Vn.max(Nn).subtract(Un),qo=this.collectObjects({left:Un.x,top:Un.y,width:qn.x,height:qn.y},{includeIntersecting:!this.selectionFullyContained}),$o=Vn.eq(Nn)?qo[0]?[qo[0]]:[]:qo.length>1?qo.filter(Zo=>!Zo.onSelect({e:f})).reverse():qo;if($o.length===1)this.setActiveObject($o[0],f);else if($o.length>1){const Zo=tt.getClass("ActiveSelection");this.setActiveObject(new Zo($o,{canvas:this}),f)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Cn={x1:0,y1:0,x2:0,y2:0},bn=s(s({},Cn),{},{r1:0,r2:0}),wn=(qe,f)=>isNaN(qe)&&typeof f=="number"?f:qe,Sn=/^(\d+\.\d+)%|(\d+)%$/;function Tn(qe){return qe&&Sn.test(qe)}function On(qe,f){const Ve=typeof qe=="number"?qe:typeof qe=="string"?parseFloat(qe)/(Tn(qe)?100:1):NaN;return ds(0,wn(Ve,f),1)}const kn=/\s*;\s*/,Dn=/\s*:\s*/;function Mn(qe,f){let Ve,Ue;const Je=qe.getAttribute("style");if(Je){const Vn=Je.split(kn);Vn[Vn.length-1]===""&&Vn.pop();for(let Nn=Vn.length;Nn--;){const[Un,qn]=Vn[Nn].split(Dn).map(qo=>qo.trim());Un==="stop-color"?Ve=qn:Un==="stop-opacity"&&(Ue=qn)}}const Bn=new Ut(Ve||qe.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:On(qe.getAttribute("offset"),0),color:Bn.toRgb(),opacity:wn(parseFloat(Ue||qe.getAttribute("stop-opacity")||""),1)*Bn.getAlpha()*f}}function Pn(qe,f){const Ve=[],Ue=qe.getElementsByTagName("stop"),Je=On(f,1);for(let Bn=Ue.length;Bn--;)Ve.push(Mn(Ue[Bn],Je));return Ve}function En(qe){return qe.nodeName==="linearGradient"||qe.nodeName==="LINEARGRADIENT"?"linear":"radial"}function An(qe){return qe.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function jn(qe,f){return qe.getAttribute(f)}function Fn(qe,f){return function(Ve,Ue){let Je,{width:Bn,height:Vn,gradientUnits:Nn}=Ue;return Object.keys(Ve).reduce((Un,qn)=>{const qo=Ve[qn];return qo==="Infinity"?Je=1:qo==="-Infinity"?Je=0:(Je=typeof qo=="string"?parseFloat(qo):qo,typeof qo=="string"&&Tn(qo)&&(Je*=.01,Nn==="pixels"&&(qn!=="x1"&&qn!=="x2"&&qn!=="r2"||(Je*=Bn),qn!=="y1"&&qn!=="y2"||(Je*=Vn)))),Un[qn]=Je,Un},{})}(En(qe)==="linear"?function(Ve){return{x1:jn(Ve,"x1")||0,y1:jn(Ve,"y1")||0,x2:jn(Ve,"x2")||"100%",y2:jn(Ve,"y2")||0}}(qe):function(Ve){return{x1:jn(Ve,"fx")||jn(Ve,"cx")||"50%",y1:jn(Ve,"fy")||jn(Ve,"cy")||"50%",r1:0,x2:jn(Ve,"cx")||"50%",y2:jn(Ve,"cy")||"50%",r2:jn(Ve,"r")||"50%"}}(qe),s(s({},f),{},{gradientUnits:An(qe)}))}class Ln{constructor(f){const{type:Ve="linear",gradientUnits:Ue="pixels",coords:Je={},colorStops:Bn=[],offsetX:Vn=0,offsetY:Nn=0,gradientTransform:Un,id:qn}=f||{};Object.assign(this,{type:Ve,gradientUnits:Ue,coords:s(s({},Ve==="radial"?bn:Cn),Je),colorStops:Bn,offsetX:Vn,offsetY:Nn,gradientTransform:Un,id:qn?"".concat(qn,"_").concat(ft()):ft()})}addColorStop(f){for(const Ve in f){const Ue=new Ut(f[Ve]);this.colorStops.push({offset:parseFloat(Ve),color:Ue.toRgb(),opacity:Ue.getAlpha()})}return this}toObject(f){return s(s({},Xt(this,f)),{},{type:this.type,coords:s({},this.coords),colorStops:this.colorStops.map(Ve=>s({},Ve)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(f){let{additionalTransform:Ve}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const Ue=[],Je=this.gradientTransform?this.gradientTransform.concat():T.concat(),Bn=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",Vn=this.colorStops.map($o=>s({},$o)).sort(($o,Zo)=>$o.offset-Zo.offset);let Nn=-this.offsetX,Un=-this.offsetY;var qn;Bn==="objectBoundingBox"?(Nn/=f.width,Un/=f.height):(Nn+=f.width/2,Un+=f.height/2),(qn=f)&&typeof qn._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(Nn-=f.pathOffset.x,Un-=f.pathOffset.y),Je[4]-=Nn,Je[5]-=Un;const qo=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(Bn,'"'),'gradientTransform="'.concat(Ve?Ve+" ":"").concat(Qt(Je),'"'),""].join(" ");if(this.type==="linear"){const{x1:$o,y1:Zo,x2:ta,y2:ea}=this.coords;Ue.push("<linearGradient ",qo,' x1="',$o,'" y1="',Zo,'" x2="',ta,'" y2="',ea,`">
`)}else if(this.type==="radial"){const{x1:$o,y1:Zo,x2:ta,y2:ea,r1:ra,r2:na}=this.coords,oa=ra>na;Ue.push("<radialGradient ",qo,' cx="',oa?$o:ta,'" cy="',oa?Zo:ea,'" r="',oa?ra:na,'" fx="',oa?ta:$o,'" fy="',oa?ea:Zo,`">
`),oa&&(Vn.reverse(),Vn.forEach(pa=>{pa.offset=1-pa.offset}));const ca=Math.min(ra,na);if(ca>0){const pa=ca/Math.max(ra,na);Vn.forEach(la=>{la.offset+=pa*(1-la.offset)})}}return Vn.forEach($o=>{let{color:Zo,offset:ta,opacity:ea}=$o;Ue.push("<stop ",'offset="',100*ta+"%",'" style="stop-color:',Zo,ea!==void 0?";stop-opacity: "+ea:";",`"/>
`)}),Ue.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),Ue.join("")}toLive(f){const{x1:Ve,y1:Ue,x2:Je,y2:Bn,r1:Vn,r2:Nn}=this.coords,Un=this.type==="linear"?f.createLinearGradient(Ve,Ue,Je,Bn):f.createRadialGradient(Ve,Ue,Vn,Je,Bn,Nn);return this.colorStops.forEach(qn=>{let{color:qo,opacity:$o,offset:Zo}=qn;Un.addColorStop(Zo,$o!==void 0?new Ut(qo).setAlpha($o).toRgba():qo)}),Un}static async fromObject(f){const{colorStops:Ve,gradientTransform:Ue}=f;return new this(s(s({},f),{},{colorStops:Ve?Ve.map(Je=>s({},Je)):void 0,gradientTransform:Ue?[...Ue]:void 0}))}static fromElement(f,Ve,Ue){const Je=An(f),Bn=Ve._findCenterFromElement();return new this(s({id:f.getAttribute("id")||void 0,type:En(f),coords:Fn(f,{width:Ue.viewBoxWidth||Ue.width,height:Ue.viewBoxHeight||Ue.height}),colorStops:Pn(f,Ue.opacity),gradientUnits:Je,gradientTransform:nr(f.getAttribute("gradientTransform")||"")},Je==="pixels"?{offsetX:Ve.width/2-Bn.x,offsetY:Ve.height/2-Bn.y}:{offsetX:0,offsetY:0}))}}t(Ln,"type","Gradient"),tt.setClass(Ln,"gradient"),tt.setClass(Ln,"linear"),tt.setClass(Ln,"radial");const Rn=["type","source","patternTransform"];class In{get type(){return"pattern"}set type(f){a("warn","Setting type has no effect",f)}constructor(f){t(this,"repeat","repeat"),t(this,"offsetX",0),t(this,"offsetY",0),t(this,"crossOrigin",""),this.id=ft(),Object.assign(this,f)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(f){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?f.createPattern(this.source,this.repeat):null}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:Ve,crossOrigin:Ue}=this;return s(s({},Xt(this,f)),{},{type:"pattern",source:this.sourceToString(),repeat:Ve,crossOrigin:Ue,offsetX:qt(this.offsetX,o.NUM_FRACTION_DIGITS),offsetY:qt(this.offsetY,o.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(f){let{width:Ve,height:Ue}=f;const{source:Je,repeat:Bn,id:Vn}=this,Nn=wn(this.offsetX/Ve,0),Un=wn(this.offsetY/Ue,0),qn=Bn==="repeat-y"||Bn==="no-repeat"?1+Math.abs(Nn||0):wn(Je.width/Ve,0),qo=Bn==="repeat-x"||Bn==="no-repeat"?1+Math.abs(Un||0):wn(Je.height/Ue,0);return['<pattern id="SVGID_'.concat(Vn,'" x="').concat(Nn,'" y="').concat(Un,'" width="').concat(qn,'" height="').concat(qo,'">'),'<image x="0" y="0" width="'.concat(Je.width,'" height="').concat(Je.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(f,Ve){let{type:Ue,source:Je,patternTransform:Bn}=f,Vn=i(f,Rn);const Nn=await Rt(Je,s(s({},Ve),{},{crossOrigin:Vn.crossOrigin}));return new this(s(s({},Vn),{},{patternTransform:Bn&&Bn.slice(0),source:Nn}))}}t(In,"type","Pattern"),tt.setClass(In),tt.setClass(In,"pattern");const Xn=["path","left","top"],Yn=["d"];class Wn extends yi{constructor(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:Ue,left:Je,top:Bn}=Ve,Vn=i(Ve,Xn);super(),Object.assign(this,Wn.ownDefaults),this.setOptions(Vn),this._setPath(f||[],!0),typeof Je=="number"&&this.set(M,Je),typeof Bn=="number"&&this.set(P,Bn)}_setPath(f,Ve){this.path=Xr(Array.isArray(f)?f:sn(f)),this.setBoundingBox(Ve)}_findCenterFromElement(){const f=this._calcBoundsFromPath();return new ot(f.left+f.width/2,f.top+f.height/2)}_renderPathCommands(f){const Ve=-this.pathOffset.x,Ue=-this.pathOffset.y;f.beginPath();for(const Je of this.path)switch(Je[0]){case"L":f.lineTo(Je[1]+Ve,Je[2]+Ue);break;case"M":f.moveTo(Je[1]+Ve,Je[2]+Ue);break;case"C":f.bezierCurveTo(Je[1]+Ve,Je[2]+Ue,Je[3]+Ve,Je[4]+Ue,Je[5]+Ve,Je[6]+Ue);break;case"Q":f.quadraticCurveTo(Je[1]+Ve,Je[2]+Ue,Je[3]+Ve,Je[4]+Ue);break;case"Z":f.closePath()}}_render(f){this._renderPathCommands(f),this._renderPaintInOrder(f)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return s(s({},super.toObject(f)),{},{path:this.path.map(Ve=>Ve.slice())})}toDatalessObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const Ve=this.toObject(f);return this.sourcePath&&(delete Ve.path,Ve.sourcePath=this.sourcePath),Ve}_toSVG(){const f=nn(this.path,o.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(f,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const f=o.NUM_FRACTION_DIGITS;return" translate(".concat(qt(-this.pathOffset.x,f),", ").concat(qt(-this.pathOffset.y,f),")")}toClipPathSVG(f){const Ve=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:f,additionalTransform:Ve})}toSVG(f){const Ve=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:f,additionalTransform:Ve})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(f){const{width:Ve,height:Ue,pathOffset:Je}=this._calcDimensions();this.set({width:Ve,height:Ue,pathOffset:Je}),f&&this.setPositionByOrigin(Je,D,D)}_calcBoundsFromPath(){const f=[];let Ve=0,Ue=0,Je=0,Bn=0;for(const Vn of this.path)switch(Vn[0]){case"L":Je=Vn[1],Bn=Vn[2],f.push({x:Ve,y:Ue},{x:Je,y:Bn});break;case"M":Je=Vn[1],Bn=Vn[2],Ve=Je,Ue=Bn;break;case"C":f.push(...Ir(Je,Bn,Vn[1],Vn[2],Vn[3],Vn[4],Vn[5],Vn[6])),Je=Vn[5],Bn=Vn[6];break;case"Q":f.push(...Ir(Je,Bn,Vn[1],Vn[2],Vn[1],Vn[2],Vn[3],Vn[4])),Je=Vn[3],Bn=Vn[4];break;case"Z":Je=Ve,Bn=Ue}return me(f)}_calcDimensions(){const f=this._calcBoundsFromPath();return s(s({},f),{},{pathOffset:new ot(f.left+f.width/2,f.top+f.height/2)})}static fromObject(f){return this._fromObject(f,{extraParam:"path"})}static async fromElement(f,Ve,Ue){const Je=ur(f,this.ATTRIBUTE_NAMES,Ue),{d:Bn}=Je;return new this(Bn,s(s(s({},i(Je,Yn)),Ve),{},{left:void 0,top:void 0}))}}t(Wn,"type","Path"),t(Wn,"cacheProperties",[...fs,"path","fillRule"]),t(Wn,"ATTRIBUTE_NAMES",[...ji,"d"]),tt.setClass(Wn),tt.setSVGClass(Wn);const zn=["left","top","radius"],Hn=["radius","startAngle","endAngle","counterClockwise"];class Gn extends yi{static getDefaults(){return s(s({},super.getDefaults()),Gn.ownDefaults)}constructor(f){super(),Object.assign(this,Gn.ownDefaults),this.setOptions(f)}_set(f,Ve){return super._set(f,Ve),f==="radius"&&this.setRadius(Ve),this}_render(f){f.beginPath(),f.arc(0,0,this.radius,_t(this.startAngle),_t(this.endAngle),this.counterClockwise),this._renderPaintInOrder(f)}getRadiusX(){return this.get("radius")*this.get(G)}getRadiusY(){return this.get("radius")*this.get(N)}setRadius(f){this.radius=f,this.set({width:2*f,height:2*f})}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Hn,...f])}_toSVG(){const f=(this.endAngle-this.startAngle)%360;if(f===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:Ve}=this,Ue=_t(this.startAngle),Je=_t(this.endAngle),Bn=rt(Ue)*Ve,Vn=nt(Ue)*Ve,Nn=rt(Je)*Ve,Un=nt(Je)*Ve,qn=f>180?1:0,qo=this.counterClockwise?0:1;return['<path d="M '.concat(Bn," ").concat(Vn," A ").concat(Ve," ").concat(Ve," 0 ").concat(qn," ").concat(qo," ").concat(Nn," ").concat(Un,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(f,Ve,Ue){const Je=ur(f,this.ATTRIBUTE_NAMES,Ue),{left:Bn=0,top:Vn=0,radius:Nn=0}=Je;return new this(s(s({},i(Je,zn)),{},{radius:Nn,left:Bn-Nn,top:Vn-Nn}))}static fromObject(f){return super._fromObject(f)}}t(Gn,"type","Circle"),t(Gn,"cacheProperties",[...fs,...Hn]),t(Gn,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),t(Gn,"ATTRIBUTE_NAMES",["cx","cy","r",...ji]),tt.setClass(Gn),tt.setSVGClass(Gn);const Kn=["x1","y1","x2","y2"],Jn=["x1","y1","x2","y2"],Qn=["x1","x2","y1","y2"];class Zn extends yi{constructor(){let[f,Ve,Ue,Je]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],Bn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Zn.ownDefaults),this.setOptions(Bn),this.x1=f,this.x2=Ue,this.y1=Ve,this.y2=Je,this._setWidthHeight();const{left:Vn,top:Nn}=Bn;typeof Vn=="number"&&this.set(M,Vn),typeof Nn=="number"&&this.set(P,Nn)}_setWidthHeight(){const{x1:f,y1:Ve,x2:Ue,y2:Je}=this;this.width=Math.abs(Ue-f),this.height=Math.abs(Je-Ve);const{left:Bn,top:Vn,width:Nn,height:Un}=me([{x:f,y:Ve},{x:Ue,y:Je}]),qn=new ot(Bn+Nn/2,Vn+Un/2);this.setPositionByOrigin(qn,D,D)}_set(f,Ve){return super._set(f,Ve),Qn.includes(f)&&this._setWidthHeight(),this}_render(f){f.beginPath();const Ve=this.calcLinePoints();f.moveTo(Ve.x1,Ve.y1),f.lineTo(Ve.x2,Ve.y2),f.lineWidth=this.strokeWidth;const Ue=f.strokeStyle;var Je;$t(this.stroke)?f.strokeStyle=this.stroke.toLive(f):f.strokeStyle=(Je=this.stroke)!==null&&Je!==void 0?Je:f.fillStyle,this.stroke&&this._renderStroke(f),f.strokeStyle=Ue}_findCenterFromElement(){return new ot((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return s(s({},super.toObject(f)),this.calcLinePoints())}_getNonTransformedDimensions(){const f=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(f.y-=this.strokeWidth),this.height===0&&(f.x-=this.strokeWidth)),f}calcLinePoints(){const{x1:f,x2:Ve,y1:Ue,y2:Je,width:Bn,height:Vn}=this,Nn=f<=Ve?-1:1,Un=Ue<=Je?-1:1;return{x1:Nn*Bn/2,x2:Nn*-Bn/2,y1:Un*Vn/2,y2:Un*-Vn/2}}_toSVG(){const{x1:f,x2:Ve,y1:Ue,y2:Je}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(f,'" y1="').concat(Ue,'" x2="').concat(Ve,'" y2="').concat(Je,`" />
`)]}static async fromElement(f,Ve,Ue){const Je=ur(f,this.ATTRIBUTE_NAMES,Ue),{x1:Bn=0,y1:Vn=0,x2:Nn=0,y2:Un=0}=Je;return new this([Bn,Vn,Nn,Un],i(Je,Kn))}static fromObject(f){let{x1:Ve,y1:Ue,x2:Je,y2:Bn}=f,Vn=i(f,Jn);return this._fromObject(s(s({},Vn),{},{points:[Ve,Ue,Je,Bn]}),{extraParam:"points"})}}t(Zn,"type","Line"),t(Zn,"cacheProperties",[...fs,...Qn]),t(Zn,"ATTRIBUTE_NAMES",ji.concat(Qn)),tt.setClass(Zn),tt.setSVGClass(Zn);class $n extends yi{static getDefaults(){return s(s({},super.getDefaults()),$n.ownDefaults)}constructor(f){super(),Object.assign(this,$n.ownDefaults),this.setOptions(f)}_render(f){const Ve=this.width/2,Ue=this.height/2;f.beginPath(),f.moveTo(-Ve,Ue),f.lineTo(0,-Ue),f.lineTo(Ve,Ue),f.closePath(),this._renderPaintInOrder(f)}_toSVG(){const f=this.width/2,Ve=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-f," ").concat(Ve,",0 ").concat(-Ve,",").concat(f," ").concat(Ve),'" />']}}t($n,"type","Triangle"),t($n,"ownDefaults",{width:100,height:100}),tt.setClass($n),tt.setSVGClass($n);const to=["rx","ry"];class eo extends yi{static getDefaults(){return s(s({},super.getDefaults()),eo.ownDefaults)}constructor(f){super(),Object.assign(this,eo.ownDefaults),this.setOptions(f)}_set(f,Ve){switch(super._set(f,Ve),f){case"rx":this.rx=Ve,this.set("width",2*Ve);break;case"ry":this.ry=Ve,this.set("height",2*Ve)}return this}getRx(){return this.get("rx")*this.get(G)}getRy(){return this.get("ry")*this.get(N)}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...to,...f])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,w,!1),f.restore(),this._renderPaintInOrder(f)}static async fromElement(f,Ve,Ue){const Je=ur(f,this.ATTRIBUTE_NAMES,Ue);return Je.left=(Je.left||0)-Je.rx,Je.top=(Je.top||0)-Je.ry,new this(Je)}}function so(qe){if(!qe)return[];const f=qe.replace(/,/g," ").trim().split(/\s+/),Ve=[];for(let Ue=0;Ue<f.length;Ue+=2)Ve.push({x:parseFloat(f[Ue]),y:parseFloat(f[Ue+1])});return Ve}t(eo,"type","Ellipse"),t(eo,"cacheProperties",[...fs,...to]),t(eo,"ownDefaults",{rx:0,ry:0}),t(eo,"ATTRIBUTE_NAMES",[...ji,"cx","cy","rx","ry"]),tt.setClass(eo),tt.setSVGClass(eo);const io=["left","top"],ro={exactBoundingBox:!1};class no extends yi{static getDefaults(){return s(s({},super.getDefaults()),no.ownDefaults)}constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),t(this,"strokeDiff",void 0),Object.assign(this,no.ownDefaults),this.setOptions(Ve),this.points=f;const{left:Ue,top:Je}=Ve;this.initialized=!0,this.setBoundingBox(!0),typeof Ue=="number"&&this.set(M,Ue),typeof Je=="number"&&this.set(P,Je)}isOpen(){return!0}_projectStrokeOnPoints(f){return Si(this.points,f,this.isOpen())}_calcDimensions(f){f=s({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},f||{});const Ve=this.exactBoundingBox?this._projectStrokeOnPoints(f).map(qn=>qn.projectedPoint):this.points;if(Ve.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new ot,strokeOffset:new ot,strokeDiff:new ot};const Ue=me(Ve),Je=Ft(s(s({},f),{},{scaleX:1,scaleY:1})),Bn=me(this.points.map(qn=>bt(qn,Je,!0))),Vn=new ot(this.scaleX,this.scaleY);let Nn=Ue.left+Ue.width/2,Un=Ue.top+Ue.height/2;return this.exactBoundingBox&&(Nn-=Un*Math.tan(_t(this.skewX)),Un-=Nn*Math.tan(_t(this.skewY))),s(s({},Ue),{},{pathOffset:new ot(Nn,Un),strokeOffset:new ot(Bn.left,Bn.top).subtract(new ot(Ue.left,Ue.top)).multiply(Vn),strokeDiff:new ot(Ue.width,Ue.height).subtract(new ot(Bn.width,Bn.height)).multiply(Vn)})}_findCenterFromElement(){const f=me(this.points);return new ot(f.left+f.width/2,f.top+f.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(f){const{left:Ve,top:Ue,width:Je,height:Bn,pathOffset:Vn,strokeOffset:Nn,strokeDiff:Un}=this._calcDimensions();this.set({width:Je,height:Bn,pathOffset:Vn,strokeOffset:Nn,strokeDiff:Un}),f&&this.setPositionByOrigin(new ot(Ve+Je/2,Ue+Bn/2),D,D)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new ot(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let Vn;if(Object.keys(f).some(Nn=>this.strokeUniform||this.constructor.layoutProperties.includes(Nn))){var Ve,Ue;const{width:Nn,height:Un}=this._calcDimensions(f);Vn=new ot((Ve=f.width)!==null&&Ve!==void 0?Ve:Nn,(Ue=f.height)!==null&&Ue!==void 0?Ue:Un)}else{var Je,Bn;Vn=new ot((Je=f.width)!==null&&Je!==void 0?Je:this.width,(Bn=f.height)!==null&&Bn!==void 0?Bn:this.height)}return Vn.multiply(new ot(f.scaleX||this.scaleX,f.scaleY||this.scaleY))}return super._getTransformedDimensions(f)}_set(f,Ve){const Ue=this.initialized&&this[f]!==Ve,Je=super._set(f,Ve);return this.exactBoundingBox&&Ue&&((f===G||f===N)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(f))&&this.setDimensions(),Je}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return s(s({},super.toObject(f)),{},{points:this.points.map(Ve=>{let{x:Ue,y:Je}=Ve;return{x:Ue,y:Je}})})}_toSVG(){const f=[],Ve=this.pathOffset.x,Ue=this.pathOffset.y,Je=o.NUM_FRACTION_DIGITS;for(let Bn=0,Vn=this.points.length;Bn<Vn;Bn++)f.push(qt(this.points[Bn].x-Ve,Je),",",qt(this.points[Bn].y-Ue,Je)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(f.join(""),`" />
`)]}_render(f){const Ve=this.points.length,Ue=this.pathOffset.x,Je=this.pathOffset.y;if(Ve&&!isNaN(this.points[Ve-1].y)){f.beginPath(),f.moveTo(this.points[0].x-Ue,this.points[0].y-Je);for(let Bn=0;Bn<Ve;Bn++){const Vn=this.points[Bn];f.lineTo(Vn.x-Ue,Vn.y-Je)}!this.isOpen()&&f.closePath(),this._renderPaintInOrder(f)}}complexity(){return this.points.length}static async fromElement(f,Ve,Ue){return new this(so(f.getAttribute("points")),s(s({},i(ur(f,this.ATTRIBUTE_NAMES,Ue),io)),Ve))}static fromObject(f){return this._fromObject(f,{extraParam:"points"})}}t(no,"ownDefaults",ro),t(no,"type","Polyline"),t(no,"layoutProperties",[U,q,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),t(no,"cacheProperties",[...fs,"points"]),t(no,"ATTRIBUTE_NAMES",[...ji]),tt.setClass(no),tt.setSVGClass(no);class oo extends no{isOpen(){return!1}}t(oo,"ownDefaults",ro),t(oo,"type","Polygon"),tt.setClass(oo),tt.setSVGClass(oo);const ao=["fontSize","fontWeight","fontFamily","fontStyle"],ho=["underline","overline","linethrough"],co=[...ao,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],lo=[...co,...ho,"textBackgroundColor","direction"],uo=[...ao,...ho,J,"strokeWidth",K,"deltaY","textBackgroundColor"],go={_reNewline:F,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:M,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:M,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},fo="justify",po="justify-left",mo="justify-right",vo="justify-center";class yo extends yi{isEmptyStyles(f){if(!this.styles||f!==void 0&&!this.styles[f])return!0;const Ve=f===void 0?this.styles:{line:this.styles[f]};for(const Ue in Ve)for(const Je in Ve[Ue])for(const Bn in Ve[Ue][Je])return!1;return!0}styleHas(f,Ve){if(!this.styles||Ve!==void 0&&!this.styles[Ve])return!1;const Ue=Ve===void 0?this.styles:{0:this.styles[Ve]};for(const Je in Ue)for(const Bn in Ue[Je])if(Ue[Je][Bn][f]!==void 0)return!0;return!1}cleanStyle(f){if(!this.styles)return!1;const Ve=this.styles;let Ue,Je,Bn=0,Vn=!0,Nn=0;for(const Un in Ve){Ue=0;for(const qn in Ve[Un]){const qo=Ve[Un][qn]||{};Bn++,qo[f]!==void 0?(Je?qo[f]!==Je&&(Vn=!1):Je=qo[f],qo[f]===this[f]&&delete qo[f]):Vn=!1,Object.keys(qo).length!==0?Ue++:delete Ve[Un][qn]}Ue===0&&delete Ve[Un]}for(let Un=0;Un<this._textLines.length;Un++)Nn+=this._textLines[Un].length;Vn&&Bn===Nn&&(this[f]=Je,this.removeStyle(f))}removeStyle(f){if(!this.styles)return;const Ve=this.styles;let Ue,Je,Bn;for(Je in Ve){for(Bn in Ue=Ve[Je],Ue)delete Ue[Bn][f],Object.keys(Ue[Bn]).length===0&&delete Ue[Bn];Object.keys(Ue).length===0&&delete Ve[Je]}}_extendStyles(f,Ve){const{lineIndex:Ue,charIndex:Je}=this.get2DCursorLocation(f);this._getLineStyle(Ue)||this._setLineStyle(Ue);const Bn=Yt(s(s({},this._getStyleDeclaration(Ue,Je)),Ve),Vn=>Vn!==void 0);this._setStyleDeclaration(Ue,Je,Bn)}getSelectionStyles(f,Ve,Ue){const Je=[];for(let Bn=f;Bn<(Ve||f);Bn++)Je.push(this.getStyleAtPosition(Bn,Ue));return Je}getStyleAtPosition(f,Ve){const{lineIndex:Ue,charIndex:Je}=this.get2DCursorLocation(f);return Ve?this.getCompleteStyleDeclaration(Ue,Je):this._getStyleDeclaration(Ue,Je)}setSelectionStyles(f,Ve,Ue){for(let Je=Ve;Je<(Ue||Ve);Je++)this._extendStyles(Je,f);this._forceClearCache=!0}_getStyleDeclaration(f,Ve){var Ue;const Je=this.styles&&this.styles[f];return Je&&(Ue=Je[Ve])!==null&&Ue!==void 0?Ue:{}}getCompleteStyleDeclaration(f,Ve){return s(s({},Xt(this,this.constructor._styleProperties)),this._getStyleDeclaration(f,Ve))}_setStyleDeclaration(f,Ve,Ue){this.styles[f][Ve]=Ue}_deleteStyleDeclaration(f,Ve){delete this.styles[f][Ve]}_getLineStyle(f){return!!this.styles[f]}_setLineStyle(f){this.styles[f]={}}_deleteLineStyle(f){delete this.styles[f]}}t(yo,"_styleProperties",uo);const _o=/  +/g,xo=/"/g;function Co(qe,f,Ve,Ue,Je){return"		".concat(function(Bn,Vn){let{left:Nn,top:Un,width:qn,height:qo}=Vn,$o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o.NUM_FRACTION_DIGITS;const Zo=Zt(K,Bn,!1),[ta,ea,ra,na]=[Nn,Un,qn,qo].map(oa=>qt(oa,$o));return"<rect ".concat(Zo,' x="').concat(ta,'" y="').concat(ea,'" width="').concat(ra,'" height="').concat(na,'"></rect>')}(qe,{left:f,top:Ve,width:Ue,height:Je}),`
`)}const bo=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let wo;class So extends yo{static getDefaults(){return s(s({},super.getDefaults()),So.ownDefaults)}constructor(f,Ve){super(),t(this,"__charBounds",[]),Object.assign(this,So.ownDefaults),this.setOptions(Ve),this.styles||(this.styles={}),this.text=f,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const f=this.path;f&&(f.segmentsInfo=Jr(f.path))}_splitText(){const f=this._splitTextIntoLines(this.text);return this.textLines=f.lines,this._textLines=f.graphemeLines,this._unwrappedTextLines=f._unwrappedLines,this._text=f.graphemeText,f}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(fo)&&this.enlargeSpaces()}enlargeSpaces(){let f,Ve,Ue,Je,Bn,Vn,Nn;for(let Un=0,qn=this._textLines.length;Un<qn;Un++)if((this.textAlign===fo||Un!==qn-1&&!this.isEndOfWrapping(Un))&&(Je=0,Bn=this._textLines[Un],Ve=this.getLineWidth(Un),Ve<this.width&&(Nn=this.textLines[Un].match(this._reSpacesAndTabs)))){Ue=Nn.length,f=(this.width-Ve)/Ue;for(let qo=0;qo<=Bn.length;qo++)Vn=this.__charBounds[Un][qo],this._reSpaceAndTab.test(Bn[qo])?(Vn.width+=f,Vn.kernedWidth+=f,Vn.left+=Je,Je+=f):Vn.left+=Je}}isEndOfWrapping(f){return f===this._textLines.length-1}missingNewlineOffset(f){return 1}get2DCursorLocation(f,Ve){const Ue=Ve?this._unwrappedTextLines:this._textLines;let Je;for(Je=0;Je<Ue.length;Je++){if(f<=Ue[Je].length)return{lineIndex:Je,charIndex:f};f-=Ue[Je].length+this.missingNewlineOffset(Je,Ve)}return{lineIndex:Je-1,charIndex:Ue[Je-1].length<f?Ue[Je-1].length:f}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const f=super._getCacheCanvasDimensions(),Ve=this.fontSize;return f.width+=Ve*f.zoomX,f.height+=Ve*f.zoomY,f}_render(f){const Ve=this.path;Ve&&!Ve.isNotVisible()&&Ve._render(f),this._setTextStyles(f),this._renderTextLinesBackground(f),this._renderTextDecoration(f,"underline"),this._renderText(f),this._renderTextDecoration(f,"overline"),this._renderTextDecoration(f,"linethrough")}_renderText(f){this.paintFirst===J?(this._renderTextStroke(f),this._renderTextFill(f)):(this._renderTextFill(f),this._renderTextStroke(f))}_setTextStyles(f,Ve,Ue){if(f.textBaseline="alphabetic",this.path)switch(this.pathAlign){case D:f.textBaseline="middle";break;case"ascender":f.textBaseline=P;break;case"descender":f.textBaseline=E}f.font=this._getFontDeclaration(Ve,Ue)}calcTextWidth(){let f=this.getLineWidth(0);for(let Ve=1,Ue=this._textLines.length;Ve<Ue;Ve++){const Je=this.getLineWidth(Ve);Je>f&&(f=Je)}return f}_renderTextLine(f,Ve,Ue,Je,Bn,Vn){this._renderChars(f,Ve,Ue,Je,Bn,Vn)}_renderTextLinesBackground(f){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const Ve=f.fillStyle,Ue=this._getLeftOffset();let Je=this._getTopOffset();for(let Bn=0,Vn=this._textLines.length;Bn<Vn;Bn++){const Nn=this.getHeightOfLine(Bn);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",Bn)){Je+=Nn;continue}const Un=this._textLines[Bn].length,qn=this._getLineLeftOffset(Bn);let qo,$o,Zo=0,ta=0,ea=this.getValueOfPropertyAt(Bn,0,"textBackgroundColor");for(let ra=0;ra<Un;ra++){const na=this.__charBounds[Bn][ra];$o=this.getValueOfPropertyAt(Bn,ra,"textBackgroundColor"),this.path?(f.save(),f.translate(na.renderLeft,na.renderTop),f.rotate(na.angle),f.fillStyle=$o,$o&&f.fillRect(-na.width/2,-Nn/this.lineHeight*(1-this._fontSizeFraction),na.width,Nn/this.lineHeight),f.restore()):$o!==ea?(qo=Ue+qn+ta,this.direction==="rtl"&&(qo=this.width-qo-Zo),f.fillStyle=ea,ea&&f.fillRect(qo,Je,Zo,Nn/this.lineHeight),ta=na.left,Zo=na.width,ea=$o):Zo+=na.kernedWidth}$o&&!this.path&&(qo=Ue+qn+ta,this.direction==="rtl"&&(qo=this.width-qo-Zo),f.fillStyle=$o,f.fillRect(qo,Je,Zo,Nn/this.lineHeight)),Je+=Nn}f.fillStyle=Ve,this._removeShadow(f)}_measureChar(f,Ve,Ue,Je){const Bn=_.getFontCache(Ve),Vn=this._getFontDeclaration(Ve),Nn=Ue+f,Un=Ue&&Vn===this._getFontDeclaration(Je),qn=Ve.fontSize/this.CACHE_FONT_SIZE;let qo,$o,Zo,ta;if(Ue&&Bn[Ue]!==void 0&&(Zo=Bn[Ue]),Bn[f]!==void 0&&(ta=qo=Bn[f]),Un&&Bn[Nn]!==void 0&&($o=Bn[Nn],ta=$o-Zo),qo===void 0||Zo===void 0||$o===void 0){const ea=function(){return wo||(wo=vt({width:0,height:0}).getContext("2d")),wo}();this._setTextStyles(ea,Ve,!0),qo===void 0&&(ta=qo=ea.measureText(f).width,Bn[f]=qo),Zo===void 0&&Un&&Ue&&(Zo=ea.measureText(Ue).width,Bn[Ue]=Zo),Un&&$o===void 0&&($o=ea.measureText(Nn).width,Bn[Nn]=$o,ta=$o-Zo)}return{width:qo*qn,kernedWidth:ta*qn}}getHeightOfChar(f,Ve){return this.getValueOfPropertyAt(f,Ve,"fontSize")}measureLine(f){const Ve=this._measureLine(f);return this.charSpacing!==0&&(Ve.width-=this._getWidthOfCharSpacing()),Ve.width<0&&(Ve.width=0),Ve}_measureLine(f){let Ve,Ue,Je=0;const Bn=this.pathSide===A,Vn=this.path,Nn=this._textLines[f],Un=Nn.length,qn=new Array(Un);this.__charBounds[f]=qn;for(let qo=0;qo<Un;qo++){const $o=Nn[qo];Ue=this._getGraphemeBox($o,f,qo,Ve),qn[qo]=Ue,Je+=Ue.kernedWidth,Ve=$o}if(qn[Un]={left:Ue?Ue.left+Ue.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},Vn&&Vn.segmentsInfo){let qo=0;const $o=Vn.segmentsInfo[Vn.segmentsInfo.length-1].length;switch(this.textAlign){case M:qo=Bn?$o-Je:0;break;case D:qo=($o-Je)/2;break;case A:qo=Bn?0:$o-Je}qo+=this.pathStartOffset*(Bn?-1:1);for(let Zo=Bn?Un-1:0;Bn?Zo>=0:Zo<Un;Bn?Zo--:Zo++)Ue=qn[Zo],qo>$o?qo%=$o:qo<0&&(qo+=$o),this._setGraphemeOnPath(qo,Ue),qo+=Ue.kernedWidth}return{width:Je,numOfSpaces:0}}_setGraphemeOnPath(f,Ve){const Ue=f+Ve.kernedWidth/2,Je=this.path,Bn=Qr(Je.path,Ue,Je.segmentsInfo);Ve.renderLeft=Bn.x-Je.pathOffset.x,Ve.renderTop=Bn.y-Je.pathOffset.y,Ve.angle=Bn.angle+(this.pathSide===A?Math.PI:0)}_getGraphemeBox(f,Ve,Ue,Je,Bn){const Vn=this.getCompleteStyleDeclaration(Ve,Ue),Nn=Je?this.getCompleteStyleDeclaration(Ve,Ue-1):{},Un=this._measureChar(f,Vn,Je,Nn);let qn,qo=Un.kernedWidth,$o=Un.width;this.charSpacing!==0&&(qn=this._getWidthOfCharSpacing(),$o+=qn,qo+=qn);const Zo={width:$o,left:0,height:Vn.fontSize,kernedWidth:qo,deltaY:Vn.deltaY};if(Ue>0&&!Bn){const ta=this.__charBounds[Ve][Ue-1];Zo.left=ta.left+ta.width+Un.kernedWidth-Un.width}return Zo}getHeightOfLine(f){if(this.__lineHeights[f])return this.__lineHeights[f];let Ve=this.getHeightOfChar(f,0);for(let Ue=1,Je=this._textLines[f].length;Ue<Je;Ue++)Ve=Math.max(this.getHeightOfChar(f,Ue),Ve);return this.__lineHeights[f]=Ve*this.lineHeight*this._fontSizeMult}calcTextHeight(){let f,Ve=0;for(let Ue=0,Je=this._textLines.length;Ue<Je;Ue++)f=this.getHeightOfLine(Ue),Ve+=Ue===Je-1?f/this.lineHeight:f;return Ve}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(f,Ve){f.save();let Ue=0;const Je=this._getLeftOffset(),Bn=this._getTopOffset();for(let Vn=0,Nn=this._textLines.length;Vn<Nn;Vn++){const Un=this.getHeightOfLine(Vn),qn=Un/this.lineHeight,qo=this._getLineLeftOffset(Vn);this._renderTextLine(Ve,f,this._textLines[Vn],Je+qo,Bn+Ue+qn,Vn),Ue+=Un}f.restore()}_renderTextFill(f){(this.fill||this.styleHas(K))&&this._renderTextCommon(f,"fillText")}_renderTextStroke(f){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this._setLineDash(f,this.strokeDashArray),f.beginPath(),this._renderTextCommon(f,"strokeText"),f.closePath(),f.restore())}_renderChars(f,Ve,Ue,Je,Bn,Vn){const Nn=this.getHeightOfLine(Vn),Un=this.textAlign.includes(fo),qn=this.path,qo=!Un&&this.charSpacing===0&&this.isEmptyStyles(Vn)&&!qn,$o=this.direction==="ltr",Zo=this.direction==="ltr"?1:-1,ta=Ve.direction;let ea,ra,na,oa,ca,pa="",la=0;if(Ve.save(),ta!==this.direction&&(Ve.canvas.setAttribute("dir",$o?"ltr":"rtl"),Ve.direction=$o?"ltr":"rtl",Ve.textAlign=$o?M:A),Bn-=Nn*this._fontSizeFraction/this.lineHeight,qo)return this._renderChar(f,Ve,Vn,0,Ue.join(""),Je,Bn),void Ve.restore();for(let ma=0,Ca=Ue.length-1;ma<=Ca;ma++)oa=ma===Ca||this.charSpacing||qn,pa+=Ue[ma],na=this.__charBounds[Vn][ma],la===0?(Je+=Zo*(na.kernedWidth-na.width),la+=na.width):la+=na.kernedWidth,Un&&!oa&&this._reSpaceAndTab.test(Ue[ma])&&(oa=!0),oa||(ea=ea||this.getCompleteStyleDeclaration(Vn,ma),ra=this.getCompleteStyleDeclaration(Vn,ma+1),oa=Pi(ea,ra,!1)),oa&&(qn?(Ve.save(),Ve.translate(na.renderLeft,na.renderTop),Ve.rotate(na.angle),this._renderChar(f,Ve,Vn,ma,pa,-la/2,0),Ve.restore()):(ca=Je,this._renderChar(f,Ve,Vn,ma,pa,ca,Bn)),pa="",ea=ra,Je+=Zo*la,la=0);Ve.restore()}_applyPatternGradientTransformText(f){const Ve=this.width+this.strokeWidth,Ue=this.height+this.strokeWidth,Je=vt({width:Ve,height:Ue}),Bn=Je.getContext("2d");return Je.width=Ve,Je.height=Ue,Bn.beginPath(),Bn.moveTo(0,0),Bn.lineTo(Ve,0),Bn.lineTo(Ve,Ue),Bn.lineTo(0,Ue),Bn.closePath(),Bn.translate(Ve/2,Ue/2),Bn.fillStyle=f.toLive(Bn),this._applyPatternGradientTransform(Bn,f),Bn.fill(),Bn.createPattern(Je,"no-repeat")}handleFiller(f,Ve,Ue){let Je,Bn;return $t(Ue)?Ue.gradientUnits==="percentage"||Ue.gradientTransform||Ue.patternTransform?(Je=-this.width/2,Bn=-this.height/2,f.translate(Je,Bn),f[Ve]=this._applyPatternGradientTransformText(Ue),{offsetX:Je,offsetY:Bn}):(f[Ve]=Ue.toLive(f),this._applyPatternGradientTransform(f,Ue)):(f[Ve]=Ue,{offsetX:0,offsetY:0})}_setStrokeStyles(f,Ve){let{stroke:Ue,strokeWidth:Je}=Ve;return f.lineWidth=Je,f.lineCap=this.strokeLineCap,f.lineDashOffset=this.strokeDashOffset,f.lineJoin=this.strokeLineJoin,f.miterLimit=this.strokeMiterLimit,this.handleFiller(f,"strokeStyle",Ue)}_setFillStyles(f,Ve){let{fill:Ue}=Ve;return this.handleFiller(f,"fillStyle",Ue)}_renderChar(f,Ve,Ue,Je,Bn,Vn,Nn){const Un=this._getStyleDeclaration(Ue,Je),qn=this.getCompleteStyleDeclaration(Ue,Je),qo=f==="fillText"&&qn.fill,$o=f==="strokeText"&&qn.stroke&&qn.strokeWidth;if($o||qo){if(Ve.save(),Ve.font=this._getFontDeclaration(qn),Un.textBackgroundColor&&this._removeShadow(Ve),Un.deltaY&&(Nn+=Un.deltaY),qo){const Zo=this._setFillStyles(Ve,qn);Ve.fillText(Bn,Vn-Zo.offsetX,Nn-Zo.offsetY)}if($o){const Zo=this._setStrokeStyles(Ve,qn);Ve.strokeText(Bn,Vn-Zo.offsetX,Nn-Zo.offsetY)}Ve.restore()}}setSuperscript(f,Ve){this._setScript(f,Ve,this.superscript)}setSubscript(f,Ve){this._setScript(f,Ve,this.subscript)}_setScript(f,Ve,Ue){const Je=this.get2DCursorLocation(f,!0),Bn=this.getValueOfPropertyAt(Je.lineIndex,Je.charIndex,"fontSize"),Vn=this.getValueOfPropertyAt(Je.lineIndex,Je.charIndex,"deltaY"),Nn={fontSize:Bn*Ue.size,deltaY:Vn+Bn*Ue.baseline};this.setSelectionStyles(Nn,f,Ve)}_getLineLeftOffset(f){const Ve=this.getLineWidth(f),Ue=this.width-Ve,Je=this.textAlign,Bn=this.direction,Vn=this.isEndOfWrapping(f);let Nn=0;return Je===fo||Je===vo&&!Vn||Je===mo&&!Vn||Je===po&&!Vn?0:(Je===D&&(Nn=Ue/2),Je===A&&(Nn=Ue),Je===vo&&(Nn=Ue/2),Je===mo&&(Nn=Ue),Bn==="rtl"&&(Je===A||Je===fo||Je===mo?Nn=0:Je===M||Je===po?Nn=-Ue:Je!==D&&Je!==vo||(Nn=-Ue/2)),Nn)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(f){if(this.__lineWidths[f]!==void 0)return this.__lineWidths[f];const{width:Ve}=this.measureLine(f);return this.__lineWidths[f]=Ve,Ve}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(f,Ve,Ue){var Je;return(Je=this._getStyleDeclaration(f,Ve)[Ue])!==null&&Je!==void 0?Je:this[Ue]}_renderTextDecoration(f,Ve){if(!this[Ve]&&!this.styleHas(Ve))return;let Ue=this._getTopOffset();const Je=this._getLeftOffset(),Bn=this.path,Vn=this._getWidthOfCharSpacing(),Nn=this.offsets[Ve];for(let Un=0,qn=this._textLines.length;Un<qn;Un++){const qo=this.getHeightOfLine(Un);if(!this[Ve]&&!this.styleHas(Ve,Un)){Ue+=qo;continue}const $o=this._textLines[Un],Zo=qo/this.lineHeight,ta=this._getLineLeftOffset(Un);let ea,ra,na=0,oa=0,ca=this.getValueOfPropertyAt(Un,0,Ve),pa=this.getValueOfPropertyAt(Un,0,K);const la=Ue+Zo*(1-this._fontSizeFraction);let ma=this.getHeightOfChar(Un,0),Ca=this.getValueOfPropertyAt(Un,0,"deltaY");for(let ga=0,ba=$o.length;ga<ba;ga++){const Ha=this.__charBounds[Un][ga];ea=this.getValueOfPropertyAt(Un,ga,Ve),ra=this.getValueOfPropertyAt(Un,ga,K);const Ja=this.getHeightOfChar(Un,ga),tc=this.getValueOfPropertyAt(Un,ga,"deltaY");if(Bn&&ea&&ra)f.save(),f.fillStyle=pa,f.translate(Ha.renderLeft,Ha.renderTop),f.rotate(Ha.angle),f.fillRect(-Ha.kernedWidth/2,Nn*Ja+tc,Ha.kernedWidth,this.fontSize/15),f.restore();else if((ea!==ca||ra!==pa||Ja!==ma||tc!==Ca)&&oa>0){let Ua=Je+ta+na;this.direction==="rtl"&&(Ua=this.width-Ua-oa),ca&&pa&&(f.fillStyle=pa,f.fillRect(Ua,la+Nn*ma+Ca,oa,this.fontSize/15)),na=Ha.left,oa=Ha.width,ca=ea,pa=ra,ma=Ja,Ca=tc}else oa+=Ha.kernedWidth}let Sa=Je+ta+na;this.direction==="rtl"&&(Sa=this.width-Sa-oa),f.fillStyle=ra,ea&&ra&&f.fillRect(Sa,la+Nn*ma+Ca,oa-Vn,this.fontSize/15),Ue+=qo}this._removeShadow(f)}_getFontDeclaration(){let{fontFamily:f=this.fontFamily,fontStyle:Ve=this.fontStyle,fontWeight:Ue=this.fontWeight,fontSize:Je=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Bn=arguments.length>1?arguments[1]:void 0;const Vn=f.includes("'")||f.includes('"')||f.includes(",")||So.genericFonts.includes(f.toLowerCase())?f:'"'.concat(f,'"');return[Ve,Ue,"".concat(Bn?this.CACHE_FONT_SIZE:Je,"px"),Vn].join(" ")}render(f){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(f)))}graphemeSplit(f){return ki(f)}_splitTextIntoLines(f){const Ve=f.split(this._reNewline),Ue=new Array(Ve.length),Je=[`
`];let Bn=[];for(let Vn=0;Vn<Ve.length;Vn++)Ue[Vn]=this.graphemeSplit(Ve[Vn]),Bn=Bn.concat(Ue[Vn],Je);return Bn.pop(),{_unwrappedLines:Ue,lines:Ve,graphemeText:Bn,graphemeLines:Ue}}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return s(s({},super.toObject([...lo,...f])),{},{styles:Ei(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(f,Ve){const{textLayoutProperties:Ue}=this.constructor;super.set(f,Ve);let Je=!1,Bn=!1;if(typeof f=="object")for(const Vn in f)Vn==="path"&&this.setPathInfo(),Je=Je||Ue.includes(Vn),Bn=Bn||Vn==="path";else Je=Ue.includes(f),Bn=f==="path";return Bn&&this.setPathInfo(),Je&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(f,Ve,Ue){const Je=ur(f,So.ATTRIBUTE_NAMES,Ue),Bn=s(s({},Ve),Je),{textAnchor:Vn=M,textDecoration:Nn="",dx:Un=0,dy:qn=0,top:qo=0,left:$o=0,fontSize:Zo=O,strokeWidth:ta=1}=Bn,ea=i(Bn,bo),ra=new this((f.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),s({left:$o+Un,top:qo+qn,underline:Nn.includes("underline"),overline:Nn.includes("overline"),linethrough:Nn.includes("line-through"),strokeWidth:0,fontSize:Zo},ea)),na=ra.getScaledHeight()/ra.height,oa=((ra.height+ra.strokeWidth)*ra.lineHeight-ra.height)*na,ca=ra.getScaledHeight()+oa;let pa=0;return Vn===D&&(pa=ra.getScaledWidth()/2),Vn===A&&(pa=ra.getScaledWidth()),ra.set({left:ra.left-pa,top:ra.top-(ca-ra.fontSize*(.07+ra._fontSizeFraction))/ra.lineHeight,strokeWidth:ta}),ra}static fromObject(f){return this._fromObject(s(s({},f),{},{styles:Ai(f.styles||{},f.text)}),{extraParam:"text"})}}t(So,"textLayoutProperties",co),t(So,"cacheProperties",[...fs,...lo]),t(So,"ownDefaults",go),t(So,"type","Text"),t(So,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),t(So,"ATTRIBUTE_NAMES",ji.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),vi(So,[class extends Be{_toSVG(){const qe=this._getSVGLeftTopOffsets(),f=this._getSVGTextAndBg(qe.textTop,qe.textLeft);return this._wrapSVGTextAndBg(f)}toSVG(qe){return this._createBaseSVGMarkup(this._toSVG(),{reviver:qe,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(qe){let{textBgRects:f,textSpans:Ve}=qe;const Ue=this.getSvgTextDecoration(this);return[f.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(xo,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",Ue?'text-decoration="'.concat(Ue,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",Ve.join(""),`</text>
`]}_getSVGTextAndBg(qe,f){const Ve=[],Ue=[];let Je,Bn=qe;this.backgroundColor&&Ue.push(...Co(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let Vn=0,Nn=this._textLines.length;Vn<Nn;Vn++)Je=this._getLineLeftOffset(Vn),this.direction==="rtl"&&(Je+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",Vn))&&this._setSVGTextLineBg(Ue,Vn,f+Je,Bn),this._setSVGTextLineText(Ve,Vn,f+Je,Bn),Bn+=this.getHeightOfLine(Vn);return{textSpans:Ve,textBgRects:Ue}}_createTextCharSpan(qe,f,Ve,Ue){const Je=this.getSvgSpanStyles(f,qe!==qe.trim()||!!qe.match(_o)),Bn=Je?'style="'.concat(Je,'"'):"",Vn=f.deltaY,Nn=Vn?' dy="'.concat(qt(Vn,o.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(qt(Ve,o.NUM_FRACTION_DIGITS),'" y="').concat(qt(Ue,o.NUM_FRACTION_DIGITS),'" ').concat(Nn).concat(Bn,">").concat(Oi(qe),"</tspan>")}_setSVGTextLineText(qe,f,Ve,Ue){const Je=this.getHeightOfLine(f),Bn=this.textAlign.includes(fo),Vn=this._textLines[f];let Nn,Un,qn,qo,$o,Zo="",ta=0;Ue+=Je*(1-this._fontSizeFraction)/this.lineHeight;for(let ea=0,ra=Vn.length-1;ea<=ra;ea++)$o=ea===ra||this.charSpacing,Zo+=Vn[ea],qn=this.__charBounds[f][ea],ta===0?(Ve+=qn.kernedWidth-qn.width,ta+=qn.width):ta+=qn.kernedWidth,Bn&&!$o&&this._reSpaceAndTab.test(Vn[ea])&&($o=!0),$o||(Nn=Nn||this.getCompleteStyleDeclaration(f,ea),Un=this.getCompleteStyleDeclaration(f,ea+1),$o=Pi(Nn,Un,!0)),$o&&(qo=this._getStyleDeclaration(f,ea),qe.push(this._createTextCharSpan(Zo,qo,Ve,Ue)),Zo="",Nn=Un,this.direction==="rtl"?Ve-=ta:Ve+=ta,ta=0)}_setSVGTextLineBg(qe,f,Ve,Ue){const Je=this._textLines[f],Bn=this.getHeightOfLine(f)/this.lineHeight;let Vn,Nn=0,Un=0,qn=this.getValueOfPropertyAt(f,0,"textBackgroundColor");for(let qo=0;qo<Je.length;qo++){const{left:$o,width:Zo,kernedWidth:ta}=this.__charBounds[f][qo];Vn=this.getValueOfPropertyAt(f,qo,"textBackgroundColor"),Vn!==qn?(qn&&qe.push(...Co(qn,Ve+Un,Ue,Nn,Bn)),Un=$o,Nn=Zo,qn=Vn):Nn+=ta}Vn&&qe.push(...Co(qn,Ve+Un,Ue,Nn,Bn))}_getSVGLineTopOffset(qe){let f,Ve=0;for(f=0;f<qe;f++)Ve+=this.getHeightOfLine(f);const Ue=this.getHeightOfLine(f);return{lineTop:Ve,offset:(this._fontSizeMult-this._fontSizeFraction)*Ue/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(qe){return"".concat(super.getSvgStyles(qe)," white-space: pre;")}getSvgSpanStyles(qe,f){const{fontFamily:Ve,strokeWidth:Ue,stroke:Je,fill:Bn,fontSize:Vn,fontStyle:Nn,fontWeight:Un,deltaY:qn}=qe,qo=this.getSvgTextDecoration(qe);return[Je?Zt(J,Je):"",Ue?"stroke-width: ".concat(Ue,"; "):"",Ve?"font-family: ".concat(Ve.includes("'")||Ve.includes('"')?Ve:"'".concat(Ve,"'"),"; "):"",Vn?"font-size: ".concat(Vn,"px; "):"",Nn?"font-style: ".concat(Nn,"; "):"",Un?"font-weight: ".concat(Un,"; "):"",qo&&"text-decoration: ".concat(qo,"; "),Bn?Zt(K,Bn):"",qn?"baseline-shift: ".concat(-qn,"; "):"",f?"white-space: pre; ":""].join("")}getSvgTextDecoration(qe){return["overline","underline","line-through"].filter(f=>qe[f.replace("-","")]).join(" ")}}]),tt.setClass(So),tt.setSVGClass(So);class To{constructor(f){t(this,"target",void 0),t(this,"__mouseDownInPlace",!1),t(this,"__dragStartFired",!1),t(this,"__isDraggingOver",!1),t(this,"__dragStartSelection",void 0),t(this,"__dragImageDisposer",void 0),t(this,"_dispose",void 0),this.target=f;const Ve=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{Ve.forEach(Ue=>Ue()),this._dispose=void 0}}isPointerOverSelection(f){const Ve=this.target,Ue=Ve.getSelectionStartFromPointer(f);return Ve.isEditing&&Ue>=Ve.selectionStart&&Ue<=Ve.selectionEnd&&Ve.selectionStart<Ve.selectionEnd}start(f){return this.__mouseDownInPlace=this.isPointerOverSelection(f)}isActive(){return this.__mouseDownInPlace}end(f){const Ve=this.isActive();return Ve&&!this.__dragStartFired&&(this.target.setCursorByClick(f),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,Ve}getDragStartSelection(){return this.__dragStartSelection}setDragImage(f,Ve){var Ue;let{selectionStart:Je,selectionEnd:Bn}=Ve;const Vn=this.target,Nn=Vn.canvas,Un=new ot(Vn.flipX?-1:1,Vn.flipY?-1:1),qn=Vn._getCursorBoundaries(Je),qo=new ot(qn.left+qn.leftOffset,qn.top+qn.topOffset).multiply(Un).transform(Vn.calcTransformMatrix()),$o=Nn.getScenePoint(f).subtract(qo),Zo=Vn.getCanvasRetinaScaling(),ta=Vn.getBoundingRect(),ea=qo.subtract(new ot(ta.left,ta.top)),ra=Nn.viewportTransform,na=ea.add($o).transform(ra,!0),oa=Vn.backgroundColor,ca=Ti(Vn.styles);Vn.backgroundColor="";const pa={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};Vn.setSelectionStyles(pa,0,Je),Vn.setSelectionStyles(pa,Bn,Vn.text.length),Vn.dirty=!0;const la=Vn.toCanvasElement({enableRetinaScaling:Nn.enableRetinaScaling,viewportTransform:!0});Vn.backgroundColor=oa,Vn.styles=ca,Vn.dirty=!0,on(la,{position:"fixed",left:"".concat(-la.width,"px"),border:j,width:"".concat(la.width/Zo,"px"),height:"".concat(la.height/Zo,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{la.remove()},re(f.target||this.target.hiddenTextarea).body.appendChild(la),(Ue=f.dataTransfer)===null||Ue===void 0||Ue.setDragImage(la,na.x,na.y)}onDragStart(f){this.__dragStartFired=!0;const Ve=this.target,Ue=this.isActive();if(Ue&&f.dataTransfer){const Je=this.__dragStartSelection={selectionStart:Ve.selectionStart,selectionEnd:Ve.selectionEnd},Bn=Ve._text.slice(Je.selectionStart,Je.selectionEnd).join(""),Vn=s({text:Ve.text,value:Bn},Je);f.dataTransfer.setData("text/plain",Bn),f.dataTransfer.setData("application/fabric",JSON.stringify({value:Bn,styles:Ve.getSelectionStyles(Je.selectionStart,Je.selectionEnd,!0)})),f.dataTransfer.effectAllowed="copyMove",this.setDragImage(f,Vn)}return Ve.abortCursorAnimation(),Ue}canDrop(f){if(this.target.editable&&!this.target.getActiveControl()&&!f.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const Ve=this.target.getSelectionStartFromPointer(f),Ue=this.__dragStartSelection;return Ve<Ue.selectionStart||Ve>Ue.selectionEnd}return!0}return!1}targetCanDrop(f){return this.target.canDrop(f)}dragEnterHandler(f){let{e:Ve}=f;const Ue=this.targetCanDrop(Ve);!this.__isDraggingOver&&Ue&&(this.__isDraggingOver=!0)}dragOverHandler(f){const{e:Ve}=f,Ue=this.targetCanDrop(Ve);!this.__isDraggingOver&&Ue?this.__isDraggingOver=!0:this.__isDraggingOver&&!Ue&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(Ve.preventDefault(),f.canDrop=!0,f.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(f){var Ve;const{e:Ue}=f,Je=Ue.defaultPrevented;this.__isDraggingOver=!1,Ue.preventDefault();let Bn=(Ve=Ue.dataTransfer)===null||Ve===void 0?void 0:Ve.getData("text/plain");if(Bn&&!Je){const Vn=this.target,Nn=Vn.canvas;let Un=Vn.getSelectionStartFromPointer(Ue);const{styles:qn}=Ue.dataTransfer.types.includes("application/fabric")?JSON.parse(Ue.dataTransfer.getData("application/fabric")):{},qo=Bn[Math.max(0,Bn.length-1)],$o=0;if(this.__dragStartSelection){const Zo=this.__dragStartSelection.selectionStart,ta=this.__dragStartSelection.selectionEnd;Un>Zo&&Un<=ta?Un=Zo:Un>ta&&(Un-=ta-Zo),Vn.removeChars(Zo,ta),delete this.__dragStartSelection}Vn._reNewline.test(qo)&&(Vn._reNewline.test(Vn._text[Un])||Un===Vn._text.length)&&(Bn=Bn.trimEnd()),f.didDrop=!0,f.dropTarget=Vn,Vn.insertChars(Bn,qn,Un),Nn.setActiveObject(Vn),Vn.enterEditing(Ue),Vn.selectionStart=Math.min(Un+$o,Vn._text.length),Vn.selectionEnd=Math.min(Vn.selectionStart+Bn.length,Vn._text.length),Vn.hiddenTextarea.value=Vn.text,Vn._updateTextarea(),Vn.hiddenTextarea.focus(),Vn.fire(z,{index:Un+$o,action:"drop"}),Nn.fire("text:changed",{target:Vn}),Nn.contextTopDirty=!0,Nn.requestRenderAll()}}dragEndHandler(f){let{e:Ve}=f;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var Ue;const Je=this.target,Bn=this.target.canvas,{selectionStart:Vn,selectionEnd:Nn}=this.__dragStartSelection,Un=((Ue=Ve.dataTransfer)===null||Ue===void 0?void 0:Ue.dropEffect)||j;Un===j?(Je.selectionStart=Vn,Je.selectionEnd=Nn,Je._updateTextarea(),Je.hiddenTextarea.focus()):(Je.clearContextTop(),Un==="move"&&(Je.removeChars(Vn,Nn),Je.selectionStart=Je.selectionEnd=Vn,Je.hiddenTextarea&&(Je.hiddenTextarea.value=Je.text),Je._updateTextarea(),Je.fire(z,{index:Vn,action:"dragend"}),Bn.fire("text:changed",{target:Je}),Bn.requestRenderAll()),Je.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Oo=/[ \n\.,;!\?\-]/;class ko extends So{constructor(){super(...arguments),t(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(f){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(f)}_animateCursor(f){let{toValue:Ve,duration:Ue,delay:Je,onComplete:Bn}=f;return As({startValue:this._currentCursorOpacity,endValue:Ve,duration:Ue,delay:Je,onComplete:Bn,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:Vn=>{this._currentCursorOpacity=Vn,this.renderCursorOrSelection()}})}_tick(f){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(f||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var f;(f=this._currentTickCompleteState)===null||f===void 0||f.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(f){this.abortCursorAnimation(),this._tick(f?0:this.cursorDelay)}abortCursorAnimation(){let f=!1;[this._currentTickState,this._currentTickCompleteState].forEach(Ve=>{Ve&&!Ve.isDone()&&(f=!0,Ve.abort())}),this._currentCursorOpacity=1,f&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(f=>!f||f.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(f){let Ve=0,Ue=f-1;if(this._reSpace.test(this._text[Ue]))for(;this._reSpace.test(this._text[Ue]);)Ve++,Ue--;for(;/\S/.test(this._text[Ue])&&Ue>-1;)Ve++,Ue--;return f-Ve}findWordBoundaryRight(f){let Ve=0,Ue=f;if(this._reSpace.test(this._text[Ue]))for(;this._reSpace.test(this._text[Ue]);)Ve++,Ue++;for(;/\S/.test(this._text[Ue])&&Ue<this._text.length;)Ve++,Ue++;return f+Ve}findLineBoundaryLeft(f){let Ve=0,Ue=f-1;for(;!/\n/.test(this._text[Ue])&&Ue>-1;)Ve++,Ue--;return f-Ve}findLineBoundaryRight(f){let Ve=0,Ue=f;for(;!/\n/.test(this._text[Ue])&&Ue<this._text.length;)Ve++,Ue++;return f+Ve}searchWordBoundary(f,Ve){const Ue=this._text;let Je=f>0&&this._reSpace.test(Ue[f])&&(Ve===-1||!F.test(Ue[f-1]))?f-1:f,Bn=Ue[Je];for(;Je>0&&Je<Ue.length&&!Oo.test(Bn);)Je+=Ve,Bn=Ue[Je];return Ve===-1&&Oo.test(Bn)&&Je++,Je}selectWord(f){f=f||this.selectionStart;const Ve=this.searchWordBoundary(f,-1),Ue=Math.max(Ve,this.searchWordBoundary(f,1));this.selectionStart=Ve,this.selectionEnd=Ue,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(f){f=f||this.selectionStart;const Ve=this.findLineBoundaryLeft(f),Ue=this.findLineBoundaryRight(f);return this.selectionStart=Ve,this.selectionEnd=Ue,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(f){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",f?{e:f}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:f}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(f){if(this.getActiveControl())return;const Ve=this.hiddenTextarea;re(Ve).activeElement!==Ve&&Ve.focus();const Ue=this.getSelectionStartFromPointer(f),Je=this.selectionStart,Bn=this.selectionEnd;(Ue===this.__selectionStartOnMouseDown&&Je!==Bn||Je!==Ue&&Bn!==Ue)&&(Ue>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=Ue):(this.selectionStart=Ue,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===Je&&this.selectionEnd===Bn||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(f,Ve,Ue){const Je=Ue.slice(0,f),Bn=this.graphemeSplit(Je).length;if(f===Ve)return{selectionStart:Bn,selectionEnd:Bn};const Vn=Ue.slice(f,Ve);return{selectionStart:Bn,selectionEnd:Bn+this.graphemeSplit(Vn).length}}fromGraphemeToStringSelection(f,Ve,Ue){const Je=Ue.slice(0,f).join("").length;return f===Ve?{selectionStart:Je,selectionEnd:Je}:{selectionStart:Je,selectionEnd:Je+Ue.slice(f,Ve).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const f=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=f.selectionStart,this.hiddenTextarea.selectionEnd=f.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const f=this.hiddenTextarea;this.text=f.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const Ve=this.fromStringToGraphemeSelection(f.selectionStart,f.selectionEnd,f.value);this.selectionEnd=this.selectionStart=Ve.selectionEnd,this.inCompositionMode||(this.selectionStart=Ve.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const f=this._calcTextareaPosition();this.hiddenTextarea.style.left=f.left,this.hiddenTextarea.style.top=f.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const f=this.inCompositionMode?this.compositionStart:this.selectionStart,Ve=this._getCursorBoundaries(f),Ue=this.get2DCursorLocation(f),Je=Ue.lineIndex,Bn=Ue.charIndex,Vn=this.getValueOfPropertyAt(Je,Bn,"fontSize")*this.lineHeight,Nn=Ve.leftOffset,Un=this.getCanvasRetinaScaling(),qn=this.canvas.upperCanvasEl,qo=qn.width/Un,$o=qn.height/Un,Zo=qo-Vn,ta=$o-Vn,ea=new ot(Ve.left+Nn,Ve.top+Ve.topOffset+Vn).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new ot(qn.clientWidth/qo,qn.clientHeight/$o));return ea.x<0&&(ea.x=0),ea.x>Zo&&(ea.x=Zo),ea.y<0&&(ea.y=0),ea.y>ta&&(ea.y=ta),ea.x+=this.canvas._offset.left,ea.y+=this.canvas._offset.top,{left:"".concat(ea.x,"px"),top:"".concat(ea.y,"px"),fontSize:"".concat(Vn,"px"),charHeight:Vn}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const f=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,f&&(f.blur&&f.blur(),f.parentNode&&f.parentNode.removeChild(f)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const f=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),f&&this.fire(Q),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),f&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const f in this.styles)this._textLines[f]||delete this.styles[f]}removeStyleFromTo(f,Ve){const{lineIndex:Ue,charIndex:Je}=this.get2DCursorLocation(f,!0),{lineIndex:Bn,charIndex:Vn}=this.get2DCursorLocation(Ve,!0);if(Ue!==Bn){if(this.styles[Ue])for(let Nn=Je;Nn<this._unwrappedTextLines[Ue].length;Nn++)delete this.styles[Ue][Nn];if(this.styles[Bn])for(let Nn=Vn;Nn<this._unwrappedTextLines[Bn].length;Nn++){const Un=this.styles[Bn][Nn];Un&&(this.styles[Ue]||(this.styles[Ue]={}),this.styles[Ue][Je+Nn-Vn]=Un)}for(let Nn=Ue+1;Nn<=Bn;Nn++)delete this.styles[Nn];this.shiftLineStyles(Bn,Ue-Bn)}else if(this.styles[Ue]){const Nn=this.styles[Ue],Un=Vn-Je;for(let qn=Je;qn<Vn;qn++)delete Nn[qn];for(const qn in this.styles[Ue]){const qo=parseInt(qn,10);qo>=Vn&&(Nn[qo-Un]=Nn[qn],delete Nn[qn])}}}shiftLineStyles(f,Ve){const Ue=Object.assign({},this.styles);for(const Je in this.styles){const Bn=parseInt(Je,10);Bn>f&&(this.styles[Bn+Ve]=Ue[Bn],Ue[Bn-Ve]||delete this.styles[Bn])}}insertNewlineStyleObject(f,Ve,Ue,Je){const Bn={},Vn=this._unwrappedTextLines[f].length,Nn=Vn===Ve;let Un=!1;Ue||(Ue=1),this.shiftLineStyles(f,Ue);const qn=this.styles[f]?this.styles[f][Ve===0?Ve:Ve-1]:void 0;for(const $o in this.styles[f]){const Zo=parseInt($o,10);Zo>=Ve&&(Un=!0,Bn[Zo-Ve]=this.styles[f][$o],Nn&&Ve===0||delete this.styles[f][$o])}let qo=!1;for(Un&&!Nn&&(this.styles[f+Ue]=Bn,qo=!0),(qo||Vn>Ve)&&Ue--;Ue>0;)Je&&Je[Ue-1]?this.styles[f+Ue]={0:s({},Je[Ue-1])}:qn?this.styles[f+Ue]={0:s({},qn)}:delete this.styles[f+Ue],Ue--;this._forceClearCache=!0}insertCharStyleObject(f,Ve,Ue,Je){this.styles||(this.styles={});const Bn=this.styles[f],Vn=Bn?s({},Bn):{};Ue||(Ue=1);for(const Un in Vn){const qn=parseInt(Un,10);qn>=Ve&&(Bn[qn+Ue]=Vn[qn],Vn[qn-Ue]||delete Bn[qn])}if(this._forceClearCache=!0,Je){for(;Ue--;)Object.keys(Je[Ue]).length&&(this.styles[f]||(this.styles[f]={}),this.styles[f][Ve+Ue]=s({},Je[Ue]));return}if(!Bn)return;const Nn=Bn[Ve?Ve-1:1];for(;Nn&&Ue--;)this.styles[f][Ve+Ue]=s({},Nn)}insertNewStyleBlock(f,Ve,Ue){const Je=this.get2DCursorLocation(Ve,!0),Bn=[0];let Vn,Nn=0;for(let Un=0;Un<f.length;Un++)f[Un]===`
`?(Nn++,Bn[Nn]=0):Bn[Nn]++;for(Bn[0]>0&&(this.insertCharStyleObject(Je.lineIndex,Je.charIndex,Bn[0],Ue),Ue=Ue&&Ue.slice(Bn[0]+1)),Nn&&this.insertNewlineStyleObject(Je.lineIndex,Je.charIndex+Bn[0],Nn),Vn=1;Vn<Nn;Vn++)Bn[Vn]>0?this.insertCharStyleObject(Je.lineIndex+Vn,0,Bn[Vn],Ue):Ue&&this.styles[Je.lineIndex+Vn]&&Ue[0]&&(this.styles[Je.lineIndex+Vn][0]=Ue[0]),Ue=Ue&&Ue.slice(Bn[Vn]+1);Bn[Vn]>0&&this.insertCharStyleObject(Je.lineIndex+Vn,0,Bn[Vn],Ue)}removeChars(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f+1;this.removeStyleFromTo(f,Ve),this._text.splice(f,Ve-f),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(f,Ve,Ue){let Je=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ue;Je>Ue&&this.removeStyleFromTo(Ue,Je);const Bn=this.graphemeSplit(f);this.insertNewStyleBlock(Bn,Ue,Ve),this._text=[...this._text.slice(0,Ue),...Bn,...this._text.slice(Je)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(f,Ve,Ue){Ue<=f?(Ve===f?this._selectionDirection=M:this._selectionDirection===A&&(this._selectionDirection=M,this.selectionEnd=f),this.selectionStart=Ue):Ue>f&&Ue<Ve?this._selectionDirection===A?this.selectionEnd=Ue:this.selectionStart=Ue:(Ve===f?this._selectionDirection=A:this._selectionDirection===M&&(this._selectionDirection=A,this.selectionStart=Ve),this.selectionEnd=Ue)}}class Do extends ko{initHiddenTextarea(){const f=this.canvas&&re(this.canvas.getElement())||m(),Ve=f.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(Vn=>{let[Nn,Un]=Vn;return Ve.setAttribute(Nn,Un)});const{top:Ue,left:Je,fontSize:Bn}=this._calcTextareaPosition();Ve.style.cssText="position: absolute; top: ".concat(Ue,"; left: ").concat(Je,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(Bn,";"),(this.hiddenTextareaContainer||f.body).appendChild(Ve),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(Vn=>{let[Nn,Un]=Vn;return Ve.addEventListener(Nn,this[Un].bind(this))}),this.hiddenTextarea=Ve}blur(){this.abortCursorAnimation()}onKeyDown(f){if(!this.isEditing)return;const Ve=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(f.keyCode in Ve)this[Ve[f.keyCode]](f);else{if(!(f.keyCode in this.ctrlKeysMapDown)||!f.ctrlKey&&!f.metaKey)return;this[this.ctrlKeysMapDown[f.keyCode]](f)}f.stopImmediatePropagation(),f.preventDefault(),f.keyCode>=33&&f.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(f){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:f.keyCode in this.ctrlKeysMapUp&&(f.ctrlKey||f.metaKey)&&(this[this.ctrlKeysMapUp[f.keyCode]](f),f.stopImmediatePropagation(),f.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(f){const Ve=this.fromPaste;if(this.fromPaste=!1,f&&f.stopPropagation(),!this.isEditing)return;const Ue=()=>{this.updateFromTextArea(),this.fire(z),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void Ue();const Je=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,Bn=this._text.length,Vn=Je.length,Nn=this.selectionStart,Un=this.selectionEnd,qn=Nn!==Un;let qo,$o,Zo,ta,ea=Vn-Bn;const ra=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),na=Nn>ra.selectionStart;qn?($o=this._text.slice(Nn,Un),ea+=Un-Nn):Vn<Bn&&($o=na?this._text.slice(Un+ea,Un):this._text.slice(Nn,Nn-ea));const oa=Je.slice(ra.selectionEnd-ea,ra.selectionEnd);if($o&&$o.length&&(oa.length&&(qo=this.getSelectionStyles(Nn,Nn+1,!1),qo=oa.map(()=>qo[0])),qn?(Zo=Nn,ta=Un):na?(Zo=Un-$o.length,ta=Un):(Zo=Un,ta=Un+$o.length),this.removeStyleFromTo(Zo,ta)),oa.length){const{copyPasteData:ca}=p();Ve&&oa.join("")===ca.copiedText&&!o.disableStyleCopyPaste&&(qo=ca.copiedTextStyle),this.insertNewStyleBlock(oa,Nn,qo)}Ue()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(f){let{target:Ve}=f;const{selectionStart:Ue,selectionEnd:Je}=Ve;this.compositionStart=Ue,this.compositionEnd=Je,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:f}=p();f.copiedText=this.getSelectedText(),o.disableStyleCopyPaste?f.copiedTextStyle=void 0:f.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(f,Ve){let Ue,Je=this._getLineLeftOffset(f);return Ve>0&&(Ue=this.__charBounds[f][Ve-1],Je+=Ue.left+Ue.width),Je}getDownCursorOffset(f,Ve){const Ue=this._getSelectionForOffset(f,Ve),Je=this.get2DCursorLocation(Ue),Bn=Je.lineIndex;if(Bn===this._textLines.length-1||f.metaKey||f.keyCode===34)return this._text.length-Ue;const Vn=Je.charIndex,Nn=this._getWidthBeforeCursor(Bn,Vn),Un=this._getIndexOnLine(Bn+1,Nn);return this._textLines[Bn].slice(Vn).length+Un+1+this.missingNewlineOffset(Bn)}_getSelectionForOffset(f,Ve){return f.shiftKey&&this.selectionStart!==this.selectionEnd&&Ve?this.selectionEnd:this.selectionStart}getUpCursorOffset(f,Ve){const Ue=this._getSelectionForOffset(f,Ve),Je=this.get2DCursorLocation(Ue),Bn=Je.lineIndex;if(Bn===0||f.metaKey||f.keyCode===33)return-Ue;const Vn=Je.charIndex,Nn=this._getWidthBeforeCursor(Bn,Vn),Un=this._getIndexOnLine(Bn-1,Nn),qn=this._textLines[Bn].slice(0,Vn),qo=this.missingNewlineOffset(Bn-1);return-this._textLines[Bn-1].length+Un-qn.length+(1-qo)}_getIndexOnLine(f,Ve){const Ue=this._textLines[f];let Je,Bn,Vn=this._getLineLeftOffset(f),Nn=0;for(let Un=0,qn=Ue.length;Un<qn;Un++)if(Je=this.__charBounds[f][Un].width,Vn+=Je,Vn>Ve){Bn=!0;const qo=Vn-Je,$o=Vn,Zo=Math.abs(qo-Ve);Nn=Math.abs($o-Ve)<Zo?Un:Un-1;break}return Bn||(Nn=Ue.length-1),Nn}moveCursorDown(f){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",f)}moveCursorUp(f){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",f)}_moveCursorUpOrDown(f,Ve){const Ue=this["get".concat(f,"CursorOffset")](Ve,this._selectionDirection===A);if(Ve.shiftKey?this.moveCursorWithShift(Ue):this.moveCursorWithoutShift(Ue),Ue!==0){const Je=this.text.length;this.selectionStart=ds(0,this.selectionStart,Je),this.selectionEnd=ds(0,this.selectionEnd,Je),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(f){const Ve=this._selectionDirection===M?this.selectionStart+f:this.selectionEnd+f;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,Ve),f!==0}moveCursorWithoutShift(f){return f<0?(this.selectionStart+=f,this.selectionEnd=this.selectionStart):(this.selectionEnd+=f,this.selectionStart=this.selectionEnd),f!==0}moveCursorLeft(f){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",f)}_move(f,Ve,Ue){let Je;if(f.altKey)Je=this["findWordBoundary".concat(Ue)](this[Ve]);else{if(!f.metaKey&&f.keyCode!==35&&f.keyCode!==36)return this[Ve]+=Ue==="Left"?-1:1,!0;Je=this["findLineBoundary".concat(Ue)](this[Ve])}return Je!==void 0&&this[Ve]!==Je&&(this[Ve]=Je,!0)}_moveLeft(f,Ve){return this._move(f,Ve,"Left")}_moveRight(f,Ve){return this._move(f,Ve,"Right")}moveCursorLeftWithoutShift(f){let Ve=!0;return this._selectionDirection=M,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(Ve=this._moveLeft(f,"selectionStart")),this.selectionEnd=this.selectionStart,Ve}moveCursorLeftWithShift(f){return this._selectionDirection===A&&this.selectionStart!==this.selectionEnd?this._moveLeft(f,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=M,this._moveLeft(f,"selectionStart")):void 0}moveCursorRight(f){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",f)}_moveCursorLeftOrRight(f,Ve){const Ue="moveCursor".concat(f).concat(Ve.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[Ue](Ve)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(f){return this._selectionDirection===M&&this.selectionStart!==this.selectionEnd?this._moveRight(f,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=A,this._moveRight(f,"selectionEnd")):void 0}moveCursorRightWithoutShift(f){let Ve=!0;return this._selectionDirection=A,this.selectionStart===this.selectionEnd?(Ve=this._moveRight(f,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,Ve}}const Mo=qe=>!!qe.button;class Po extends Do{constructor(){super(...arguments),t(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new To(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(f){return this.draggableTextDelegate.onDragStart(f)}canDrop(f){return this.draggableTextDelegate.canDrop(f)}onMouseDown(f){if(!this.canvas)return;this.__newClickTime=+new Date;const Ve=f.pointer;this.isTripleClick(Ve)&&(this.fire("tripleclick",f),pe(f.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=Ve,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(f){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===f.x&&this.__lastPointer.y===f.y}doubleClickHandler(f){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(f.e))}tripleClickHandler(f){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(f.e))}_mouseDownHandler(f){let{e:Ve}=f;this.canvas&&this.editable&&!Mo(Ve)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(Ve)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(Ve)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(f){let{e:Ve}=f;this.canvas&&this.editable&&!Mo(Ve)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(f){let{e:Ve,transform:Ue}=f;const Je=this.draggableTextDelegate.end(Ve);if(this.canvas){this.canvas.textEditingManager.unregister(this);const Bn=this.canvas._activeObject;if(Bn&&Bn!==this)return}!this.editable||this.group&&!this.group.interactive||Ue&&Ue.actionPerformed||Mo(Ve)||Je||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(Ve),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(f){const Ve=this.getSelectionStartFromPointer(f),Ue=this.selectionStart,Je=this.selectionEnd;f.shiftKey?this.setSelectionStartEndWithShift(Ue,Je,Ve):(this.selectionStart=Ve,this.selectionEnd=Ve),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(f){const Ve=this.canvas.getScenePoint(f).transform(wt(this.calcTransformMatrix())).add(new ot(-this._getLeftOffset(),-this._getTopOffset()));let Ue=0,Je=0,Bn=0;for(let qn=0;qn<this._textLines.length&&Ue<=Ve.y;qn++)Ue+=this.getHeightOfLine(qn),Bn=qn,qn>0&&(Je+=this._textLines[qn-1].length+this.missingNewlineOffset(qn-1));let Vn=Math.abs(this._getLineLeftOffset(Bn));const Nn=this._textLines[Bn].length,Un=this.__charBounds[Bn];for(let qn=0;qn<Nn;qn++){const qo=Vn+Un[qn].kernedWidth;if(Ve.x<=qo){Math.abs(Ve.x-qo)<=Math.abs(Ve.x-Vn)&&Je++;break}Vn=qo,Je++}return Math.min(this.flipX?Nn-Je:Je,this._text.length)}}const Eo="moveCursorUp",Ao="moveCursorDown",jo="moveCursorLeft",Fo="moveCursorRight",Lo="exitEditing",Ro=s({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Lo,27:Lo,33:Eo,34:Ao,35:Fo,36:jo,37:jo,38:Eo,39:Fo,40:Ao},keysMapRtl:{9:Lo,27:Lo,33:Eo,34:Ao,35:jo,36:Fo,37:Fo,38:Eo,39:jo,40:Ao},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class Io extends Po{static getDefaults(){return s(s({},super.getDefaults()),Io.ownDefaults)}get type(){const f=super.type;return f==="itext"?"i-text":f}constructor(f,Ve){super(f,s(s({},Io.ownDefaults),Ve)),this.initBehavior()}_set(f,Ve){return this.isEditing&&this._savedProps&&f in this._savedProps?(this._savedProps[f]=Ve,this):(f==="canvas"&&(this.canvas instanceof xn&&this.canvas.textEditingManager.remove(this),Ve instanceof xn&&Ve.textEditingManager.add(this)),super._set(f,Ve))}setSelectionStart(f){f=Math.max(f,0),this._updateAndFire("selectionStart",f)}setSelectionEnd(f){f=Math.min(f,this.text.length),this._updateAndFire("selectionEnd",f)}_updateAndFire(f,Ve){this[f]!==Ve&&(this._fireSelectionChanged(),this[f]=Ve),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,Ue=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(f,Ve,Ue)}setSelectionStyles(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(f,Ve,Ue)}get2DCursorLocation(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,Ve=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(f,Ve)}render(f){super.render(f),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(f){const Ve=this.isEditing;this.isEditing=!1;const Ue=super.toCanvasElement(f);return this.isEditing=Ve,Ue}renderCursorOrSelection(){if(!this.isEditing)return;const f=this.clearContextTop(!0);if(!f)return;const Ve=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(f,Ve):this.renderCursor(f,Ve),this.canvas.contextTopDirty=!0,f.restore()}_getCursorBoundaries(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,Ve=arguments.length>1?arguments[1]:void 0;const Ue=this._getLeftOffset(),Je=this._getTopOffset(),Bn=this._getCursorBoundariesOffsets(f,Ve);return{left:Ue,top:Je,leftOffset:Bn.left,topOffset:Bn.top}}_getCursorBoundariesOffsets(f,Ve){return Ve?this.__getCursorBoundariesOffsets(f):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(f)}__getCursorBoundariesOffsets(f){let Ve=0,Ue=0;const{charIndex:Je,lineIndex:Bn}=this.get2DCursorLocation(f);for(let qn=0;qn<Bn;qn++)Ve+=this.getHeightOfLine(qn);const Vn=this._getLineLeftOffset(Bn),Nn=this.__charBounds[Bn][Je];Nn&&(Ue=Nn.left),this.charSpacing!==0&&Je===this._textLines[Bn].length&&(Ue-=this._getWidthOfCharSpacing());const Un={top:Ve,left:Vn+(Ue>0?Ue:0)};return this.direction==="rtl"&&(this.textAlign===A||this.textAlign===fo||this.textAlign===mo?Un.left*=-1:this.textAlign===M||this.textAlign===po?Un.left=Vn-(Ue>0?Ue:0):this.textAlign!==D&&this.textAlign!==vo||(Un.left=Vn-(Ue>0?Ue:0))),Un}renderCursorAt(f){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(f,!0),f)}renderCursor(f,Ve){this._renderCursor(f,Ve,this.selectionStart)}getCursorRenderingData(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(f);const Ue=this.get2DCursorLocation(f),Je=Ue.lineIndex,Bn=Ue.charIndex>0?Ue.charIndex-1:0,Vn=this.getValueOfPropertyAt(Je,Bn,"fontSize"),Nn=this.getObjectScaling().x*this.canvas.getZoom(),Un=this.cursorWidth/Nn,qn=this.getValueOfPropertyAt(Je,Bn,"deltaY"),qo=Ve.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(Je)/this.lineHeight-Vn*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(Je,Bn,"fill"),opacity:this._currentCursorOpacity,left:Ve.left+Ve.leftOffset-Un/2,top:qo+Ve.top+qn,width:Un,height:Vn}}_renderCursor(f,Ve,Ue){const{color:Je,opacity:Bn,left:Vn,top:Nn,width:Un,height:qn}=this.getCursorRenderingData(Ue,Ve);f.fillStyle=Je,f.globalAlpha=Bn,f.fillRect(Vn,Nn,Un,qn)}renderSelection(f,Ve){const Ue={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(f,Ue,Ve)}renderDragSourceEffect(){const f=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,f,this._getCursorBoundaries(f.selectionStart,!0))}renderDropTargetEffect(f){const Ve=this.getSelectionStartFromPointer(f);this.renderCursorAt(Ve)}_renderSelection(f,Ve,Ue){const Je=Ve.selectionStart,Bn=Ve.selectionEnd,Vn=this.textAlign.includes(fo),Nn=this.get2DCursorLocation(Je),Un=this.get2DCursorLocation(Bn),qn=Nn.lineIndex,qo=Un.lineIndex,$o=Nn.charIndex<0?0:Nn.charIndex,Zo=Un.charIndex<0?0:Un.charIndex;for(let ta=qn;ta<=qo;ta++){const ea=this._getLineLeftOffset(ta)||0;let ra=this.getHeightOfLine(ta),na=0,oa=0,ca=0;if(ta===qn&&(oa=this.__charBounds[qn][$o].left),ta>=qn&&ta<qo)ca=Vn&&!this.isEndOfWrapping(ta)?this.width:this.getLineWidth(ta)||5;else if(ta===qo)if(Zo===0)ca=this.__charBounds[qo][Zo].left;else{const Sa=this._getWidthOfCharSpacing();ca=this.__charBounds[qo][Zo-1].left+this.__charBounds[qo][Zo-1].width-Sa}na=ra,(this.lineHeight<1||ta===qo&&this.lineHeight>1)&&(ra/=this.lineHeight);let pa=Ue.left+ea+oa,la=ra,ma=0;const Ca=ca-oa;this.inCompositionMode?(f.fillStyle=this.compositionColor||"black",la=1,ma=ra):f.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===A||this.textAlign===fo||this.textAlign===mo?pa=this.width-pa-Ca:this.textAlign===M||this.textAlign===po?pa=Ue.left+ea-ca:this.textAlign!==D&&this.textAlign!==vo||(pa=Ue.left+ea-ca)),f.fillRect(pa,Ue.top+Ue.topOffset+ma,Ca,la),Ue.topOffset+=na}}getCurrentCharFontSize(){const f=this._getCurrentCharIndex();return this.getValueOfPropertyAt(f.l,f.c,"fontSize")}getCurrentCharColor(){const f=this._getCurrentCharIndex();return this.getValueOfPropertyAt(f.l,f.c,K)}_getCurrentCharIndex(){const f=this.get2DCursorLocation(this.selectionStart,!0),Ve=f.charIndex>0?f.charIndex-1:0;return{l:f.lineIndex,c:Ve}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}t(Io,"ownDefaults",Ro),t(Io,"type","IText"),tt.setClass(Io),tt.setClass(Io,"i-text");class Bo extends Io{static getDefaults(){return s(s({},super.getDefaults()),Bo.ownDefaults)}constructor(f,Ve){super(f,s(s({},Bo.ownDefaults),Ve))}static createControls(){return{controls:pi()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(fo)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(f){let Ve=0,Ue=0,Je=0;const Bn={};for(let Vn=0;Vn<f.graphemeLines.length;Vn++)f.graphemeText[Je]===`
`&&Vn>0?(Ue=0,Je++,Ve++):!this.splitByGrapheme&&this._reSpaceAndTab.test(f.graphemeText[Je])&&Vn>0&&(Ue++,Je++),Bn[Vn]={line:Ve,offset:Ue},Je+=f.graphemeLines[Vn].length,Ue+=f.graphemeLines[Vn].length;return Bn}styleHas(f,Ve){if(this._styleMap&&!this.isWrapping){const Ue=this._styleMap[Ve];Ue&&(Ve=Ue.line)}return super.styleHas(f,Ve)}isEmptyStyles(f){if(!this.styles)return!0;let Ve,Ue=0,Je=f+1,Bn=!1;const Vn=this._styleMap[f],Nn=this._styleMap[f+1];Vn&&(f=Vn.line,Ue=Vn.offset),Nn&&(Je=Nn.line,Bn=Je===f,Ve=Nn.offset);const Un=f===void 0?this.styles:{line:this.styles[f]};for(const qn in Un)for(const qo in Un[qn]){const $o=parseInt(qo,10);if($o>=Ue&&(!Bn||$o<Ve))for(const Zo in Un[qn][qo])return!1}return!0}_getStyleDeclaration(f,Ve){if(this._styleMap&&!this.isWrapping){const Ue=this._styleMap[f];if(!Ue)return{};f=Ue.line,Ve=Ue.offset+Ve}return super._getStyleDeclaration(f,Ve)}_setStyleDeclaration(f,Ve,Ue){const Je=this._styleMap[f];super._setStyleDeclaration(Je.line,Je.offset+Ve,Ue)}_deleteStyleDeclaration(f,Ve){const Ue=this._styleMap[f];super._deleteStyleDeclaration(Ue.line,Ue.offset+Ve)}_getLineStyle(f){const Ve=this._styleMap[f];return!!this.styles[Ve.line]}_setLineStyle(f){const Ve=this._styleMap[f];super._setLineStyle(Ve.line)}_wrapText(f,Ve){this.isWrapping=!0;const Ue=this.getGraphemeDataForRender(f),Je=[];for(let Bn=0;Bn<Ue.wordsData.length;Bn++)Je.push(...this._wrapLine(Bn,Ve,Ue));return this.isWrapping=!1,Je}getGraphemeDataForRender(f){const Ve=this.splitByGrapheme,Ue=Ve?"":" ";let Je=0;return{wordsData:f.map((Bn,Vn)=>{let Nn=0;const Un=Ve?this.graphemeSplit(Bn):this.wordSplit(Bn);return Un.length===0?[{word:[],width:0}]:Un.map(qn=>{const qo=Ve?[qn]:this.graphemeSplit(qn),$o=this._measureWord(qo,Vn,Nn);return Je=Math.max($o,Je),Nn+=qo.length+Ue.length,{word:qo,width:$o}})}),largestWordWidth:Je}}_measureWord(f,Ve){let Ue,Je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,Bn=0;for(let Vn=0,Nn=f.length;Vn<Nn;Vn++)Bn+=this._getGraphemeBox(f[Vn],Ve,Vn+Je,Ue,!0).kernedWidth,Ue=f[Vn];return Bn}wordSplit(f){return f.split(this._wordJoiners)}_wrapLine(f,Ve,Ue){let{largestWordWidth:Je,wordsData:Bn}=Ue,Vn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const Nn=this._getWidthOfCharSpacing(),Un=this.splitByGrapheme,qn=[],qo=Un?"":" ";let $o=0,Zo=[],ta=0,ea=0,ra=!0;Ve-=Vn;const na=Math.max(Ve,Je,this.dynamicMinWidth),oa=Bn[f];let ca;for(ta=0,ca=0;ca<oa.length;ca++){const{word:pa,width:la}=oa[ca];ta+=pa.length,$o+=ea+la-Nn,$o>na&&!ra?(qn.push(Zo),Zo=[],$o=la,ra=!0):$o+=Nn,ra||Un||Zo.push(qo),Zo=Zo.concat(pa),ea=Un?0:this._measureWord([qo],f,ta),ta++,ra=!1}return ca&&qn.push(Zo),Je+Vn>this.dynamicMinWidth&&(this.dynamicMinWidth=Je-Nn+Vn),qn}isEndOfWrapping(f){return!this._styleMap[f+1]||this._styleMap[f+1].line!==this._styleMap[f].line}missingNewlineOffset(f,Ve){return this.splitByGrapheme&&!Ve?this.isEndOfWrapping(f)?1:0:1}_splitTextIntoLines(f){const Ve=super._splitTextIntoLines(f),Ue=this._wrapText(Ve.lines,this.width),Je=new Array(Ue.length);for(let Bn=0;Bn<Ue.length;Bn++)Je[Bn]=Ue[Bn].join("");return Ve.lines=Je,Ve.graphemeLines=Ue,Ve}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const f=new Map;for(const Ve in this._styleMap){const Ue=parseInt(Ve,10);if(this._textLines[Ue]){const Je=this._styleMap[Ve].line;f.set("".concat(Je),!0)}}for(const Ve in this.styles)f.has(Ve)||delete this.styles[Ve]}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...f])}}t(Bo,"type","Textbox"),t(Bo,"textLayoutProperties",[...Io.textLayoutProperties,"width"]),t(Bo,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),tt.setClass(Bo);class Xo extends xr{shouldPerformLayout(f){return!!f.target.clipPath&&super.shouldPerformLayout(f)}shouldLayoutClipPath(){return!1}calcLayoutResult(f,Ve){const{target:Ue}=f,{clipPath:Je,group:Bn}=Ue;if(!Je||!this.shouldPerformLayout(f))return;const{width:Vn,height:Nn}=me(_r(Ue,Je)),Un=new ot(Vn,Nn);if(Je.absolutePositioned)return{center:Se(Je.getRelativeCenterPoint(),void 0,Bn?Bn.calcTransformMatrix():void 0),size:Un};{const qn=Je.getRelativeCenterPoint().transform(Ue.calcOwnMatrix(),!0);if(this.shouldPerformLayout(f)){const{center:qo=new ot,correction:$o=new ot}=this.calcBoundingBox(Ve,f)||{};return{center:qo.add(qn),correction:$o.subtract(qn),size:Un}}return{center:Ue.getRelativeCenterPoint().add(qn),size:Un}}}}t(Xo,"type","clip-path"),tt.setClass(Xo);class Yo extends xr{getInitialSize(f,Ve){let{target:Ue}=f,{size:Je}=Ve;return new ot(Ue.width||Je.x,Ue.height||Je.y)}}t(Yo,"type","fixed"),tt.setClass(Yo);class Wo extends Tr{subscribeTargets(f){const Ve=f.target;f.targets.reduce((Ue,Je)=>(Je.parent&&Ue.add(Je.parent),Ue),new Set).forEach(Ue=>{Ue.layoutManager.subscribeTargets({target:Ue,targets:[Ve]})})}unsubscribeTargets(f){const Ve=f.target,Ue=Ve.getObjects();f.targets.reduce((Je,Bn)=>(Bn.parent&&Je.add(Bn.parent),Je),new Set).forEach(Je=>{!Ue.some(Bn=>Bn.parent===Je)&&Je.layoutManager.unsubscribeTargets({target:Je,targets:[Ve]})})}}class Vo extends Dr{static getDefaults(){return s(s({},super.getDefaults()),Vo.ownDefaults)}constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Vo.ownDefaults),this.setOptions(Ve);const{left:Ue,top:Je,layoutManager:Bn}=Ve;this.groupInit(f,{left:Ue,top:Je,layoutManager:Bn??new Wo})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var f=arguments.length,Ve=new Array(f),Ue=0;Ue<f;Ue++)Ve[Ue]=arguments[Ue];this.multiSelectionStacking==="selection-order"?this.add(...Ve):Ve.forEach(Je=>{const Bn=this._objects.findIndex(Nn=>Nn.isInFrontOf(Je)),Vn=Bn===-1?this.size():Bn;this.insertAt(Vn,Je)})}canEnterGroup(f){return this.getObjects().some(Ve=>Ve.isDescendantOf(f)||f.isDescendantOf(Ve))?(a("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(f)}enterGroup(f,Ve){f.parent&&f.parent===f.group?f.parent._exitGroup(f):f.group&&f.parent!==f.group&&f.group.remove(f),this._enterGroup(f,Ve)}exitGroup(f,Ve){this._exitGroup(f,Ve),f.parent&&f.parent._enterGroup(f,!0)}_onAfterObjectsChange(f,Ve){super._onAfterObjectsChange(f,Ve);const Ue=new Set;Ve.forEach(Je=>{const{parent:Bn}=Je;Bn&&Ue.add(Bn)}),f===vr?Ue.forEach(Je=>{Je._onAfterObjectsChange(mr,Ve)}):Ue.forEach(Je=>{Je._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(f,Ve,Ue){f.save(),f.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const Je=s(s({hasControls:!1},Ue),{},{forActiveSelection:!0});for(let Bn=0;Bn<this._objects.length;Bn++)this._objects[Bn]._renderControls(f,Je);super._renderControls(f,Ve),f.restore()}}t(Vo,"type","ActiveSelection"),t(Vo,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),tt.setClass(Vo),tt.setClass(Vo,"activeSelection");class zo{constructor(){t(this,"resources",{})}applyFilters(f,Ve,Ue,Je,Bn){const Vn=Bn.getContext("2d");if(!Vn)return;Vn.drawImage(Ve,0,0,Ue,Je);const Nn={sourceWidth:Ue,sourceHeight:Je,imageData:Vn.getImageData(0,0,Ue,Je),originalEl:Ve,originalImageData:Vn.getImageData(0,0,Ue,Je),canvasEl:Bn,ctx:Vn,filterBackend:this};f.forEach(qn=>{qn.applyTo(Nn)});const{imageData:Un}=Nn;return Un.width===Ue&&Un.height===Je||(Bn.width=Un.width,Bn.height=Un.height),Vn.putImageData(Un,0,0),Nn}}class Ho{constructor(){let{tileSize:f=o.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),t(this,"resources",{}),this.tileSize=f,this.setupGLContext(f,f),this.captureGPUInfo()}setupGLContext(f,Ve){this.dispose(),this.createWebGLCanvas(f,Ve)}createWebGLCanvas(f,Ve){const Ue=vt({width:f,height:Ve}),Je=Ue.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});Je&&(Je.clearColor(0,0,0,0),this.canvas=Ue,this.gl=Je)}applyFilters(f,Ve,Ue,Je,Bn,Vn){const Nn=this.gl,Un=Bn.getContext("2d");if(!Nn||!Un)return;let qn;Vn&&(qn=this.getCachedTexture(Vn,Ve));const qo={originalWidth:Ve.width||Ve.naturalWidth||0,originalHeight:Ve.height||Ve.naturalHeight||0,sourceWidth:Ue,sourceHeight:Je,destinationWidth:Ue,destinationHeight:Je,context:Nn,sourceTexture:this.createTexture(Nn,Ue,Je,qn?void 0:Ve),targetTexture:this.createTexture(Nn,Ue,Je),originalTexture:qn||this.createTexture(Nn,Ue,Je,qn?void 0:Ve),passes:f.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:Bn},$o=Nn.createFramebuffer();return Nn.bindFramebuffer(Nn.FRAMEBUFFER,$o),f.forEach(Zo=>{Zo&&Zo.applyTo(qo)}),function(Zo){const ta=Zo.targetCanvas,ea=ta.width,ra=ta.height,na=Zo.destinationWidth,oa=Zo.destinationHeight;ea===na&&ra===oa||(ta.width=na,ta.height=oa)}(qo),this.copyGLTo2D(Nn,qo),Nn.bindTexture(Nn.TEXTURE_2D,null),Nn.deleteTexture(qo.sourceTexture),Nn.deleteTexture(qo.targetTexture),Nn.deleteFramebuffer($o),Un.setTransform(1,0,0,1,0,0),qo}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(f,Ve,Ue,Je,Bn){const{NEAREST:Vn,TEXTURE_2D:Nn,RGBA:Un,UNSIGNED_BYTE:qn,CLAMP_TO_EDGE:qo,TEXTURE_MAG_FILTER:$o,TEXTURE_MIN_FILTER:Zo,TEXTURE_WRAP_S:ta,TEXTURE_WRAP_T:ea}=f,ra=f.createTexture();return f.bindTexture(Nn,ra),f.texParameteri(Nn,$o,Bn||Vn),f.texParameteri(Nn,Zo,Bn||Vn),f.texParameteri(Nn,ta,qo),f.texParameteri(Nn,ea,qo),Je?f.texImage2D(Nn,0,Un,Un,qn,Je):f.texImage2D(Nn,0,Un,Ve,Ue,0,Un,qn,null),ra}getCachedTexture(f,Ve,Ue){const{textureCache:Je}=this;if(Je[f])return Je[f];{const Bn=this.createTexture(this.gl,Ve.width,Ve.height,Ve,Ue);return Bn&&(Je[f]=Bn),Bn}}evictCachesForKey(f){this.textureCache[f]&&(this.gl.deleteTexture(this.textureCache[f]),delete this.textureCache[f])}copyGLTo2D(f,Ve){const Ue=f.canvas,Je=Ve.targetCanvas,Bn=Je.getContext("2d");if(!Bn)return;Bn.translate(0,Je.height),Bn.scale(1,-1);const Vn=Ue.height-Je.height;Bn.drawImage(Ue,0,Vn,Je.width,Je.height,0,0,Je.width,Je.height)}copyGLTo2DPutImageData(f,Ve){const Ue=Ve.targetCanvas.getContext("2d"),Je=Ve.destinationWidth,Bn=Ve.destinationHeight,Vn=Je*Bn*4;if(!Ue)return;const Nn=new Uint8Array(this.imageBuffer,0,Vn),Un=new Uint8ClampedArray(this.imageBuffer,0,Vn);f.readPixels(0,0,Je,Bn,f.RGBA,f.UNSIGNED_BYTE,Nn);const qn=new ImageData(Un,Je,Bn);Ue.putImageData(qn,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const f=this.gl,Ve={renderer:"",vendor:""};if(!f)return Ve;const Ue=f.getExtension("WEBGL_debug_renderer_info");if(Ue){const Je=f.getParameter(Ue.UNMASKED_RENDERER_WEBGL),Bn=f.getParameter(Ue.UNMASKED_VENDOR_WEBGL);Je&&(Ve.renderer=Je.toLowerCase()),Bn&&(Ve.vendor=Bn.toLowerCase())}return this.gpuInfo=Ve,Ve}}let Go;function No(){const{WebGLProbe:qe}=p();return qe.queryWebGL(pt()),o.enableGLFiltering&&qe.isSupported(o.textureSize)?new Ho({tileSize:o.textureSize}):new zo}function Uo(){return!Go&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Go=No()),Go}const Ko=["filters","resizeFilter","src","crossOrigin","type"],Jo=["cropX","cropY"];class Qo extends yi{static getDefaults(){return s(s({},super.getDefaults()),Qo.ownDefaults)}constructor(f,Ve){super(),t(this,"_lastScaleX",1),t(this,"_lastScaleY",1),t(this,"_filterScalingX",1),t(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Qo.ownDefaults),this.setOptions(Ve),this.cacheKey="texture".concat(ft()),this.setElement(typeof f=="string"?(this.canvas&&re(this.canvas.getElement())||m()).getElementById(f):f,Ve)}getElement(){return this._element}setElement(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=f,this._originalElement=f,this._setWidthHeight(Ve),f.classList.add(Qo.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(f){const Ve=Uo(!1);Ve instanceof Ho&&Ve.evictCachesForKey(f)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(f=>{const Ve=this[f];Ve&&p().dispose(Ve),this[f]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const f=this.getElement();return f?{width:f.naturalWidth||f.width,height:f.naturalHeight||f.height}:{width:0,height:0}}_stroke(f){if(!this.stroke||this.strokeWidth===0)return;const Ve=this.width/2,Ue=this.height/2;f.beginPath(),f.moveTo(-Ve,-Ue),f.lineTo(Ve,-Ue),f.lineTo(Ve,Ue),f.lineTo(-Ve,Ue),f.lineTo(-Ve,-Ue),f.closePath()}toObject(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const Ve=[];return this.filters.forEach(Ue=>{Ue&&Ve.push(Ue.toObject())}),s(s({},super.toObject([...Jo,...f])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:Ve},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const f=[],Ve=this._element,Ue=-this.width/2,Je=-this.height/2;let Bn=[],Vn=[],Nn="",Un="";if(!Ve)return[];if(this.hasCrop()){const qn=ft();Bn.push('<clipPath id="imageCrop_'+qn+`">
`,'	<rect x="'+Ue+'" y="'+Je+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),Nn=' clip-path="url(#imageCrop_'+qn+')" '}if(this.imageSmoothing||(Un=' image-rendering="optimizeSpeed"'),f.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(Ue-this.cropX,'" y="').concat(Je-this.cropY,'" width="').concat(Ve.width||Ve.naturalWidth,'" height="').concat(Ve.height||Ve.naturalHeight,'"').concat(Un).concat(Nn,`></image>
`)),this.stroke||this.strokeDashArray){const qn=this.fill;this.fill=null,Vn=['	<rect x="'.concat(Ue,'" y="').concat(Je,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=qn}return Bn=this.paintFirst!==K?Bn.concat(Vn,f):Bn.concat(f,Vn),Bn}getSrc(f){const Ve=f?this._element:this._originalElement;return Ve?Ve.toDataURL?Ve.toDataURL():this.srcFromAttribute?Ve.getAttribute("src")||"":Ve.src:this.src||""}getSvgSrc(f){return this.getSrc(f)}setSrc(f){let{crossOrigin:Ve,signal:Ue}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Rt(f,{crossOrigin:Ve,signal:Ue}).then(Je=>{Ve!==void 0&&this.set({crossOrigin:Ve}),this.setElement(Je)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const f=this.resizeFilter,Ve=this.minimumScaleTrigger,Ue=this.getTotalObjectScaling(),Je=Ue.x,Bn=Ue.y,Vn=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!f||Je>Ve&&Bn>Ve)return this._element=Vn,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=Je,void(this._lastScaleY=Bn);const Nn=vt(Vn),{width:Un,height:qn}=Vn;this._element=Nn,this._lastScaleX=f.scaleX=Je,this._lastScaleY=f.scaleY=Bn,Uo().applyFilters([f],Vn,Un,qn,this._element),this._filterScalingX=Nn.width/this._originalElement.width,this._filterScalingY=Nn.height/this._originalElement.height}applyFilters(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(f=f.filter(Bn=>Bn&&!Bn.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),f.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const Ve=this._originalElement,Ue=Ve.naturalWidth||Ve.width,Je=Ve.naturalHeight||Ve.height;if(this._element===this._originalElement){const Bn=vt({width:Ue,height:Je});this._element=Bn,this._filteredEl=Bn}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,Ue,Je),this._lastScaleX=1,this._lastScaleY=1);Uo().applyFilters(f,this._originalElement,Ue,Je,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(f){f.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(f),this._renderPaintInOrder(f)}drawCacheOnCanvas(f){f.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(f)}shouldCache(){return this.needsItsOwnCache()}_renderFill(f){const Ve=this._element;if(!Ve)return;const Ue=this._filterScalingX,Je=this._filterScalingY,Bn=this.width,Vn=this.height,Nn=Math.max(this.cropX,0),Un=Math.max(this.cropY,0),qn=Ve.naturalWidth||Ve.width,qo=Ve.naturalHeight||Ve.height,$o=Nn*Ue,Zo=Un*Je,ta=Math.min(Bn*Ue,qn-$o),ea=Math.min(Vn*Je,qo-Zo),ra=-Bn/2,na=-Vn/2,oa=Math.min(Bn,qn/Ue-Nn),ca=Math.min(Vn,qo/Je-Un);Ve&&f.drawImage(Ve,$o,Zo,ta,ea,ra,na,oa,ca)}_needsResize(){const f=this.getTotalObjectScaling();return f.x!==this._lastScaleX||f.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:f,height:Ve}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const Ue=this.getOriginalSize();this.width=f||Ue.width,this.height=Ve||Ue.height}parsePreserveAspectRatioAttribute(){const f=Jt(this.preserveAspectRatio||""),Ve=this.width,Ue=this.height,Je={width:Ve,height:Ue};let Bn,Vn=this._element.width,Nn=this._element.height,Un=1,qn=1,qo=0,$o=0,Zo=0,ta=0;return!f||f.alignX===j&&f.alignY===j?(Un=Ve/Vn,qn=Ue/Nn):(f.meetOrSlice==="meet"&&(Un=qn=Mr(this._element,Je),Bn=(Ve-Vn*Un)/2,f.alignX==="Min"&&(qo=-Bn),f.alignX==="Max"&&(qo=Bn),Bn=(Ue-Nn*qn)/2,f.alignY==="Min"&&($o=-Bn),f.alignY==="Max"&&($o=Bn)),f.meetOrSlice==="slice"&&(Un=qn=Pr(this._element,Je),Bn=Vn-Ve/Un,f.alignX==="Mid"&&(Zo=Bn/2),f.alignX==="Max"&&(Zo=Bn),Bn=Nn-Ue/qn,f.alignY==="Mid"&&(ta=Bn/2),f.alignY==="Max"&&(ta=Bn),Vn=Ve/Un,Nn=Ue/qn)),{width:Vn,height:Nn,scaleX:Un,scaleY:qn,offsetLeft:qo,offsetTop:$o,cropX:Zo,cropY:ta}}static fromObject(f,Ve){let{filters:Ue,resizeFilter:Je,src:Bn,crossOrigin:Vn,type:Nn}=f,Un=i(f,Ko);return Promise.all([Rt(Bn,s(s({},Ve),{},{crossOrigin:Vn})),Ue&&It(Ue,Ve),Je&&It([Je],Ve),Bt(Un,Ve)]).then(qn=>{let[qo,$o=[],[Zo]=[],ta={}]=qn;return new this(qo,s(s({},Un),{},{src:Bn,filters:$o,resizeFilter:Zo},ta))})}static fromURL(f){let{crossOrigin:Ve=null,signal:Ue}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Je=arguments.length>2?arguments[2]:void 0;return Rt(f,{crossOrigin:Ve,signal:Ue}).then(Bn=>new this(Bn,Je))}static async fromElement(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ue=arguments.length>2?arguments[2]:void 0;const Je=ur(f,this.ATTRIBUTE_NAMES,Ue);return this.fromURL(Je["xlink:href"],Ve,Je).catch(Bn=>(a("log","Unable to parse Image",Bn),null))}}t(Qo,"type","Image"),t(Qo,"cacheProperties",[...fs,...Jo]),t(Qo,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),t(Qo,"CSS_CANVAS","canvas-img"),t(Qo,"ATTRIBUTE_NAMES",[...ji,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),tt.setClass(Qo),tt.setSVGClass(Qo);Xe(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Oa=qe=>qe.webgl!==void 0,Da="precision highp float",Ma=`
    `.concat(Da,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),Pa=["type"],Ea=["type"],Aa=new RegExp(Da,"g");class ja{get type(){return this.constructor.type}constructor(){let f=i(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Pa);Object.assign(this,this.constructor.defaults,f)}getFragmentSource(){return Ma}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(f){let Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:Je="highp"}}=p();Je!=="highp"&&(Ve=Ve.replace(Aa,Da.replace("highp",Je)));const Bn=f.createShader(f.VERTEX_SHADER),Vn=f.createShader(f.FRAGMENT_SHADER),Nn=f.createProgram();if(!Bn||!Vn||!Nn)throw new h("Vertex, fragment shader or program creation error");if(f.shaderSource(Bn,Ue),f.compileShader(Bn),!f.getShaderParameter(Bn,f.COMPILE_STATUS))throw new h("Vertex shader compile error for ".concat(this.type,": ").concat(f.getShaderInfoLog(Bn)));if(f.shaderSource(Vn,Ve),f.compileShader(Vn),!f.getShaderParameter(Vn,f.COMPILE_STATUS))throw new h("Fragment shader compile error for ".concat(this.type,": ").concat(f.getShaderInfoLog(Vn)));if(f.attachShader(Nn,Bn),f.attachShader(Nn,Vn),f.linkProgram(Nn),!f.getProgramParameter(Nn,f.LINK_STATUS))throw new h('Shader link error for "'.concat(this.type,'" ').concat(f.getProgramInfoLog(Nn)));const Un=this.getUniformLocations(f,Nn)||{};return Un.uStepW=f.getUniformLocation(Nn,"uStepW"),Un.uStepH=f.getUniformLocation(Nn,"uStepH"),{program:Nn,attributeLocations:this.getAttributeLocations(f,Nn),uniformLocations:Un}}getAttributeLocations(f,Ve){return{aPosition:f.getAttribLocation(Ve,"aPosition")}}getUniformLocations(f,Ve){const Ue=this.constructor.uniformLocations,Je={};for(let Bn=0;Bn<Ue.length;Bn++)Je[Ue[Bn]]=f.getUniformLocation(Ve,Ue[Bn]);return Je}sendAttributeData(f,Ve,Ue){const Je=Ve.aPosition,Bn=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,Bn),f.enableVertexAttribArray(Je),f.vertexAttribPointer(Je,2,f.FLOAT,!1,0,0),f.bufferData(f.ARRAY_BUFFER,Ue,f.STATIC_DRAW)}_setupFrameBuffer(f){const Ve=f.context;if(f.passes>1){const Ue=f.destinationWidth,Je=f.destinationHeight;f.sourceWidth===Ue&&f.sourceHeight===Je||(Ve.deleteTexture(f.targetTexture),f.targetTexture=f.filterBackend.createTexture(Ve,Ue,Je)),Ve.framebufferTexture2D(Ve.FRAMEBUFFER,Ve.COLOR_ATTACHMENT0,Ve.TEXTURE_2D,f.targetTexture,0)}else Ve.bindFramebuffer(Ve.FRAMEBUFFER,null),Ve.finish()}_swapTextures(f){f.passes--,f.pass++;const Ve=f.targetTexture;f.targetTexture=f.sourceTexture,f.sourceTexture=Ve}isNeutralState(f){return!1}applyTo(f){Oa(f)?(this._setupFrameBuffer(f),this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)}applyTo2d(f){}getCacheKey(){return this.type}retrieveShader(f){const Ve=this.getCacheKey();return f.programCache[Ve]||(f.programCache[Ve]=this.createProgram(f.context)),f.programCache[Ve]}applyToWebGL(f){const Ve=f.context,Ue=this.retrieveShader(f);f.pass===0&&f.originalTexture?Ve.bindTexture(Ve.TEXTURE_2D,f.originalTexture):Ve.bindTexture(Ve.TEXTURE_2D,f.sourceTexture),Ve.useProgram(Ue.program),this.sendAttributeData(Ve,Ue.attributeLocations,f.aPosition),Ve.uniform1f(Ue.uniformLocations.uStepW,1/f.sourceWidth),Ve.uniform1f(Ue.uniformLocations.uStepH,1/f.sourceHeight),this.sendUniformData(Ve,Ue.uniformLocations),Ve.viewport(0,0,f.destinationWidth,f.destinationHeight),Ve.drawArrays(Ve.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(f,Ve,Ue){f.activeTexture(Ue),f.bindTexture(f.TEXTURE_2D,Ve),f.activeTexture(f.TEXTURE0)}unbindAdditionalTexture(f,Ve){f.activeTexture(Ve),f.bindTexture(f.TEXTURE_2D,null),f.activeTexture(f.TEXTURE0)}sendUniformData(f,Ve){}createHelpLayer(f){if(!f.helpLayer){const{sourceWidth:Ve,sourceHeight:Ue}=f,Je=vt({width:Ve,height:Ue});f.helpLayer=Je}}toObject(){const f=Object.keys(this.constructor.defaults||{});return s({type:this.type},f.reduce((Ve,Ue)=>(Ve[Ue]=this[Ue],Ve),{}))}toJSON(){return this.toObject()}static async fromObject(f,Ve){return new this(i(f,Ea))}}t(ja,"type","BaseFilter"),t(ja,"uniformLocations",[]);const Fa={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class La extends ja{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(Fa[this.mode],`
        }
      }
      `)}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=new Ut(this.color).getSource(),Je=this.alpha,Bn=Ue[0]*Je,Vn=Ue[1]*Je,Nn=Ue[2]*Je,Un=1-Je;for(let qn=0;qn<Ve.length;qn+=4){const qo=Ve[qn],$o=Ve[qn+1],Zo=Ve[qn+2];let ta,ea,ra;switch(this.mode){case"multiply":ta=qo*Bn/255,ea=$o*Vn/255,ra=Zo*Nn/255;break;case"screen":ta=255-(255-qo)*(255-Bn)/255,ea=255-(255-$o)*(255-Vn)/255,ra=255-(255-Zo)*(255-Nn)/255;break;case"add":ta=qo+Bn,ea=$o+Vn,ra=Zo+Nn;break;case"difference":ta=Math.abs(qo-Bn),ea=Math.abs($o-Vn),ra=Math.abs(Zo-Nn);break;case"subtract":ta=qo-Bn,ea=$o-Vn,ra=Zo-Nn;break;case"darken":ta=Math.min(qo,Bn),ea=Math.min($o,Vn),ra=Math.min(Zo,Nn);break;case"lighten":ta=Math.max(qo,Bn),ea=Math.max($o,Vn),ra=Math.max(Zo,Nn);break;case"overlay":ta=Bn<128?2*qo*Bn/255:255-2*(255-qo)*(255-Bn)/255,ea=Vn<128?2*$o*Vn/255:255-2*(255-$o)*(255-Vn)/255,ra=Nn<128?2*Zo*Nn/255:255-2*(255-Zo)*(255-Nn)/255;break;case"exclusion":ta=Bn+qo-2*Bn*qo/255,ea=Vn+$o-2*Vn*$o/255,ra=Nn+Zo-2*Nn*Zo/255;break;case"tint":ta=Bn+qo*Un,ea=Vn+$o*Un,ra=Nn+Zo*Un}Ve[qn]=ta,Ve[qn+1]=ea,Ve[qn+2]=ra}}sendUniformData(f,Ve){const Ue=new Ut(this.color).getSource();Ue[0]=this.alpha*Ue[0]/255,Ue[1]=this.alpha*Ue[1]/255,Ue[2]=this.alpha*Ue[2]/255,Ue[3]=this.alpha,f.uniform4fv(Ve.uColor,Ue)}}t(La,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),t(La,"type","BlendColor"),t(La,"uniformLocations",["uColor"]),tt.setClass(La);const Ra={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},Ia=["type","image"];class Ba extends ja{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Ra[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(f){const Ve=f.context,Ue=this.createTexture(f.filterBackend,this.image);this.bindAdditionalTexture(Ve,Ue,Ve.TEXTURE1),super.applyToWebGL(f),this.unbindAdditionalTexture(Ve,Ve.TEXTURE1)}createTexture(f,Ve){return f.getCachedTexture(Ve.cacheKey,Ve.getElement())}calculateMatrix(){const f=this.image,{width:Ve,height:Ue}=f.getElement();return[1/f.scaleX,0,0,0,1/f.scaleY,0,-f.left/Ve,-f.top/Ue,1]}applyTo2d(f){let{imageData:{data:Ve,width:Ue,height:Je},filterBackend:{resources:Bn}}=f;const Vn=this.image;Bn.blendImage||(Bn.blendImage=pt());const Nn=Bn.blendImage,Un=Nn.getContext("2d");Nn.width!==Ue||Nn.height!==Je?(Nn.width=Ue,Nn.height=Je):Un.clearRect(0,0,Ue,Je),Un.setTransform(Vn.scaleX,0,0,Vn.scaleY,Vn.left,Vn.top),Un.drawImage(Vn.getElement(),0,0,Ue,Je);const qn=Un.getImageData(0,0,Ue,Je).data;for(let qo=0;qo<Ve.length;qo+=4){const $o=Ve[qo],Zo=Ve[qo+1],ta=Ve[qo+2],ea=Ve[qo+3],ra=qn[qo],na=qn[qo+1],oa=qn[qo+2],ca=qn[qo+3];switch(this.mode){case"multiply":Ve[qo]=$o*ra/255,Ve[qo+1]=Zo*na/255,Ve[qo+2]=ta*oa/255,Ve[qo+3]=ea*ca/255;break;case"mask":Ve[qo+3]=ca}}}sendUniformData(f,Ve){const Ue=this.calculateMatrix();f.uniform1i(Ve.uImage,1),f.uniformMatrix3fv(Ve.uTransformMatrix,!1,Ue)}toObject(){return s(s({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(f,Ve){let{type:Ue,image:Je}=f,Bn=i(f,Ia);return Qo.fromObject(Je,Ve).then(Vn=>new this(s(s({},Bn),{},{image:Vn})))}}t(Ba,"type","BlendImage"),t(Ba,"defaults",{mode:"multiply",alpha:1}),t(Ba,"uniformLocations",["uTransformMatrix","uImage"]),tt.setClass(Ba);class Xa extends ja{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(f){Oa(f)?(this.aspectRatio=f.sourceWidth/f.sourceHeight,f.passes++,this._setupFrameBuffer(f),this.horizontal=!0,this.applyToWebGL(f),this._swapTextures(f),this._setupFrameBuffer(f),this.horizontal=!1,this.applyToWebGL(f),this._swapTextures(f)):this.applyTo2d(f)}applyTo2d(f){f.imageData=this.simpleBlur(f)}simpleBlur(f){let{ctx:Ve,imageData:Ue,filterBackend:{resources:Je}}=f;const{width:Bn,height:Vn}=Ue;Je.blurLayer1||(Je.blurLayer1=pt(),Je.blurLayer2=pt());const Nn=Je.blurLayer1,Un=Je.blurLayer2;Nn.width===Bn&&Nn.height===Vn||(Un.width=Nn.width=Bn,Un.height=Nn.height=Vn);const qn=Nn.getContext("2d"),qo=Un.getContext("2d"),$o=15,Zo=.06*this.blur*.5;let ta,ea,ra,na;for(qn.putImageData(Ue,0,0),qo.clearRect(0,0,Bn,Vn),na=-15;na<=$o;na++)ta=(Math.random()-.5)/4,ea=na/$o,ra=Zo*ea*Bn+ta,qo.globalAlpha=1-Math.abs(ea),qo.drawImage(Nn,ra,ta),qn.drawImage(Un,0,0),qo.globalAlpha=1,qo.clearRect(0,0,Un.width,Un.height);for(na=-15;na<=$o;na++)ta=(Math.random()-.5)/4,ea=na/$o,ra=Zo*ea*Vn+ta,qo.globalAlpha=1-Math.abs(ea),qo.drawImage(Nn,ta,ra),qn.drawImage(Un,0,0),qo.globalAlpha=1,qo.clearRect(0,0,Un.width,Un.height);Ve.drawImage(Nn,0,0);const oa=Ve.getImageData(0,0,Nn.width,Nn.height);return qn.globalAlpha=1,qn.clearRect(0,0,Nn.width,Nn.height),oa}sendUniformData(f,Ve){const Ue=this.chooseRightDelta();f.uniform2fv(Ve.uDelta,Ue)}isNeutralState(){return this.blur===0}chooseRightDelta(){let f=1;const Ve=[0,0];this.horizontal?this.aspectRatio>1&&(f=1/this.aspectRatio):this.aspectRatio<1&&(f=this.aspectRatio);const Ue=f*this.blur*.12;return this.horizontal?Ve[0]=Ue:Ve[1]=Ue,Ve}}t(Xa,"type","Blur"),t(Xa,"defaults",{blur:0}),t(Xa,"uniformLocations",["uDelta"]),tt.setClass(Xa);class Ya extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=Math.round(255*this.brightness);for(let Je=0;Je<Ve.length;Je+=4)Ve[Je]+=Ue,Ve[Je+1]+=Ue,Ve[Je+2]+=Ue}isNeutralState(){return this.brightness===0}sendUniformData(f,Ve){f.uniform1f(Ve.uBrightness,this.brightness)}}t(Ya,"type","Brightness"),t(Ya,"defaults",{brightness:0}),t(Ya,"uniformLocations",["uBrightness"]),tt.setClass(Ya);const Wa={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Va extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(f){const Ve=f.imageData.data,Ue=this.matrix,Je=this.colorsOnly;for(let Bn=0;Bn<Ve.length;Bn+=4){const Vn=Ve[Bn],Nn=Ve[Bn+1],Un=Ve[Bn+2];if(Ve[Bn]=Vn*Ue[0]+Nn*Ue[1]+Un*Ue[2]+255*Ue[4],Ve[Bn+1]=Vn*Ue[5]+Nn*Ue[6]+Un*Ue[7]+255*Ue[9],Ve[Bn+2]=Vn*Ue[10]+Nn*Ue[11]+Un*Ue[12]+255*Ue[14],!Je){const qn=Ve[Bn+3];Ve[Bn]+=qn*Ue[3],Ve[Bn+1]+=qn*Ue[8],Ve[Bn+2]+=qn*Ue[13],Ve[Bn+3]=Vn*Ue[15]+Nn*Ue[16]+Un*Ue[17]+qn*Ue[18]+255*Ue[19]}}}sendUniformData(f,Ve){const Ue=this.matrix,Je=[Ue[0],Ue[1],Ue[2],Ue[3],Ue[5],Ue[6],Ue[7],Ue[8],Ue[10],Ue[11],Ue[12],Ue[13],Ue[15],Ue[16],Ue[17],Ue[18]],Bn=[Ue[4],Ue[9],Ue[14],Ue[19]];f.uniformMatrix4fv(Ve.uColorMatrix,!1,Je),f.uniform4fv(Ve.uConstants,Bn)}toObject(){return s(s({},super.toObject()),{},{matrix:[...this.matrix]})}}function za(qe,f){var Ve;const Ue=(t(Ve=class extends Va{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",qe),t(Ve,"defaults",{colorsOnly:!1,matrix:f}),Ve);return tt.setClass(Ue,qe),Ue}t(Va,"type","ColorMatrix"),t(Va,"defaults",Wa),t(Va,"uniformLocations",["uColorMatrix","uConstants"]),tt.setClass(Va);za("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);za("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);za("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);za("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);za("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);za("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);za("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Qa extends ja{constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(f),this.subFilters=f.subFilters||[]}applyTo(f){Oa(f)&&(f.passes+=this.subFilters.length-1),this.subFilters.forEach(Ve=>{Ve.applyTo(f)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(f=>f.toObject())}}isNeutralState(){return!this.subFilters.some(f=>!f.isNeutralState())}static fromObject(f,Ve){return Promise.all((f.subFilters||[]).map(Ue=>tt.getClass(Ue.type).fromObject(Ue,Ve))).then(Ue=>new this({subFilters:Ue}))}}t(Qa,"type","Composed"),tt.setClass(Qa);class Za extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=Math.floor(255*this.contrast),Je=259*(Ue+255)/(255*(259-Ue));for(let Bn=0;Bn<Ve.length;Bn+=4)Ve[Bn]=Je*(Ve[Bn]-128)+128,Ve[Bn+1]=Je*(Ve[Bn+1]-128)+128,Ve[Bn+2]=Je*(Ve[Bn+2]-128)+128}sendUniformData(f,Ve){f.uniform1f(Ve.uContrast,this.contrast)}}t(Za,"type","Contrast"),t(Za,"defaults",{contrast:0}),t(Za,"uniformLocations",["uContrast"]),tt.setClass(Za);const $a={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class th extends ja{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return $a[this.getCacheKey()]}applyTo2d(f){const Ve=f.imageData,Ue=Ve.data,Je=this.matrix,Bn=Math.round(Math.sqrt(Je.length)),Vn=Math.floor(Bn/2),Nn=Ve.width,Un=Ve.height,qn=f.ctx.createImageData(Nn,Un),qo=qn.data,$o=this.opaque?1:0;let Zo,ta,ea,ra,na,oa,ca,pa,la,ma,Ca,Sa,ga;for(Ca=0;Ca<Un;Ca++)for(ma=0;ma<Nn;ma++){for(na=4*(Ca*Nn+ma),Zo=0,ta=0,ea=0,ra=0,ga=0;ga<Bn;ga++)for(Sa=0;Sa<Bn;Sa++)ca=Ca+ga-Vn,oa=ma+Sa-Vn,ca<0||ca>=Un||oa<0||oa>=Nn||(pa=4*(ca*Nn+oa),la=Je[ga*Bn+Sa],Zo+=Ue[pa]*la,ta+=Ue[pa+1]*la,ea+=Ue[pa+2]*la,$o||(ra+=Ue[pa+3]*la));qo[na]=Zo,qo[na+1]=ta,qo[na+2]=ea,qo[na+3]=$o?Ue[na+3]:ra}f.imageData=qn}sendUniformData(f,Ve){f.uniform1fv(Ve.uMatrix,this.matrix)}toObject(){return s(s({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}t(th,"type","Convolute"),t(th,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),t(th,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),tt.setClass(th);const eh="Gamma";class sh extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(f),this.gamma=f.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=this.gamma,Je=1/Ue[0],Bn=1/Ue[1],Vn=1/Ue[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const Nn=this.rgbValues;for(let Un=0;Un<256;Un++)Nn.r[Un]=255*Math.pow(Un/255,Je),Nn.g[Un]=255*Math.pow(Un/255,Bn),Nn.b[Un]=255*Math.pow(Un/255,Vn);for(let Un=0;Un<Ve.length;Un+=4)Ve[Un]=Nn.r[Ve[Un]],Ve[Un+1]=Nn.g[Ve[Un+1]],Ve[Un+2]=Nn.b[Ve[Un+2]]}sendUniformData(f,Ve){f.uniform3fv(Ve.uGamma,this.gamma)}isNeutralState(){const{gamma:f}=this;return f[0]===1&&f[1]===1&&f[2]===1}toObject(){return{type:eh,gamma:this.gamma.concat()}}}t(sh,"type",eh),t(sh,"defaults",{gamma:[1,1,1]}),t(sh,"uniformLocations",["uGamma"]),tt.setClass(sh);const ih={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class rh extends ja{applyTo2d(f){let{imageData:{data:Ve}}=f;for(let Ue,Je=0;Je<Ve.length;Je+=4){const Bn=Ve[Je],Vn=Ve[Je+1],Nn=Ve[Je+2];switch(this.mode){case"average":Ue=(Bn+Vn+Nn)/3;break;case"lightness":Ue=(Math.min(Bn,Vn,Nn)+Math.max(Bn,Vn,Nn))/2;break;case"luminosity":Ue=.21*Bn+.72*Vn+.07*Nn}Ve[Je+2]=Ve[Je+1]=Ve[Je]=Ue}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return ih[this.mode]}sendUniformData(f,Ve){f.uniform1i(Ve.uMode,1)}isNeutralState(){return!1}}t(rh,"type","Grayscale"),t(rh,"defaults",{mode:"average"}),t(rh,"uniformLocations",["uMode"]),tt.setClass(rh);const nh=s(s({},Wa),{},{rotation:0});class oh extends Va{calculateMatrix(){const f=this.rotation*Math.PI,Ve=rt(f),Ue=nt(f),Je=1/3,Bn=Math.sqrt(Je)*Ue,Vn=1-Ve;this.matrix=[Ve+Vn/3,Je*Vn-Bn,Je*Vn+Bn,0,0,Je*Vn+Bn,Ve+Je*Vn,Je*Vn-Bn,0,0,Je*Vn-Bn,Je*Vn+Bn,Ve+Je*Vn,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(f){this.calculateMatrix(),super.applyTo(f)}toObject(){return{type:this.type,rotation:this.rotation}}}t(oh,"type","HueRotation"),t(oh,"defaults",nh),tt.setClass(oh);class ah extends ja{applyTo2d(f){let{imageData:{data:Ve}}=f;for(let Ue=0;Ue<Ve.length;Ue+=4)Ve[Ue]=255-Ve[Ue],Ve[Ue+1]=255-Ve[Ue+1],Ve[Ue+2]=255-Ve[Ue+2],this.alpha&&(Ve[Ue+3]=255-Ve[Ue+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(f,Ve){f.uniform1i(Ve.uInvert,Number(this.invert)),f.uniform1i(Ve.uAlpha,Number(this.alpha))}}t(ah,"type","Invert"),t(ah,"defaults",{alpha:!1,invert:!0}),t(ah,"uniformLocations",["uInvert","uAlpha"]),tt.setClass(ah);class hh extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=this.noise;for(let Je=0;Je<Ve.length;Je+=4){const Bn=(.5-Math.random())*Ue;Ve[Je]+=Bn,Ve[Je+1]+=Bn,Ve[Je+2]+=Bn}}sendUniformData(f,Ve){f.uniform1f(Ve.uNoise,this.noise/255),f.uniform1f(Ve.uSeed,Math.random())}isNeutralState(){return this.noise===0}}t(hh,"type","Noise"),t(hh,"defaults",{noise:0}),t(hh,"uniformLocations",["uNoise","uSeed"]),tt.setClass(hh);class ch extends ja{applyTo2d(f){let{imageData:{data:Ve,width:Ue,height:Je}}=f;for(let Bn=0;Bn<Je;Bn+=this.blocksize)for(let Vn=0;Vn<Ue;Vn+=this.blocksize){const Nn=4*Bn*Ue+4*Vn,Un=Ve[Nn],qn=Ve[Nn+1],qo=Ve[Nn+2],$o=Ve[Nn+3];for(let Zo=Bn;Zo<Math.min(Bn+this.blocksize,Je);Zo++)for(let ta=Vn;ta<Math.min(Vn+this.blocksize,Ue);ta++){const ea=4*Zo*Ue+4*ta;Ve[ea]=Un,Ve[ea+1]=qn,Ve[ea+2]=qo,Ve[ea+3]=$o}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(f,Ve){f.uniform1f(Ve.uBlocksize,this.blocksize)}}t(ch,"type","Pixelate"),t(ch,"defaults",{blocksize:4}),t(ch,"uniformLocations",["uBlocksize"]),tt.setClass(ch);class lh extends ja{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=255*this.distance,Je=new Ut(this.color).getSource(),Bn=[Je[0]-Ue,Je[1]-Ue,Je[2]-Ue],Vn=[Je[0]+Ue,Je[1]+Ue,Je[2]+Ue];for(let Nn=0;Nn<Ve.length;Nn+=4){const Un=Ve[Nn],qn=Ve[Nn+1],qo=Ve[Nn+2];Un>Bn[0]&&qn>Bn[1]&&qo>Bn[2]&&Un<Vn[0]&&qn<Vn[1]&&qo<Vn[2]&&(Ve[Nn+3]=0)}}sendUniformData(f,Ve){const Ue=new Ut(this.color).getSource(),Je=this.distance,Bn=[0+Ue[0]/255-Je,0+Ue[1]/255-Je,0+Ue[2]/255-Je,1],Vn=[Ue[0]/255+Je,Ue[1]/255+Je,Ue[2]/255+Je,1];f.uniform4fv(Ve.uLow,Bn),f.uniform4fv(Ve.uHigh,Vn)}}t(lh,"type","RemoveColor"),t(lh,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),t(lh,"uniformLocations",["uLow","uHigh"]),tt.setClass(lh);class uh extends ja{sendUniformData(f,Ve){f.uniform2fv(Ve.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),f.uniform1fv(Ve.uTaps,this.taps)}getFilterWindow(){const f=this.tempScale;return Math.ceil(this.lanczosLobes/f)}getCacheKey(){const f=this.getFilterWindow();return"".concat(this.type,"_").concat(f)}getFragmentSource(){const f=this.getFilterWindow();return this.generateShader(f)}getTaps(){const f=this.lanczosCreate(this.lanczosLobes),Ve=this.tempScale,Ue=this.getFilterWindow(),Je=new Array(Ue);for(let Bn=1;Bn<=Ue;Bn++)Je[Bn-1]=f(Bn*Ve);return Je}generateShader(f){const Ve=new Array(f);for(let Ue=1;Ue<=f;Ue++)Ve[Ue-1]="".concat(Ue,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(f,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(Ve.map((Ue,Je)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(Ue,") * uTaps[").concat(Je,"] + texture2D(uTexture, vTexCoord - ").concat(Ue,") * uTaps[").concat(Je,`];
              sum += 2.0 * uTaps[`).concat(Je,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(f){f.passes++,this.width=f.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=f.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),f.destinationWidth=this.dW,super.applyTo(f),f.sourceWidth=f.destinationWidth,this.height=f.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),f.destinationHeight=this.dH,super.applyTo(f),f.sourceHeight=f.destinationHeight}applyTo(f){Oa(f)?this.applyToForWebgl(f):this.applyTo2d(f)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(f){return Ve=>{if(Ve>=f||Ve<=-f)return 0;if(Ve<11920929e-14&&Ve>-11920929e-14)return 1;const Ue=(Ve*=Math.PI)/f;return Math.sin(Ve)/Ve*Math.sin(Ue)/Ue}}applyTo2d(f){const Ve=f.imageData,Ue=this.scaleX,Je=this.scaleY;this.rcpScaleX=1/Ue,this.rcpScaleY=1/Je;const Bn=Ve.width,Vn=Ve.height,Nn=Math.round(Bn*Ue),Un=Math.round(Vn*Je);let qn;qn=this.resizeType==="sliceHack"?this.sliceByTwo(f,Bn,Vn,Nn,Un):this.resizeType==="hermite"?this.hermiteFastResize(f,Bn,Vn,Nn,Un):this.resizeType==="bilinear"?this.bilinearFiltering(f,Bn,Vn,Nn,Un):this.resizeType==="lanczos"?this.lanczosResize(f,Bn,Vn,Nn,Un):new ImageData(Nn,Un),f.imageData=qn}sliceByTwo(f,Ve,Ue,Je,Bn){const Vn=f.imageData,Nn=.5;let Un=!1,qn=!1,qo=Ve*Nn,$o=Ue*Nn;const Zo=f.filterBackend.resources;let ta=0,ea=0;const ra=Ve;let na=0;Zo.sliceByTwo||(Zo.sliceByTwo=pt());const oa=Zo.sliceByTwo;(oa.width<1.5*Ve||oa.height<Ue)&&(oa.width=1.5*Ve,oa.height=Ue);const ca=oa.getContext("2d");for(ca.clearRect(0,0,1.5*Ve,Ue),ca.putImageData(Vn,0,0),Je=Math.floor(Je),Bn=Math.floor(Bn);!Un||!qn;)Ve=qo,Ue=$o,Je<Math.floor(qo*Nn)?qo=Math.floor(qo*Nn):(qo=Je,Un=!0),Bn<Math.floor($o*Nn)?$o=Math.floor($o*Nn):($o=Bn,qn=!0),ca.drawImage(oa,ta,ea,Ve,Ue,ra,na,qo,$o),ta=ra,ea=na,na+=$o;return ca.getImageData(ta,ea,Je,Bn)}lanczosResize(f,Ve,Ue,Je,Bn){const Vn=f.imageData.data,Nn=f.ctx.createImageData(Je,Bn),Un=Nn.data,qn=this.lanczosCreate(this.lanczosLobes),qo=this.rcpScaleX,$o=this.rcpScaleY,Zo=2/this.rcpScaleX,ta=2/this.rcpScaleY,ea=Math.ceil(qo*this.lanczosLobes/2),ra=Math.ceil($o*this.lanczosLobes/2),na={},oa={x:0,y:0},ca={x:0,y:0};return function pa(la){let ma,Ca,Sa,ga,ba,Ha,Ja,tc,Ua,sc,ic;for(oa.x=(la+.5)*qo,ca.x=Math.floor(oa.x),ma=0;ma<Bn;ma++){for(oa.y=(ma+.5)*$o,ca.y=Math.floor(oa.y),ba=0,Ha=0,Ja=0,tc=0,Ua=0,Ca=ca.x-ea;Ca<=ca.x+ea;Ca++)if(!(Ca<0||Ca>=Ve)){sc=Math.floor(1e3*Math.abs(Ca-oa.x)),na[sc]||(na[sc]={});for(let Ka=ca.y-ra;Ka<=ca.y+ra;Ka++)Ka<0||Ka>=Ue||(ic=Math.floor(1e3*Math.abs(Ka-oa.y)),na[sc][ic]||(na[sc][ic]=qn(Math.sqrt(Math.pow(sc*Zo,2)+Math.pow(ic*ta,2))/1e3)),Sa=na[sc][ic],Sa>0&&(ga=4*(Ka*Ve+Ca),ba+=Sa,Ha+=Sa*Vn[ga],Ja+=Sa*Vn[ga+1],tc+=Sa*Vn[ga+2],Ua+=Sa*Vn[ga+3]))}ga=4*(ma*Je+la),Un[ga]=Ha/ba,Un[ga+1]=Ja/ba,Un[ga+2]=tc/ba,Un[ga+3]=Ua/ba}return++la<Je?pa(la):Nn}(0)}bilinearFiltering(f,Ve,Ue,Je,Bn){let Vn,Nn,Un,qn,qo,$o,Zo,ta,ea,ra,na,oa,ca,pa=0;const la=this.rcpScaleX,ma=this.rcpScaleY,Ca=4*(Ve-1),Sa=f.imageData.data,ga=f.ctx.createImageData(Je,Bn),ba=ga.data;for(Zo=0;Zo<Bn;Zo++)for(ta=0;ta<Je;ta++)for(qo=Math.floor(la*ta),$o=Math.floor(ma*Zo),ea=la*ta-qo,ra=ma*Zo-$o,ca=4*($o*Ve+qo),na=0;na<4;na++)Vn=Sa[ca+na],Nn=Sa[ca+4+na],Un=Sa[ca+Ca+na],qn=Sa[ca+Ca+4+na],oa=Vn*(1-ea)*(1-ra)+Nn*ea*(1-ra)+Un*ra*(1-ea)+qn*ea*ra,ba[pa++]=oa;return ga}hermiteFastResize(f,Ve,Ue,Je,Bn){const Vn=this.rcpScaleX,Nn=this.rcpScaleY,Un=Math.ceil(Vn/2),qn=Math.ceil(Nn/2),qo=f.imageData.data,$o=f.ctx.createImageData(Je,Bn),Zo=$o.data;for(let ta=0;ta<Bn;ta++)for(let ea=0;ea<Je;ea++){const ra=4*(ea+ta*Je);let na=0,oa=0,ca=0,pa=0,la=0,ma=0,Ca=0;const Sa=(ta+.5)*Nn;for(let ga=Math.floor(ta*Nn);ga<(ta+1)*Nn;ga++){const ba=Math.abs(Sa-(ga+.5))/qn,Ha=(ea+.5)*Vn,Ja=ba*ba;for(let tc=Math.floor(ea*Vn);tc<(ea+1)*Vn;tc++){let Ua=Math.abs(Ha-(tc+.5))/Un;const sc=Math.sqrt(Ja+Ua*Ua);sc>1&&sc<-1||(na=2*sc*sc*sc-3*sc*sc+1,na>0&&(Ua=4*(tc+ga*Ve),Ca+=na*qo[Ua+3],ca+=na,qo[Ua+3]<255&&(na=na*qo[Ua+3]/250),pa+=na*qo[Ua],la+=na*qo[Ua+1],ma+=na*qo[Ua+2],oa+=na))}}Zo[ra]=pa/oa,Zo[ra+1]=la/oa,Zo[ra+2]=ma/oa,Zo[ra+3]=Ca/ca}return $o}}t(uh,"type","Resize"),t(uh,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),t(uh,"uniformLocations",["uDelta","uTaps"]),tt.setClass(uh);class dh extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=-this.saturation;for(let Je=0;Je<Ve.length;Je+=4){const Bn=Ve[Je],Vn=Ve[Je+1],Nn=Ve[Je+2],Un=Math.max(Bn,Vn,Nn);Ve[Je]+=Un!==Bn?(Un-Bn)*Ue:0,Ve[Je+1]+=Un!==Vn?(Un-Vn)*Ue:0,Ve[Je+2]+=Un!==Nn?(Un-Nn)*Ue:0}}sendUniformData(f,Ve){f.uniform1f(Ve.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}t(dh,"type","Saturation"),t(dh,"defaults",{saturation:0}),t(dh,"uniformLocations",["uSaturation"]),tt.setClass(dh);class gh extends ja{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(f){let{imageData:{data:Ve}}=f;const Ue=-this.vibrance;for(let Je=0;Je<Ve.length;Je+=4){const Bn=Ve[Je],Vn=Ve[Je+1],Nn=Ve[Je+2],Un=Math.max(Bn,Vn,Nn),qn=(Bn+Vn+Nn)/3,qo=2*Math.abs(Un-qn)/255*Ue;Ve[Je]+=Un!==Bn?(Un-Bn)*qo:0,Ve[Je+1]+=Un!==Vn?(Un-Vn)*qo:0,Ve[Je+2]+=Un!==Nn?(Un-Nn)*qo:0}}sendUniformData(f,Ve){f.uniform1f(Ve.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}t(gh,"type","Vibrance"),t(gh,"defaults",{vibrance:0}),t(gh,"uniformLocations",["uVibrance"]),tt.setClass(gh);const useMainStore=defineStore("main",{state:()=>({polygon:[],plateSize:[1,1],startingLengths:[],h0:0}),actions:{popVertex(){this.polygon.pop()},addVertex(qe){this.polygon.push(qe)}},persist:!0});function getLeftMostPointAtGivenHeight(qe,f){const Ve=[];for(let Je=0;Je<qe.length;Je++){const[Bn,Vn]=qe[Je],[Nn,Un]=qe[(Je+1)%qe.length];(Vn<=f&&Un>=f||Vn>=f&&Un<=f)&&Ve.push([Bn,Vn,Nn,Un])}const Ue=[];return Ve.forEach(([Je,Bn,Vn,Nn])=>{if(Bn===Nn)Ue.push(Je),Ue.push(Vn);else{const Un=Je+(Vn-Je)*(f-Bn)/(Nn-Bn);Ue.push(Un)}}),Math.min(...Ue)}function getRightMostPointAtGivenHeight(qe,f){const Ve=[];for(let Je=0;Je<qe.length;Je++){const[Bn,Vn]=qe[Je],[Nn,Un]=qe[(Je+1)%qe.length];(Vn<=f&&Un>=f||Vn>=f&&Un<=f)&&Ve.push([Bn,Vn,Nn,Un])}const Ue=[];return Ve.forEach(([Je,Bn,Vn,Nn])=>{if(Bn===Nn)Ue.push(Je),Ue.push(Vn);else{const Un=Je+(Vn-Je)*(f-Bn)/(Nn-Bn);Ue.push(Un)}}),Math.max(...Ue)}function pointInPolygon(qe,f){const Ve=f[0],Ue=f[1];let Je=!1;for(let Bn=0,Vn=qe.length-1;Bn<qe.length;Vn=Bn++){const Nn=qe[Bn][0],Un=qe[Bn][1],qn=qe[Vn][0],qo=qe[Vn][1];Un>Ue!=qo>Ue&&Ve<(qn-Nn)*(Ue-Un)/(qo-Un)+Nn&&(Je=!Je)}return Je}function nextBorderInterceptionToRight(qe,f){const Ve=f[0],Ue=f[1];let Je=Number.POSITIVE_INFINITY;for(let Bn=0;Bn<qe.length;Bn++){const[Vn,Nn]=qe[Bn],[Un,qn]=qe[(Bn+1)%qe.length];if(Nn<=Ue&&qn>=Ue||Nn>=Ue&&qn<=Ue){const qo=Vn+(Un-Vn)*(Ue-Nn)/(qn-Nn);qo>Ve&&(Je=Math.min(Je,qo))}}return Je}function nextBorderInterceptionToLeft(qe,f){const Ve=f[0],Ue=f[1];let Je=Number.NEGATIVE_INFINITY;for(let Bn=0;Bn<qe.length;Bn++){const[Vn,Nn]=qe[Bn],[Un,qn]=qe[(Bn+1)%qe.length];if(Nn<=Ue&&qn>=Ue||Nn>=Ue&&qn<=Ue){const qo=Vn+(Un-Vn)*(Ue-Nn)/(qn-Nn);qo<Ve&&(Je=Math.max(Je,qo))}}return Je}const _hoisted_1={ref:"can",id:"myCanvas",width:"1600",height:"1600",class:"max-w-[800px] max-h-[800px]"},_hoisted_2={class:"m-4"},_hoisted_3={class:"font-bold"},_hoisted_4=["onUpdate:modelValue"],_hoisted_5=["onUpdate:modelValue"],_hoisted_6=["placeholder","onUpdate:modelValue"],_hoisted_7={class:"table-fixed"},_sfc_main=defineComponent({__name:"App",setup(__props){const mainStore=useMainStore(),newVertex=ref(["0","0"]),canvas=ref(null),elementScale=ref(1),pg=ref(),trashLeft=ref([]),trashRight=ref([]),trashFull=ref([]);onMounted(()=>{canvas.value=new ue("myCanvas"),updateCanvas()});function addVertex(){const nVertex=[];console.log(newVertex.value[0].replace(/[^-()\d/*+.]/g,"")),console.log(eval(newVertex.value[0].replace(/[^-()\d/*+.]/g,""))),nVertex.push(parseFloat(eval(newVertex.value[0].replace(/[^-()\d/*+.]/g,"")))),nVertex.push(parseFloat(eval(newVertex.value[1].replace(/[^-()\d/*+.]/g,"")))),mainStore.addVertex(nVertex),newVertex.value=[nVertex[0].toString(),nVertex[1].toString()],updateCanvas()}function popVertex(){mainStore.popVertex(),updateCanvas()}function download(){const qe=document.createElement("a");canvas.value.backgroundColor="white";let f=canvas.value.toDataURL({format:"jpeg",quality:1,multiplier:5});f=f.replace(/^data:image\/[^;]*/,"data:application/octet-stream"),f=f.replace(/^data:application\/octet-stream/,"data:application/octet-stream;headers=Content-Disposition%3A%20attachment%3B%20filename=Canvas.png"),qe.href=f,qe.download="canvas.jpeg",qe.click()}function updateCanvas(){var qe,f,Ve;(qe=canvas.value)==null||qe.clear(),pg.value=new oo(mainStore.polygon.map(Ue=>({x:Ue[0],y:Ue[1]})),{fill:"#ced8e4",stroke:"black",strokeWidth:5,strokeUniform:!0}),pg.value.width>pg.value.height?pg.value.scaleToWidth(1500):pg.value.scaleToHeight(1500),elementScale.value=pg.value.scaleX,pg.value.flipY=!0,(f=canvas.value)==null||f.add(pg.value),(Ve=canvas.value)==null||Ve.centerObject(pg.value)}function getPolyVertices(qe){const f=qe.points,Ve=[];return f.forEach(Ue=>{const Je=Ue.x-qe.pathOffset.x,Bn=Ue.y-qe.pathOffset.y;Ve.push(new ot(Je,Bn).transform(ln.multiplyTransformMatrices(qe.canvas.viewportTransform,qe.calcTransformMatrix())))}),Ve}function createMeasurement(qe){var Un,qn;let f=0,Ve=new ot(0,0);qe[0]!=qe[2]?(f=Math.abs(qe[0]-qe[2]),qe[0]<qe[2]?Ve=new ot(qe[0],qe[1]+30):Ve=new ot(qe[2],qe[3]+30),pointInPolygon(mainStore.polygon,[Ve.x,Ve.y])&&(Ve=new ot(Ve.x,Ve.y-35))):qe[1]!=qe[3]&&(f=Math.abs(qe[1]-qe[3]),qe[1]<qe[3]?Ve=new ot(qe[0]+5,qe[1]):Ve=new ot(qe[0]+5,qe[3]),pointInPolygon(mainStore.polygon,[Ve.x,Ve.y])&&(Ve=new ot(Ve.x-35,Ve.y))),canvas.value.backgroundColor="white";const Ue=new Zn([0,0,10,0],{stroke:"lightblue",strokeWidth:2,strokeUniform:!0}),Je=new Zn([0,f,10,f],{stroke:"lightblue",strokeWidth:2,strokeUniform:!0}),Bn=new Zn([5,0,5,f],{stroke:"lightblue",strokeWidth:2,strokeUniform:!0}),Vn=new So(`  ${f}  `,{fontSize:16,fill:"lightblue",originX:"center",originY:"center",left:5,top:f*.5,width:10,backgroundColor:"white"});Vn.rotate(-90);const Nn=new Dr([Ue,Je,Bn,Vn],{originX:"center",originY:"center",width:10,height:f});qe[0]!=qe[2]&&Nn.rotate(90),Nn.scale(elementScale.value),Nn.setPositionByOrigin(getPolyVertices(pg.value)[0].add(Ve.multiply({x:elementScale.value,y:-elementScale.value})),"left","bottom"),(Un=canvas.value)==null||Un.add(Nn),(qn=canvas.value)==null||qn.bringObjectToFront(Nn)}function createAllMeasurements(){for(let qe=0;qe<mainStore.polygon.length;qe++)createMeasurement([...mainStore.polygon[qe],...mainStore.polygon[(qe+1)%mainStore.polygon.length]])}function createPlane(qe,f,Ve){var qo,$o;const Ue=pointInPolygon(mainStore.polygon,[Ve.x,Ve.y]),Je=pointInPolygon(mainStore.polygon,[Ve.x+qe,Ve.y]),Bn=pointInPolygon(mainStore.polygon,[Ve.x,Ve.y+f]),Vn=pointInPolygon(mainStore.polygon,[Ve.x+qe,Ve.y+f]);if(!Ue&&!Je&&!Bn&&!Vn)return;if(!Je&&!Vn){let Zo=nextBorderInterceptionToRight(mainStore.polygon,[Ve.x,Ve.y+f])-Ve.x,ta=nextBorderInterceptionToRight(mainStore.polygon,[Ve.x,Ve.y])-Ve.x;Zo>mainStore.plateSize[0]&&(Zo=Number.NEGATIVE_INFINITY),ta>mainStore.plateSize[0]&&(ta=Number.NEGATIVE_INFINITY),qe=Math.max(Zo,ta)}if(!Ue&&!Bn){let Zo=nextBorderInterceptionToLeft(mainStore.polygon,[Ve.x+qe,Ve.y+f])-Ve.x,ta=nextBorderInterceptionToLeft(mainStore.polygon,[Ve.x+qe,Ve.y])-Ve.x;Zo<-mainStore.plateSize[0]&&(Zo=Number.POSITIVE_INFINITY),ta<-mainStore.plateSize[0]&&(ta=Number.POSITIVE_INFINITY);const ea=Math.min(Zo,ta);qe-=ea,Ve.x+=ea}const Nn=new fr({width:qe*1,height:f*1,fill:"white",stroke:"black",strokeWidth:1,strokeUniform:!0,opacity:.5}),Un=new So(`${qe}`,{fontSize:16,fill:"black",originX:"center",originY:"center",left:qe*.5,top:f*.5,width:qe*.9}),qn=new Dr([Nn,Un],{originX:"center",originY:"center",width:qe,height:f});qn.scale(elementScale.value),qn.setPositionByOrigin(getPolyVertices(pg.value)[0].add(Ve.multiply({x:elementScale.value,y:-elementScale.value})),"left","bottom"),(qo=canvas.value)==null||qo.add(qn),($o=canvas.value)==null||$o.bringObjectToFront(qn)}function calcPlanes(){var Je;const qe=mainStore.h0;(Je=canvas.value)==null||Je.clear(),updateCanvas();const f=mainStore.plateSize[0]*1,Ve=mainStore.plateSize[1]*1,Ue=mainStore.polygon;for(let Bn=0;Bn<52;Bn++){const Vn=Bn*Ve+qe,Nn=mainStore.startingLengths[Bn%mainStore.startingLengths.length]%f||0,Un=Math.max(getRightMostPointAtGivenHeight(Ue,Vn),getRightMostPointAtGivenHeight(Ue,Vn+Ve))-Math.min(getLeftMostPointAtGivenHeight(Ue,Vn),getLeftMostPointAtGivenHeight(Ue,Vn+Ve)),qn=Math.min(getLeftMostPointAtGivenHeight(Ue,Vn),getLeftMostPointAtGivenHeight(Ue,Vn+Ve)),qo=Math.floor((Un-(Nn-qn))/f);Nn-qn!=0&&(createPlane((Nn-qn+50*f)%f,Ve,new ot(qn,Vn)),trashRight.value.push(f-(Nn-qn+50*f)%f));const $o=Math.floor((Nn-qn)/f);for(let Zo=0;Zo<qo+$o;Zo++)createPlane(f,Ve,new ot((Zo-$o)*f+Nn,Vn));createPlane((Un-(Nn-qn))%f,Ve,new ot(qo*f+Nn,Vn)),trashLeft.value.push(f-(Un-(Nn-qn))%f)}}return(qe,f)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("header",null,[createBaseVNode("canvas",_hoisted_1,null,512)]),createBaseVNode("main",_hoisted_2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(mainStore).polygon.length,Ve=>(openBlock(),createElementBlock("div",{key:Ve},[createBaseVNode("span",_hoisted_3,"Ecke "+toDisplayString(Ve.toString().padStart(2,"0"))+":",1),withDirectives(createBaseVNode("input",{class:"ml-2 my-1 w-32 p-1 rounded-md text-black px-2 bg-gray-400",type:"text","onUpdate:modelValue":Ue=>unref(mainStore).polygon[Ve-1][0]=Ue},null,8,_hoisted_4),[[vModelText,unref(mainStore).polygon[Ve-1][0]]]),withDirectives(createBaseVNode("input",{class:"ml-2 my-1 w-32 p-1 rounded-md text-black px-2 bg-gray-400",type:"text","onUpdate:modelValue":Ue=>unref(mainStore).polygon[Ve-1][1]=Ue},null,8,_hoisted_5),[[vModelText,unref(mainStore).polygon[Ve-1][1]]])]))),128)),f[7]||(f[7]=createBaseVNode("span",{class:"font-bold"},"Ecke Neu:",-1)),withDirectives(createBaseVNode("input",{class:"ml-2 w-32 p-1 rounded-md text-black px-2",type:"text","onUpdate:modelValue":f[0]||(f[0]=Ve=>newVertex.value[0]=Ve)},null,512),[[vModelText,newVertex.value[0]]]),withDirectives(createBaseVNode("input",{class:"ml-2 w-32 p-1 rounded-md text-black px-2",type:"text","onUpdate:modelValue":f[1]||(f[1]=Ve=>newVertex.value[1]=Ve)},null,512),[[vModelText,newVertex.value[1]]]),createBaseVNode("button",{type:"submit",tabindex:"1",class:"ml-2 p-1 rounded-md bg-blue-500 hover:bg-blue-700 text-white px-2",onClick:addVertex},"Add Vertex"),createBaseVNode("button",{class:"ml-2 p-1 rounded-md bg-red-500 hover:bg-red-700 text-white px-2",onClick:popVertex},"Delete last Vertex"),createBaseVNode("button",{class:"ml-2 p-1 rounded-md bg-green-500 hover:bg-green-700 text-white px-2",onClick:updateCanvas},"Update Vertices"),f[8]||(f[8]=createBaseVNode("hr",{class:"my-2"},null,-1)),f[9]||(f[9]=createBaseVNode("span",{class:"font-bold"},"Dielengre (BxH):",-1)),withDirectives(createBaseVNode("input",{class:"ml-2 w-32 p-1 rounded-md text-black px-2",type:"text","onUpdate:modelValue":f[2]||(f[2]=Ve=>unref(mainStore).plateSize[0]=Ve)},null,512),[[vModelText,unref(mainStore).plateSize[0]]]),f[10]||(f[10]=createBaseVNode("span",{class:"ml-2 font-bold"},"x",-1)),withDirectives(createBaseVNode("input",{class:"ml-2 w-32 p-1 rounded-md text-black px-2",type:"text","onUpdate:modelValue":f[3]||(f[3]=Ve=>unref(mainStore).plateSize[1]=Ve)},null,512),[[vModelText,unref(mainStore).plateSize[1]]]),createBaseVNode("button",{class:"ml-2 p-1 rounded-md bg-blue-500 hover:bg-blue-700 text-white px-2",onClick:calcPlanes},"Berechne Dielen"),f[11]||(f[11]=createBaseVNode("span",{class:"ml-4 font-bold"},[createTextVNode("H"),createBaseVNode("sub",null,"0"),createTextVNode(":")],-1)),withDirectives(createBaseVNode("input",{class:"ml-2 w-32 p-1 rounded-md text-black px-2",type:"number","onUpdate:modelValue":f[4]||(f[4]=Ve=>unref(mainStore).h0=Ve)},null,512),[[vModelText,unref(mainStore).h0]]),f[12]||(f[12]=createBaseVNode("hr",{class:"my-2"},null,-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(mainStore).startingLengths.length+1,Ve=>withDirectives((openBlock(),createElementBlock("input",{key:Ve,placeholder:Ve.toString(),class:"ml-2 w-32 p-1 rounded-md text-black px-2",type:"number","onUpdate:modelValue":Ue=>unref(mainStore).startingLengths[Ve-1]=Ue},null,8,_hoisted_6)),[[vModelText,unref(mainStore).startingLengths[Ve-1]]])),128)),createBaseVNode("button",{class:"ml-2 p-1 rounded-md bg-red-500 hover:bg-red-700 text-white px-2",onClick:f[5]||(f[5]=Ve=>unref(mainStore).startingLengths.pop())},"Remove last"),f[13]||(f[13]=createBaseVNode("hr",{class:"my-2"},null,-1)),createBaseVNode("div",{class:"w-full p-2 flex gap-2"},[createBaseVNode("button",{class:"p-1 rounded-md bg-green-500 hover:bg-green-700 text-white px-2 w-1/2",onClick:download},"Download"),createBaseVNode("button",{class:"p-1 rounded-md bg-green-500 hover:bg-green-700 text-white px-2 w-1/2",onClick:createAllMeasurements},"Add Measurement")]),f[14]||(f[14]=createBaseVNode("hr",{class:"my-2"},null,-1)),createBaseVNode("table",_hoisted_7,[f[6]||(f[6]=createBaseVNode("thead",null,[createBaseVNode("tr",null,[createBaseVNode("th",{class:"w-36 text-left"},"Rest links"),createBaseVNode("th",null,"Rest rechts"),createBaseVNode("th",null,"Rest insg.")])],-1)),createBaseVNode("tbody",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(Math.max(trashLeft.value.length,trashRight.value.length,trashFull.value.length),Ve=>(openBlock(),createElementBlock("tr",{key:Ve},[createBaseVNode("td",null,toDisplayString(trashLeft.value[Ve-1])+"cm",1),createBaseVNode("td",null,toDisplayString(trashRight.value[Ve-1])+"cm",1),createBaseVNode("td",null,toDisplayString(trashFull.value[Ve-1])+"cm",1)]))),128))])])])],64))}}),_export_sfc=(qe,f)=>{const Ve=qe.__vccOpts||qe;for(const[Ue,Je]of f)Ve[Ue]=Je;return Ve},App=_export_sfc(_sfc_main,[["__scopeId","data-v-897a3636"]]),pinia=createPinia();pinia.use(src_default);const app=createApp(App);app.use(pinia);app.mount("#app");
